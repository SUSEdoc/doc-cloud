<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>SUSE OpenStack Cloud 9 | Deployment Guide using Cloud Lifecycle Manager | Alternative Configurations</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Alternative Configurations | SUSE OpenStack Cloud 9"/>
<meta name="description" content="In SUSE OpenStack Cloud 9 there are alternative configurations that we recommend for specific purposes."/>
<meta name="product-name" content="SUSE OpenStack Cloud"/>
<meta name="product-number" content="9"/>
<meta name="book-title" content="Deployment Guide using Cloud Lifecycle Manager"/>
<meta name="chapter-title" content="Chapter 12. Alternative Configurations"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 9"/>
<meta property="og:title" content="Alternative Configurations | SUSE OpenStack Cloud 9"/>
<meta property="og:description" content="In SUSE OpenStack Cloud 9 there are alternative configurations that we recommend for specific purposes."/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Alternative Configurations | SUSE OpenStack Cloud 9"/>
<meta name="twitter:description" content="In SUSE OpenStack Cloud 9 there are alternative configurations that we recommend for specific purposes."/>
<link rel="prev" href="modify-input-model.html" title="Chapter 11. Modifying Example Configurations for Object Storage using Swift"/><link rel="next" href="preinstall.html" title="Part III. Pre-Installation"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/planning-architecture-alternative-alternative_configurations.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Deployment Guide using Cloud Lifecycle Manager</a><span> / </span><a class="crumb" href="architecture.html">Cloud Lifecycle Manager Overview</a><span> / </span><a class="crumb" href="alternative-configurations.html">Alternative Configurations</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title"><em class="citetitle">Deployment Guide using Cloud Lifecycle Manager</em></div><ol><li><a href="planning-index.html" class="has-children "><span class="title-number">I </span><span class="title-name">Planning an Installation using Cloud Lifecycle Manager</span></a><ol><li><a href="register-suse-overview.html" class=" "><span class="title-number">1 </span><span class="title-name">Registering SLES</span></a></li><li><a href="min-hardware.html" class=" "><span class="title-number">2 </span><span class="title-name">Hardware and Software Support Matrix</span></a></li><li><a href="idg-planning-planning-recommended-hardware-minimums-xml-1.html" class=" "><span class="title-number">3 </span><span class="title-name">Recommended Hardware Minimums for the Example Configurations</span></a></li><li><a href="HP3-0HA.html" class=" "><span class="title-number">4 </span><span class="title-name">High Availability</span></a></li></ol></li><li class="active"><a href="architecture.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Cloud Lifecycle Manager Overview</span></a><ol><li><a href="cha-input-model-intro-concept.html" class=" "><span class="title-number">5 </span><span class="title-name">Input Model</span></a></li><li><a href="configurationobjects.html" class=" "><span class="title-number">6 </span><span class="title-name">Configuration Objects</span></a></li><li><a href="othertopics.html" class=" "><span class="title-number">7 </span><span class="title-name">Other Topics</span></a></li><li><a href="cpinfofiles.html" class=" "><span class="title-number">8 </span><span class="title-name">Configuration Processor Information Files</span></a></li><li><a href="example-configurations.html" class=" "><span class="title-number">9 </span><span class="title-name">Example Configurations</span></a></li><li><a href="modify-compute-input-model.html" class=" "><span class="title-number">10 </span><span class="title-name">Modifying Example Configurations for Compute Nodes</span></a></li><li><a href="modify-input-model.html" class=" "><span class="title-number">11 </span><span class="title-name">Modifying Example Configurations for Object Storage using Swift</span></a></li><li><a href="alternative-configurations.html" class=" you-are-here"><span class="title-number">12 </span><span class="title-name">Alternative Configurations</span></a></li></ol></li><li><a href="preinstall.html" class="has-children "><span class="title-number">III </span><span class="title-name">Pre-Installation</span></a><ol><li><a href="preinstall-overview.html" class=" "><span class="title-number">13 </span><span class="title-name">Overview</span></a></li><li><a href="preinstall-checklist.html" class=" "><span class="title-number">14 </span><span class="title-name">Pre-Installation Checklist</span></a></li><li><a href="cha-depl-dep-inst.html" class=" "><span class="title-number">15 </span><span class="title-name">Installing the Cloud Lifecycle Manager server</span></a></li><li><a href="app-deploy-smt-lcm.html" class=" "><span class="title-number">16 </span><span class="title-name">Installing and Setting Up an SMT Server on the Cloud Lifecycle Manager server (Optional)</span></a></li><li><a href="cha-depl-repo-conf-lcm.html" class=" "><span class="title-number">17 </span><span class="title-name">Software Repository Setup</span></a></li><li><a href="multipath-boot-from-san.html" class=" "><span class="title-number">18 </span><span class="title-name">Boot from SAN and Multipath Configuration</span></a></li></ol></li><li><a href="cloudinstallation.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Cloud Installation</span></a><ol><li><a href="cloudinstallation-overview.html" class=" "><span class="title-number">19 </span><span class="title-name">Overview</span></a></li><li><a href="preparing-standalone.html" class=" "><span class="title-number">20 </span><span class="title-name">Preparing for Stand-Alone Deployment</span></a></li><li><a href="install-gui.html" class=" "><span class="title-number">21 </span><span class="title-name">Installing with the Install UI</span></a></li><li><a href="using-git.html" class=" "><span class="title-number">22 </span><span class="title-name">Using Git for Configuration Management</span></a></li><li><a href="install-standalone.html" class=" "><span class="title-number">23 </span><span class="title-name">Installing a Stand-Alone Cloud Lifecycle Manager</span></a></li><li><a href="install-kvm.html" class=" "><span class="title-number">24 </span><span class="title-name">Installing Mid-scale and Entry-scale KVM</span></a></li><li><a href="DesignateInstallOverview.html" class=" "><span class="title-number">25 </span><span class="title-name">DNS Service Installation Overview</span></a></li><li><a href="MagnumOverview.html" class=" "><span class="title-number">26 </span><span class="title-name">Magnum Overview</span></a></li><li><a href="install-esx-ovsvapp.html" class=" "><span class="title-number">27 </span><span class="title-name">Installing ESX Computes and OVSvAPP</span></a></li><li><a href="integrate-nsx-vsphere.html" class=" "><span class="title-number">28 </span><span class="title-name">Integrating NSX for vSphere</span></a></li><li><a href="install-ironic-overview.html" class=" "><span class="title-number">29 </span><span class="title-name">Installing Baremetal (Ironic)</span></a></li><li><a href="install-swift.html" class=" "><span class="title-number">30 </span><span class="title-name">Installation for <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> Entry-scale Cloud with Swift Only</span></a></li><li><a href="install-sles-compute.html" class=" "><span class="title-number">31 </span><span class="title-name">Installing SLES Compute</span></a></li><li><a href="install-ardana-manila.html" class=" "><span class="title-number">32 </span><span class="title-name">Installing manila and Creating manila Shares</span></a></li><li><a href="install-heat-templates.html" class=" "><span class="title-number">33 </span><span class="title-name">Installing SUSE CaaS Platform heat Templates</span></a></li><li><a href="install-caasp-terraform.html" class=" "><span class="title-number">34 </span><span class="title-name">Installing SUSE CaaS Platform v4 using terraform</span></a></li><li><a href="integrations.html" class=" "><span class="title-number">35 </span><span class="title-name">Integrations</span></a></li><li><a href="troubleshooting-installation.html" class=" "><span class="title-number">36 </span><span class="title-name">Troubleshooting the Installation</span></a></li><li><a href="esx-troubleshooting-installation.html" class=" "><span class="title-number">37 </span><span class="title-name">Troubleshooting the ESX</span></a></li></ol></li><li><a href="post-install.html" class="has-children "><span class="title-number">V </span><span class="title-name">Post-Installation</span></a><ol><li><a href="cloud-verification.html" class=" "><span class="title-number">38 </span><span class="title-name">Post Installation Tasks</span></a></li><li><a href="ui-verification.html" class=" "><span class="title-number">39 </span><span class="title-name">UI Verification</span></a></li><li><a href="install-openstack-clients.html" class=" "><span class="title-number">40 </span><span class="title-name">Installing OpenStack Clients</span></a></li><li><a href="tls30.html" class=" "><span class="title-number">41 </span><span class="title-name">Configuring Transport Layer Security (TLS)</span></a></li><li><a href="config-availability-zones.html" class=" "><span class="title-number">42 </span><span class="title-name">Configuring Availability Zones</span></a></li><li><a href="OctaviaInstall.html" class=" "><span class="title-number">43 </span><span class="title-name">Configuring Load Balancer as a Service</span></a></li><li><a href="postinstall-checklist.html" class=" "><span class="title-number">44 </span><span class="title-name">Other Common Post-Installation Tasks</span></a></li></ol></li><li><a href="cha-inst-trouble.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Support</span></a><ol><li><a href="sec-depl-trouble-faq.html" class=" "><span class="title-number">45 </span><span class="title-name">FAQ</span></a></li><li><a href="sec-installation-trouble-support.html" class=" "><span class="title-number">46 </span><span class="title-name">Support</span></a></li><li><a href="inst-support-ptf.html" class=" "><span class="title-number">47 </span><span class="title-name">
    Applying PTFs (Program Temporary Fixes) Provided by SUSE L3 Support
   </span></a></li><li><a href="inst-support-ptf-test.html" class=" "><span class="title-number">48 </span><span class="title-name">
    Testing PTFs (Program Temporary Fixes) on a Single Node
   </span></a></li></ol></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="alternative-configurations" data-id-title="Alternative Configurations"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span></span> <span class="productnumber">9</span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">12 </span><span class="title-name">Alternative Configurations</span></span> <a title="Permalink" class="permalink" href="alternative-configurations.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/planning-architecture-alternative-alternative_configurations.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
    In <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> 9 there are alternative configurations that we recommend
    for specific purposes.
   </p></div></div></div></div><section class="sect1" id="standalone-deployer" data-id-title="Using a Dedicated Cloud Lifecycle Manager Node"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">12.1 </span><span class="title-name">Using a Dedicated Cloud Lifecycle Manager Node</span></span> <a title="Permalink" class="permalink" href="alternative-configurations.html#standalone-deployer">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/planning-architecture-alternative-standalone_deployer.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  All of the example configurations included host the Cloud Lifecycle Manager on the first
  Control Node. It is also possible to deploy this service on a dedicated
  node. One use case for wanting to run the dedicated Cloud Lifecycle Manager is to be able to
  test the deployment of different configurations without having to re-install
  the first server. Some administrators prefer the additional security of
  keeping all of the configuration data on a separate server from those that
  users of the cloud connect to (although all of the data can be encrypted and
  SSH keys can be password protected).
 </p><p>
  Here is a graphical representation of this setup:
 </p><div class="informalfigure"><div class="mediaobject"><a href="images/media-examples-entry_scale_kvm.png"><img src="images/media-examples-entry_scale_kvm.png" alt="Image" title="Image"/></a></div></div><section class="sect2" id="sec-specify-lifecycle-manager" data-id-title="Specifying a dedicated Cloud Lifecycle Manager in your input model"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">12.1.1 </span><span class="title-name">Specifying a dedicated Cloud Lifecycle Manager in your input model</span></span> <a title="Permalink" class="permalink" href="alternative-configurations.html#sec-specify-lifecycle-manager">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/planning-architecture-alternative-standalone_deployer.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To specify a dedicated Cloud Lifecycle Manager in your input model, make the following edits
   to your configuration files.
  </p><div id="id-1.3.4.10.3.5.3" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important</div><p>
    The indentation of each of the input files is important and will cause
    errors if not done correctly. Use the existing content in each of these
    files as a reference when adding additional content for your Cloud Lifecycle Manager.
   </p></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Update <code class="filename">control_plane.yml</code> to add the Cloud Lifecycle Manager.
    </p></li><li class="listitem"><p>
     Update <code class="filename">server_roles.yml</code> to add the Cloud Lifecycle Manager role.
    </p></li><li class="listitem"><p>
     Update <code class="filename">net_interfaces.yml</code> to add the interface
     definition for the Cloud Lifecycle Manager.
    </p></li><li class="listitem"><p>
     Create a <code class="filename">disks_lifecycle_manager.yml</code> file to define
     the disk layout for the Cloud Lifecycle Manager.
    </p></li><li class="listitem"><p>
     Update <code class="filename">servers.yml</code> to add the dedicated Cloud Lifecycle Manager node.
    </p></li></ul></div><p>
   <code class="filename">Control_plane.yml</code>: The snippet below shows the addition
   of a single node cluster into the control plane to host the Cloud Lifecycle Manager service.
   Note that, in addition to adding the new cluster, you also have to remove
   the Cloud Lifecycle Manager component from the <code class="literal">cluster1</code> in the examples:
  </p><div class="verbatim-wrap"><pre class="screen">  clusters:
<span class="bold"><strong>     - name: cluster0
       cluster-prefix: c0
       server-role: LIFECYCLE-MANAGER-ROLE
       member-count: 1
       allocation-policy: strict
       service-components:
         - lifecycle-manager</strong></span>
         - ntp-client
     - name: cluster1
       cluster-prefix: c1
       server-role: CONTROLLER-ROLE
       member-count: 3
       allocation-policy: strict
       service-components:
         - lifecycle-manager
         - ntp-server
         - tempest</pre></div><p>
   This specifies a single node of role
   <code class="literal">LIFECYCLE-MANAGER-ROLE</code> hosting the Cloud Lifecycle Manager.
  </p><p>
   <code class="filename">Server_roles.yml</code>: The snippet below shows the insertion
   of the new server roles definition:
  </p><div class="verbatim-wrap"><pre class="screen">   server-roles:

<span class="bold"><strong>      - name: LIFECYCLE-MANAGER-ROLE
        interface-model: LIFECYCLE-MANAGER-INTERFACES
        disk-model: LIFECYCLE-MANAGER-DISKS</strong></span>

      - name: CONTROLLER-ROLE</pre></div><p>
   This defines a new server role which references a new interface-model and
   disk-model to be used when configuring the server.
  </p><p>
   <code class="filename">net-interfaces.yml</code>: The snippet below shows the
   insertion of the network-interface info:
  </p><div class="verbatim-wrap"><pre class="screen"><span class="bold"><strong>    - name: LIFECYCLE-MANAGER-INTERFACES
      network-interfaces:
        - name: BOND0
          device:
             name: bond0
          bond-data:
             options:
                 mode: active-backup
                 miimon: 200
                 primary: hed3
             provider: linux
             devices:
                 - name: hed3
                 - name: hed4
          network-groups:
             - MANAGEMENT</strong></span></pre></div><p>
   This assumes that the server uses the same physical networking layout as the
   other servers in the example.
   
   
  </p><p>
   <code class="filename">disks_lifecycle_manager.yml</code>: In the examples,
   disk-models are provided as separate files (this is just a convention, not a
   limitation) so the following should be added as a new file named
   <code class="filename">disks_lifecycle_manager.yml</code>:
  </p><div class="verbatim-wrap"><pre class="screen">---
   product:
      version: 2

   disk-models:
<span class="bold"><strong>   - name: LIFECYCLE-MANAGER-DISKS
     # Disk model to be used for Cloud Lifecycle Managers nodes
     # /dev/sda_root is used as a volume group for /, /var/log and /var/crash
     # sda_root is a templated value to align with whatever partition is really used
     # This value is checked in os config and replaced by the partition actually used
     # on sda e.g. sda1 or sda5

     volume-groups:
       - name: ardana-vg
         physical-volumes:
           - /dev/sda_root

       logical-volumes:
       # The policy is not to consume 100% of the space of each volume group.
       # 5% should be left free for snapshots and to allow for some flexibility.
          - name: root
            size: 80%
            fstype: ext4
            mount: /
          - name: crash
            size: 15%
            mount: /var/crash
            fstype: ext4
            mkfs-opts: -O large_file
        consumer:
              name: os</strong></span></pre></div><p>
   <code class="filename">Servers.yml</code>: The snippet below shows the insertion of an
   additional server used for hosting the Cloud Lifecycle Manager. Provide the address
   information here for the server you are running on, that is, the node where
   you have installed the <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> ISO.
  </p><div class="verbatim-wrap"><pre class="screen">  servers:
     # NOTE: Addresses of servers need to be changed to match your environment.
     #
     #       Add additional servers as required

<span class="bold"><strong>     #Lifecycle-manager
     - id: lifecycle-manager
       ip-addr: <em class="replaceable">YOUR IP ADDRESS HERE</em>
       role: LIFECYCLE-MANAGER-ROLE
       server-group: RACK1
       nic-mapping: HP-SL230-4PORT
       mac-addr: 8c:dc:d4:b5:c9:e0
       # ipmi information is not needed </strong></span>

     # Controllers
     - id: controller1
       ip-addr: 192.168.10.3
       role: CONTROLLER-ROLE</pre></div><div id="id-1.3.4.10.3.5.18" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important</div><p>
    With a stand-alone deployer, the OpenStack CLI and other clients will not
    be installed automatically. You need to install <span class="productname">OpenStack</span> clients to get the
    desired <span class="productname">OpenStack</span> capabilities. For more information and installation
    instructions, consult <a class="xref" href="install-openstack-clients.html" title="Chapter 40. Installing OpenStack Clients">Chapter 40, <em>Installing OpenStack Clients</em></a>.
   </p></div></section></section><section class="sect1" id="without-dvr" data-id-title="Configuring SUSE OpenStack Cloud without DVR"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">12.2 </span><span class="title-name">Configuring <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> without DVR</span></span> <a title="Permalink" class="permalink" href="alternative-configurations.html#without-dvr">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/planning-architecture-alternative-without_dvr.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  By default in the KVM model, the neutron service utilizes distributed routing
  (DVR). This is the recommended setup because it allows for high availability.
  However, if you would like to disable this feature, here are the steps to
  achieve this.
 </p><p>
  On your Cloud Lifecycle Manager, make the following changes:
 </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
    In the
    <code class="filename">~/openstack/my_cloud/config/neutron/neutron.conf.j2</code>
    file, change the line below from:
   </p><div class="verbatim-wrap"><pre class="screen">router_distributed = {{ router_distributed }}</pre></div><p>
    to:
   </p><div class="verbatim-wrap"><pre class="screen">router_distributed = False</pre></div></li><li class="step"><p>
    In the
    <code class="filename">~/openstack/my_cloud/config/neutron/ml2_conf.ini.j2</code>
    file, change the line below from:
   </p><div class="verbatim-wrap"><pre class="screen">enable_distributed_routing = {{ enable_distributed_routing }}</pre></div><p>
    to:
   </p><div class="verbatim-wrap"><pre class="screen">enable_distributed_routing = False</pre></div></li><li class="step"><p>
    In the
    <code class="filename">~/openstack/my_cloud/config/neutron/l3_agent.ini.j2</code>
    file, change the line below from:
   </p><div class="verbatim-wrap"><pre class="screen">agent_mode = {{ neutron_l3_agent_mode }}</pre></div><p>
    to:
   </p><div class="verbatim-wrap"><pre class="screen">agent_mode = legacy</pre></div></li><li class="step"><p>
    In the
    <code class="filename">~/openstack/my_cloud/definition/data/control_plane.yml</code>
    file, remove the following values from the Compute resource
    <code class="literal">service-components</code> list:
   </p><div class="verbatim-wrap"><pre class="screen">- neutron-l3-agent
   - neutron-metadata-agent</pre></div><div id="id-1.3.4.10.4.4.4.3" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning</div><p>
     If you fail to remove the above values from the Compute resource
     service-components list from file
     <code class="filename">~/openstack/my_cloud/definition/data/control_plane.yml</code>,
     you will end up with routers (non_DVR routers) being deployed in the
     compute host, even though the lifecycle manager is configured for
     non_distributed routers.
    </p></div></li><li class="step"><p>
    Commit your changes to your local git repository:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>cd ~/openstack/ardana/ansible
<code class="prompt user">ardana &gt; </code>git add -A
<code class="prompt user">ardana &gt; </code>git commit -m "My config or other commit message"</pre></div></li><li class="step"><p>
    Run the configuration processor:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>cd ~/openstack/ardana/ansible
<code class="prompt user">ardana &gt; </code>ansible-playbook -i hosts/localhost config-processor-run.yml</pre></div></li><li class="step"><p>
    Run the ready deployment playbook:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>cd ~/openstack/ardana/ansible
<code class="prompt user">ardana &gt; </code>ansible-playbook -i hosts/localhost ready-deployment.yml</pre></div></li><li class="step"><p>
    Continue installation. More information on cloud deployments are available
    in the <a class="xref" href="cloudinstallation-overview.html" title="Chapter 19. Overview">Chapter 19, <em>Overview</em></a>
   </p></li></ol></div></div></section><section class="sect1" id="without-l3agent" data-id-title="Configuring SUSE OpenStack Cloud with Provider VLANs and Physical Routers Only"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">12.3 </span><span class="title-name">Configuring <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> with Provider VLANs and Physical Routers Only</span></span> <a title="Permalink" class="permalink" href="alternative-configurations.html#without-l3agent">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/planning-architecture-alternative-without_l3agent.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  Another option for configuring neutron is to use provider VLANs and physical
  routers only, here are the steps to achieve this.
 </p><p>
  On your Cloud Lifecycle Manager, make the following changes:
 </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
    In the
    <code class="filename">~/openstack/my_cloud/config/neutron/neutron.conf.j2</code>
    file, change the line below from:
   </p><div class="verbatim-wrap"><pre class="screen">router_distributed = {{ router_distributed }}</pre></div><p>
    to:
   </p><div class="verbatim-wrap"><pre class="screen">router_distributed = False</pre></div></li><li class="step"><p>
    In the
    <code class="filename">~/openstack/my_cloud/config/neutron/ml2_conf.ini.j2</code>
    file, change the line below from:
   </p><div class="verbatim-wrap"><pre class="screen">enable_distributed_routing = {{ enable_distributed_routing }}</pre></div><p>
    to:
   </p><div class="verbatim-wrap"><pre class="screen">enable_distributed_routing = False</pre></div></li><li class="step"><p>
    In the
    <code class="filename">~/openstack/my_cloud/config/neutron/dhcp_agent.ini.j2</code>
    file, change the line below from:
   </p><div class="verbatim-wrap"><pre class="screen">enable_isolated_metadata = {{ neutron_enable_isolated_metadata }}</pre></div><p>
    to:
   </p><div class="verbatim-wrap"><pre class="screen">enable_isolated_metadata = True</pre></div></li><li class="step"><p>
    In the
    <code class="filename">~/openstack/my_cloud/definition/data/control_plane.yml</code>
    file, remove the following values from the Compute resource
    <code class="literal">service-components</code> list:
   </p><div class="verbatim-wrap"><pre class="screen">- neutron-l3-agent
  - neutron-metadata-agent</pre></div></li></ol></div></div></section><section class="sect1" id="twosystems" data-id-title="Considerations When Installing Two Systems on One Subnet"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">12.4 </span><span class="title-name">Considerations When Installing Two Systems on One Subnet</span></span> <a title="Permalink" class="permalink" href="alternative-configurations.html#twosystems">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/planning-architecture-alternative-twosystems.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  If you wish to install two separate <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> 9 systems using a single
  subnet, you will need to consider the following notes.
 </p><p>
  The <code class="literal">ip_cluster</code> service includes the
  <code class="literal">keepalived</code> daemon which maintains virtual IPs (VIPs) on
  cluster nodes. In order to maintain VIPs, it communicates between cluster
  nodes over the VRRP protocol.
 </p><p>
  A VRRP virtual routerid identifies a particular VRRP cluster and must be
  unique for a subnet. If you have two VRRP clusters with the same virtual
  routerid, causing a clash of VRRP traffic, the VIPs are unlikely to be up or
  pingable and you are likely to get the following signature in your
  <code class="literal">/etc/keepalived/keepalived.log</code>:
 </p><div class="verbatim-wrap"><pre class="screen">Dec 16 15:43:43 ardana-cp1-c1-m1-mgmt Keepalived_vrrp[2218]: ip address
  associated with VRID not present in received packet : 10.2.1.11
Dec 16 15:43:43 ardana-cp1-c1-m1-mgmt Keepalived_vrrp[2218]: one or more VIP
  associated with VRID mismatch actual MASTER advert
Dec 16 15:43:43 ardana-cp1-c1-m1-mgmt Keepalived_vrrp[2218]: bogus VRRP packet
  received on br-bond0 !!!
Dec 16 15:43:43 ardana-cp1-c1-m1-mgmt Keepalived_vrrp[2218]: VRRP_Instance(VI_2)
  ignoring received advertisment...</pre></div><p>
  To resolve this issue, our recommendation is to install your separate
  <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> 9 systems with VRRP traffic on different subnets.
 </p><p>
  If this is not possible, you may also assign a unique routerid to your
  separate <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> 9 system by changing the
  <code class="literal">keepalived_vrrp_offset</code> service configurable. The routerid
  is currently derived using the <code class="literal">keepalived_vrrp_index</code> which
  comes from a configuration processor variable and the
  <code class="literal">keepalived_vrrp_offset</code>.
 </p><p>
  For example,
 </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
    Log in to your Cloud Lifecycle Manager.
   </p></li><li class="step"><p>
    Edit your
    <code class="filename">~/openstack/my_cloud/config/keepalived/defaults.yml</code>
    file and change the value of the following line:
   </p><div class="verbatim-wrap"><pre class="screen">keepalived_vrrp_offset: 0</pre></div><p>
    Change the off value to a number that uniquely identifies a separate vrrp
    cluster. For example:
   </p><p>
    <code class="literal">keepalived_vrrp_offset: 0</code> for the 1st vrrp cluster on
    this subnet.
   </p><p>
    <code class="literal">keepalived_vrrp_offset: 1</code> for the 2nd vrrp cluster on
    this subnet.
   </p><p>
    <code class="literal">keepalived_vrrp_offset: 2</code> for the 3rd vrrp cluster on
    this subnet.
   </p><div id="symlinks" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important</div><p>
     You should be aware that the files in the
     <code class="filename">~/openstack/my_cloud/config/</code> directory are symlinks
     to the <code class="filename">~/openstack/ardana/ansible/</code> directory. For
     example:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>ls -al ~/openstack/my_cloud/config/keepalived/defaults.yml
lrwxrwxrwx 1 stack stack 55 May 24 20:38 /var/lib/ardana/openstack/my_cloud/config/keepalived/defaults.yml -&gt;
    ../../../ardana/ansible/roles/keepalived/defaults/main.yml</pre></div><p>
     If you are using a tool like <code class="literal">sed</code> to make edits to files
     in this directory, you might break the symbolic link and create a new copy
     of the file. To maintain the link, you will need to force
     <code class="literal">sed</code> to follow the link:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>sed -i <span class="bold"><strong>--follow-symlinks</strong></span> \
  's$keepalived_vrrp_offset: 0$keepalived_vrrp_offset: 2$' \
  ~/openstack/my_cloud/config/keepalived/defaults.yml</pre></div><p>
     Alternatively, directly edit the target of the link
     <code class="filename">~/openstack/ardana/ansible/roles/keepalived/defaults/main.yml</code>.
    </p></div></li><li class="step"><p>
    Commit your configuration to the Git repository (see
    <a class="xref" href="using-git.html" title="Chapter 22. Using Git for Configuration Management">Chapter 22, <em>Using Git for Configuration Management</em></a>), as follows:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>cd ~/openstack/ardana/ansible
<code class="prompt user">ardana &gt; </code>git add -A
<code class="prompt user">ardana &gt; </code>git commit -m "changing Admin password"</pre></div></li><li class="step"><p>
    Run the configuration processor with this command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>cd ~/openstack/ardana/ansible
<code class="prompt user">ardana &gt; </code>ansible-playbook -i hosts/localhost config-processor-run.yml</pre></div></li><li class="step"><p>
    Use the playbook below to create a deployment directory:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>cd ~/openstack/ardana/ansible
<code class="prompt user">ardana &gt; </code>ansible-playbook -i hosts/localhost ready-deployment.yml</pre></div></li><li class="step"><p>
    If you are making this change after your initial install, run the following
    reconfigure playbook to make this change in your environment:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">ardana &gt; </code>cd ~/scratch/ansible/next/ardana/ansible/
<code class="prompt user">ardana &gt; </code>ansible-playbook -i hosts/verb_hosts FND-CLU-reconfigure.yml</pre></div></li></ol></div></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="modify-input-model.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 11 </span>Modifying Example Configurations for Object Storage using Swift</span></a> </div><div><a class="pagination-link next" href="preinstall.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Part III </span>Pre-Installation</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="alternative-configurations.html#standalone-deployer"><span class="title-number">12.1 </span><span class="title-name">Using a Dedicated Cloud Lifecycle Manager Node</span></a></span></li><li><span class="section"><a href="alternative-configurations.html#without-dvr"><span class="title-number">12.2 </span><span class="title-name">Configuring <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> without DVR</span></a></span></li><li><span class="section"><a href="alternative-configurations.html#without-l3agent"><span class="title-number">12.3 </span><span class="title-name">Configuring <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> with Provider VLANs and Physical Routers Only</span></a></span></li><li><span class="section"><a href="alternative-configurations.html#twosystems"><span class="title-number">12.4 </span><span class="title-name">Considerations When Installing Two Systems on One Subnet</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>