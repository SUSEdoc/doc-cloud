<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Key Management Service Administration | Security Guide | SUSE OpenStack Cloud 9</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 3.0.0 (https://opensuse.github.io/daps) using SUSE XSL Stylesheets 2.0.17 (based on DocBook XSL Stylesheets 1.79.2) - chunked" /><meta name="product-name" content="SUSE OpenStack Cloud" /><meta name="product-number" content="9" /><meta name="book-title" content="Security Guide" /><meta name="chapter-title" content="Chapter 3. Key Management Service Administration" /><meta name="description" content="In a production environment, you can verify your installation of the barbican key management service by running the barbican-status.yml Ansible playbook on the Cloud Lifecycle Manager node." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 9" /><link rel="home" href="index.html" title="Documentation" /><link rel="up" href="book-security.html" title="Security Guide" /><link rel="prev" href="barbican.html" title="Chapter 2. Key Management with the barbican Service" /><link rel="next" href="roleSegregation.html" title="Chapter 4. Service Admin Role Segregation in the Identity Service" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css"></link>');
}
else {
  document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #FABEBE;"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Documentation"><span class="book-icon">Documentation</span></a><span> › </span><a class="crumb" href="book-security.html">Security Guide</a><span> › </span><a class="crumb" href="barbicanAdmin.html">Key Management Service Administration</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="newsecurity.html"><span class="number">1 </span><span class="name"><span class="phrase"><span class="phrase">SUSE® <span class="productname">OpenStack</span> Cloud</span></span>: Security Planning and Features</span></a></li><li class="inactive"><a href="barbican.html"><span class="number">2 </span><span class="name">Key Management with the barbican Service</span></a></li><li class="inactive"><a href="barbicanAdmin.html"><span class="number">3 </span><span class="name">Key Management Service Administration</span></a></li><li class="inactive"><a href="roleSegregation.html"><span class="number">4 </span><span class="name">Service Admin Role Segregation in the Identity Service</span></a></li><li class="inactive"><a href="cha-security-rbac.html"><span class="number">5 </span><span class="name">Role-Based Access Control in neutron</span></a></li><li class="inactive"><a href="sg-logging.html"><span class="number">6 </span><span class="name">Enabling Network Security Group Logging</span></a></li><li class="inactive"><a href="x509-certificate-auth.html"><span class="number">7 </span><span class="name">Configuring keystone and horizon to use X.509 Client Certificates</span></a></li><li class="inactive"><a href="tls30overview.html"><span class="number">8 </span><span class="name">Transport Layer Security (TLS) Overview</span></a></li><li class="inactive"><a href="header-poisoning.html"><span class="number">9 </span><span class="name">Preventing Host Header Poisoning</span></a></li><li class="inactive"><a href="password-encryption.html"><span class="number">10 </span><span class="name">Encryption of Passwords and Sensitive Data</span></a></li><li class="inactive"><a href="encryption-ephemeral.html"><span class="number">11 </span><span class="name">Encryption of Ephemeral Volumes</span></a></li><li class="inactive"><a href="topic-rmq-j1v-4t.html"><span class="number">12 </span><span class="name">Refining Access Control with AppArmor</span></a></li><li class="inactive"><a href="dar.html"><span class="number">13 </span><span class="name">Data at Rest Encryption</span></a></li><li class="inactive"><a href="glance-rate-limit.html"><span class="number">14 </span><span class="name">glance-API Rate Limit (CVE-2016-8611)</span></a></li><li class="inactive"><a href="idg-all-security-middleware-auditing-xml-1.html"><span class="number">15 </span><span class="name">Security Audit Logs</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 2. Key Management with the barbican Service" href="barbican.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 4. Service Admin Role Segregation in the Identity Service" href="roleSegregation.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #FABEBE;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Documentation"><span class="book-icon">Documentation</span></a><span> › </span><a class="crumb" href="book-security.html">Security Guide</a><span> › </span><a class="crumb" href="barbicanAdmin.html">Key Management Service Administration</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 2. Key Management with the barbican Service" href="barbican.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 4. Service Admin Role Segregation in the Identity Service" href="roleSegregation.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="barbicanAdmin"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span></span> <span class="productnumber ">9</span></div><div><h1 class="title"><span class="number">3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Key Management Service Administration</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h1><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span>barbicanAdmin</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="section"><a href="barbicanAdmin.html#idg-all-security-barbican-admin-xml-6"><span class="number">3.1 </span><span class="name">Post-installation verification and administration</span></a></span></dt><dt><span class="section"><a href="barbicanAdmin.html#id-1.4.5.3"><span class="number">3.2 </span><span class="name">Updating the barbican Key Management Service</span></a></span></dt><dt><span class="section"><a href="barbicanAdmin.html#idg-all-security-barbican-admin-xml-8"><span class="number">3.3 </span><span class="name">barbican Settings</span></a></span></dt><dt><span class="section"><a href="barbicanAdmin.html#id-1.4.5.5"><span class="number">3.4 </span><span class="name">Enable or Disable Auditing of barbican Events</span></a></span></dt><dt><span class="section"><a href="barbicanAdmin.html#id-1.4.5.6"><span class="number">3.5 </span><span class="name">Updating the barbican API Service Configuration File</span></a></span></dt><dt><span class="section"><a href="barbicanAdmin.html#id-1.4.5.7"><span class="number">3.6 </span><span class="name">Starting and Stopping the barbican Service</span></a></span></dt><dt><span class="section"><a href="barbicanAdmin.html#id-1.4.5.8"><span class="number">3.7 </span><span class="name">Changing or Resetting a Password</span></a></span></dt><dt><span class="section"><a href="barbicanAdmin.html#id-1.4.5.9"><span class="number">3.8 </span><span class="name">Checking Barbican Status</span></a></span></dt><dt><span class="section"><a href="barbicanAdmin.html#id-1.4.5.10"><span class="number">3.9 </span><span class="name">Updating Logging Configuration</span></a></span></dt></dl></div></div><div class="sect1" id="idg-all-security-barbican-admin-xml-6"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Post-installation verification and administration</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#idg-all-security-barbican-admin-xml-6">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span>idg-all-security-barbican-admin-xml-6</li></ul></div></div></div></div><p>
   In a production environment, you can verify your installation of the
   barbican key management service by running the
   <code class="filename">barbican-status.yml</code> Ansible playbook on the Cloud Lifecycle Manager node.
  </p><div class="verbatim-wrap"><pre class="screen">ansible-playbook -i hosts/verb_hosts barbican-status.yml</pre></div><p>
   In any non-production environment, along with the playbook, you can also
   verify the service by storing and retrieving the secret from barbican.
  </p></div><div class="sect1" id="id-1.4.5.3"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Updating the barbican Key Management Service</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#id-1.4.5.3">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   Some barbican features and service configurations can be changed. This
   is done using the Cloud Lifecycle Manager Reconfigure Ansible playbook. For example, the log
   level can be changed from INFO to DEBUG and vice-versa. If needed, this
   change can be restricted to a set of nodes via the playbook's host limit
   option. barbican administration tasks should be performed by an admin
   user with a token scoped to the default domain via the keystone identity
   API. These settings are preconfigured in the
   <code class="filename">barbican.osrc</code> file. By default,
   <code class="filename">barbican.osrc</code> is configured with the admin endpoint. If
   the admin endpoint is not accessible from your network, change
   <code class="literal">OS_AUTH_URL</code> to point to the public endpoint.
  </p></div><div class="sect1" id="idg-all-security-barbican-admin-xml-8"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">barbican Settings</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#idg-all-security-barbican-admin-xml-8">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span>idg-all-security-barbican-admin-xml-8</li></ul></div></div></div></div><p>
   The following barbican configuration settings can be changed:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     Anything in the main barbican configuration file:
     <code class="filename">/etc/barbican/barbican.conf</code>
    </p></li><li class="listitem "><p>
     Anything in the main barbican worker configuration file:
     <code class="filename">/etc/barbican/barbican-worker.conf</code>
    </p></li></ul></div><p>
   You can also update the following configuration options and enable the
   following features. For example, you can:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     Change the verbosity of logs written to barbican log files
     (<code class="filename">/var/log/barbican/</code>).
    </p></li><li class="listitem "><p>
     Enable and disable auditing of the barbican key management service
    </p></li><li class="listitem "><p>
     Edit <code class="literal">barbican_secret_store</code> plug-ins. The two options
     are:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       <code class="literal">store_crypto</code> used to store the secrets in the
       database
      </p></li><li class="listitem "><p>
       <code class="literal">kmip_plugin</code> used to store the secrets into
       KMIP-enabled external devices
      </p></li></ul></div></li></ul></div></div><div class="sect1" id="id-1.4.5.5"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Enable or Disable Auditing of barbican Events</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#id-1.4.5.5">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   Auditing of barbican key manager events can be disabled or enabled by
   following steps on the Cloud Lifecycle Manager node.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Edit the file
     <code class="filename">~/openstack/my_cloud/definition/cloudConfig.yml</code>.
    </p><p>
     All audit-related configuration is defined under
     <code class="literal">audit-settings</code> section. Valid YAML syntax is required
     when specifying values.
    </p><p>
     Service name defined under <code class="literal">enabled-services</code> or
     <code class="literal">disabled-services</code> override the default setting (that is,
     <code class="literal">default: enabled</code> or <code class="literal">default:
     disabled</code>)
    </p></li><li class="step "><p>
     To enable auditing, make sure that the barbican service
     name is listed in the <code class="literal">enabled-services</code> list
     of <code class="literal">audit-settings</code> section or is not listed in the
     <code class="literal">disabled-services</code> list when default: is set to
     <code class="literal">enabled</code>.
    </p></li><li class="step "><p>
     To disable auditing for the barbican service specifically, make sure
     that <code class="literal">barbican service name</code> is in
     <code class="literal">disabled-services</code> list of the
     <code class="literal">audit-settings</code> section or is not present in the
     <code class="literal">enabled-services</code> list when default: is set to
     <code class="literal">disabled</code>. You should not specify the service name in
     both lists. If it is specified in both, the enabled-services list takes
     precedence.
    </p></li><li class="step "><p>
     Commit the change in git repository.
    </p><div class="verbatim-wrap"><pre class="screen">cd ~/openstack/ardana/ansible
git add -A
git commit -m "My config"</pre></div></li><li class="step "><p>
     Run the <code class="literal">configuration-processor-run</code> and
     <code class="literal">ready-deployment</code> playbooks, followed by the
     <code class="literal">barbican-reconfigure</code> playbook:
    </p><div class="verbatim-wrap"><pre class="screen">cd ~/openstack/ardana/ansible/
ansible-playbook -i hosts/localhost config-processor-run.yml
ansible-playbook -i hosts/localhost ready-deployment.yml
cd ~/scratch/ansible/next/ardana/ansible
ansible-playbook -i hosts/verb_hosts barbican-reconfigure.yml</pre></div></li></ol></div></div></div><div class="sect1" id="id-1.4.5.6"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Updating the barbican API Service Configuration File</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#id-1.4.5.6">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     The barbican API service configuration file
     (<code class="literal">/etc/barbican/barbican.conf</code>), located on each control
     plane server (controller node) is generated from the following template
     file located on the Cloud Lifecycle Manager node:
     <code class="filename">/var/lib/ardana/openstack/my_cloud/config/barbican/barbican.conf.j2</code>.
     Modify this template file as appropriate. This is a Jinja2 template, which
     expects certain template variables to be set. Do not change values inside
     double curly braces: <code class="literal">{{ }}</code>.
    </p></li><li class="step "><p>
     Once the template is modified, copy the files to
     <code class="literal">~/openstack/my_cloud/definition/</code>, and commit the change to
     the local git repository:
    </p><div class="verbatim-wrap"><pre class="screen">cp -r ~/hp-ci/padawan/* ~/openstack/my_cloud/definition/
cd ~/openstack/ardana/ansible
git add -A
git commit -m "My config"</pre></div></li><li class="step "><p>
     Then rerun the configuration processor and ready-deployment playbooks:
    </p><div class="verbatim-wrap"><pre class="screen">cd ~/openstack/ardana/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml
ansible-playbook -i hosts/localhost ready-deployment.yml</pre></div></li><li class="step "><p>
     Finally, run the <code class="literal">barbican-reconfigure</code> playbook in the
     deployment area:
    </p><div class="verbatim-wrap"><pre class="screen">cd ~/scratch/ansible/next/ardana/ansible
ansible-playbook -i hosts/verb_hosts barbican-reconfigure.yml</pre></div></li></ol></div></div></div><div class="sect1" id="id-1.4.5.7"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Starting and Stopping the barbican Service</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#id-1.4.5.7">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   You can start or stop the barbican service from the Cloud Lifecycle Manager nodes by
   running the appropriate Ansible playbooks:
  </p><p>
   To stop the barbican service:
  </p><div class="verbatim-wrap"><pre class="screen">cd ~/scratch/ansible/next/ardana/ansible
ansible-playbook -i hosts/verb_hosts barbican-stop.yml</pre></div><p>
   To start the barbican service:
  </p><div class="verbatim-wrap"><pre class="screen">cd ~/scratch/ansible/next/ardana/ansible
ansible-playbook -i hosts/verb_hosts barbican-start.yml</pre></div></div><div class="sect1" id="id-1.4.5.8"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Changing or Resetting a Password</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#id-1.4.5.8">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   To change the password for the barbican administrator:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Copy the file as shown below:
    </p><div class="verbatim-wrap"><pre class="screen">cp ~/openstack/my_cloud/info/private_data_metadata_ccp.yml \
  ~/openstack/change_credentials/</pre></div></li><li class="step "><p>
     Then edit <code class="filename">private_data_metadata_ccp.yml</code> found here:
    </p><div class="verbatim-wrap"><pre class="screen">~/openstack/change_credentials/private_data_metadata_ccp.yml</pre></div></li><li class="step "><p>
     Change credentials for the barbican admin user and/or barbican
     service user. Remove everything else. The file will look similar to this:
    </p><div class="verbatim-wrap"><pre class="screen">barbican_admin_password:
    value: <span class="bold"><strong>'testing_123'</strong></span>
    metadata:
    - clusters:
        - cluster1
        component: barbican-api
        cp: ccp
    version: '2.0'
barbican_service_password:
    value:<span class="bold"><strong> 'testing_123'</strong></span>
    metadata:
    - clusters:
        - cluster1
        component: barbican-api
        cp: ccp
    version: '2.0'</pre></div><p>
     The value (shown in bold) is optional; it is used to set a user-chosen
     password. If left blank, the playbook will generate a random password.
    </p></li><li class="step "><p>
     Execute the following playbooks from
     <code class="filename">~/openstack/ardana/ansible/</code>:
    </p><div class="verbatim-wrap"><pre class="screen">cd ~/openstack/ardana/ansible/
ansible-playbook -i hosts/localhost config-processor-run.yml -e encrypt="" -e rekey=""
ansible-playbook -i hosts/localhost ready-deployment.yml
cd ~/scratch/ansible/next/ardana/ansible
ansible-playbook -i hosts/verb_hosts barbican-reconfigure-credentials-change.yml</pre></div></li><li class="step "><p>
     SSH to the controller and make sure the password has been properly
     updated.
    </p><div class="verbatim-wrap"><pre class="screen">/etc/barbican# vi barbican-api-paste.ini</pre></div></li></ol></div></div></div><div class="sect1" id="id-1.4.5.9"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Checking Barbican Status</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#id-1.4.5.9">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   You can check the status of barbican by running the
   <code class="literal">barbican-status.yml</code> Ansible playbook on the Cloud Lifecycle Manager node.
  </p><div class="verbatim-wrap"><pre class="screen">ansible-playbook -i hosts/verb_hosts barbican-status.yml</pre></div><div id="id-1.4.5.9.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
   Make sure you remove/delete
   <code class="filename">~/openstack/change_credentials/private_data_metadata.yml</code>
   after successfully
   changing the password.
  </p></div></div><div class="sect1" id="id-1.4.5.10"><div class="titlepage"><div><div><h2 class="title"><span class="number">3.9 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Updating Logging Configuration</span> <a title="Permalink" class="permalink" href="barbicanAdmin.html#id-1.4.5.10">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_9/xml/security-barbican_admin.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-barbican_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   All barbican logging is set to INFO by default. To change the
   level from the Cloud Lifecycle Manager, there are two options available
  </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
     Edit the barbican configuration file,
     <code class="filename">/barbican_deploy_config.yml</code>, in the following
     directory.
    </p><div class="verbatim-wrap"><pre class="screen">~/openstack/my_cloud/config/barbican/</pre></div><p>
     To change log level entry (<code class="literal">barbican_loglevel</code>) to DEBUG,
     edit the entry:
    </p><div class="verbatim-wrap"><pre class="screen">barbican_loglevel = {{ openstack_loglevel | default('DEBUG') }}</pre></div><p>
     To change the log level to INFO, edit the entry:
    </p><div class="verbatim-wrap"><pre class="screen">barbican_loglevel = {{ openstack_loglevel | default('INFO') }}</pre></div></li><li class="listitem "><p>
     Edit file
     <code class="literal">~/openstack/ardana/ansible/roles/KEYMGR-API/templates/api-logging.conf.j2</code>
     and update the log level accordingly.
    </p></li></ol></div><p>
   Commit the change to the local git repository:
  </p><div class="verbatim-wrap"><pre class="screen">cd ~/openstack/ardana/ansible
git add -A
git commit -m "My config"</pre></div><p>
   Run the configuration-processor-run and ready-deployment playbooks, followed
   by the <code class="literal">barbican-reconfigure</code> playbook:
  </p><div class="verbatim-wrap"><pre class="screen">ansible-playbook -i hosts/localhost config-processor-run.yml
ansible-playbook -i hosts/localhost ready-deployment.yml
cd ~/scratch/ansible/next/ardana/ansible
ansible-playbook -i hosts/verb_hosts barbican-reconfigure.yml</pre></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="roleSegregation.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 4 </span>Service Admin Role Segregation in the Identity Service</span></a><a class="nav-link" href="barbican.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 2 </span>Key Management with the barbican Service</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2021 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>