<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>SUSE OpenStack Cloud Crowbar 9 | Deployment Guide using Crowbar | Using Cisco Nexus Switches with neutron</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Using Cisco Nexus Switches with neutron | SUSE OpenSta…"/>
<meta name="description" content=""/>
<meta name="product-name" content="SUSE OpenStack Cloud Crowbar"/>
<meta name="product-number" content="9"/>
<meta name="book-title" content="Deployment Guide using Crowbar"/>
<meta name="chapter-title" content="Appendix A. Using Cisco Nexus Switches with neutron"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="dpopov@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 9"/>
<meta property="og:title" content="Using Cisco Nexus Switches with neutron | SUSE OpenSta…"/>
<meta property="og:description" content=""/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using Cisco Nexus Switches with neutron | SUSE OpenSta…"/>
<meta name="twitter:description" content=""/>
<link rel="prev" href="cha-depl-trouble.html" title="Chapter 18. Troubleshooting and Support"/><link rel="next" href="app-deploy-docupdates.html" title="Appendix B. Documentation Updates"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Deployment Guide using Crowbar</a><span> / </span><a class="crumb" href="app-deploy-cisco.html">Using Cisco Nexus Switches with neutron</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title"><em class="citetitle">Deployment Guide using Crowbar</em></div><ol><li><a href="pre-cloud-deploy.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li><a href="part-depl-intro.html" class="has-children "><span class="title-number">I </span><span class="title-name">Architecture and Requirements</span></a><ol><li><a href="cha-depl-arch.html" class=" "><span class="title-number">1 </span><span class="title-name">The SUSE <span class="productname">OpenStack</span> Cloud Architecture</span></a></li><li><a href="cha-depl-req.html" class=" "><span class="title-number">2 </span><span class="title-name">Considerations and Requirements</span></a></li></ol></li><li><a href="part-depl-admserv.html" class="has-children "><span class="title-number">II </span><span class="title-name">Setting Up the Administration Server</span></a><ol><li><a href="cha-depl-adm-inst.html" class=" "><span class="title-number">3 </span><span class="title-name">Installing the Administration Server</span></a></li><li><a href="app-deploy-smt.html" class=" "><span class="title-number">4 </span><span class="title-name">Installing and Setting Up an SMT Server on the Administration Server (Optional)</span></a></li><li><a href="cha-depl-repo-conf.html" class=" "><span class="title-number">5 </span><span class="title-name">Software Repository Setup</span></a></li><li><a href="sec-depl-adm-inst-network.html" class=" "><span class="title-number">6 </span><span class="title-name">Service Configuration:  Administration Server Network Configuration</span></a></li><li><a href="sec-depl-adm-inst-crowbar.html" class=" "><span class="title-number">7 </span><span class="title-name">Crowbar Setup</span></a></li><li><a href="sec-depl-adm-start-crowbar.html" class=" "><span class="title-number">8 </span><span class="title-name">Starting the SUSE <span class="productname">OpenStack</span> Cloud Crowbar installation</span></a></li><li><a href="sec-depl-adm-crowbar-extra-features.html" class=" "><span class="title-number">9 </span><span class="title-name">Customizing Crowbar</span></a></li></ol></li><li><a href="part-depl-ostack.html" class="has-children "><span class="title-number">III </span><span class="title-name">Setting Up <span class="productname">OpenStack</span> Nodes and Services</span></a><ol><li><a href="cha-depl-crowbar.html" class=" "><span class="title-number">10 </span><span class="title-name">The Crowbar Web Interface</span></a></li><li><a href="cha-depl-inst-nodes.html" class=" "><span class="title-number">11 </span><span class="title-name">Installing the <span class="productname">OpenStack</span> Nodes</span></a></li><li><a href="cha-depl-ostack.html" class=" "><span class="title-number">12 </span><span class="title-name">Deploying the <span class="productname">OpenStack</span> Services</span></a></li><li><a href="sec-deploy-policy-json.html" class=" "><span class="title-number">13 </span><span class="title-name">Limiting Users' Access Rights</span></a></li><li><a href="cha-depl-ostack-configs.html" class=" "><span class="title-number">14 </span><span class="title-name">Configuration Files for <span class="productname">OpenStack</span> Services</span></a></li><li><a href="install-heat-templates.html" class=" "><span class="title-number">15 </span><span class="title-name">Installing SUSE CaaS Platform heat Templates</span></a></li><li><a href="install-caasp-terraform.html" class=" "><span class="title-number">16 </span><span class="title-name">Installing SUSE CaaS Platform v4 using terraform</span></a></li></ol></li><li><a href="part-depl-nostack.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Setting Up Non-<span class="productname">OpenStack</span> Services</span></a><ol><li><a href="cha-depl-nostack.html" class=" "><span class="title-number">17 </span><span class="title-name">Deploying the Non-<span class="productname">OpenStack</span> Components</span></a></li></ol></li><li><a href="part-depl-troubleshooting.html" class="has-children "><span class="title-number">V </span><span class="title-name">Troubleshooting and Support</span></a><ol><li><a href="cha-depl-trouble.html" class=" "><span class="title-number">18 </span><span class="title-name">Troubleshooting and Support</span></a></li></ol></li><li><a href="app-deploy-cisco.html" class=" you-are-here"><span class="title-number">A </span><span class="title-name">Using Cisco Nexus Switches with neutron</span></a></li><li><a href="app-deploy-docupdates.html" class=" "><span class="title-number">B </span><span class="title-name">Documentation Updates</span></a></li><li><a href="gl-cloud.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary of Terminology and Product Names</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="appendix" id="app-deploy-cisco" data-id-title="Using Cisco Nexus Switches with neutron"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud Crowbar</span></span></span> <span class="productnumber">9</span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">A </span><span class="title-name">Using Cisco Nexus Switches with neutron</span></span> <a title="Permalink" class="permalink" href="app-deploy-cisco.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><section class="sect1" id="app-deploy-cisco-requirements" data-id-title="Requirements"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">A.1 </span><span class="title-name">Requirements</span></span> <a title="Permalink" class="permalink" href="app-deploy-cisco.html#app-deploy-cisco-requirements">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><p>
   The following requirements must be met to use Cisco Nexus switches with
   neutron:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Cisco Nexus series 3000, 5000 or 7000
    </p></li><li class="listitem"><p>
     All Compute Nodes must be equipped with at least two network cards.
    </p></li><li class="listitem"><p>
     The switch needs to have the XML management interface enabled. SSH
     access to the management interface must be enabled (refer to the
     switch's documentation for details).
    </p></li><li class="listitem"><p>
     Enable VLAN trunking for all neutron managed VLANs on the switch
     port to which the controller node running neutron is connected to.
    </p></li><li class="listitem"><p>
     Before deploying neutron, check if VLAN configurations for neutron managed
     VLANs already exist on the switch (for example, from a previous SUSE <span class="productname">OpenStack</span> Cloud
     deployment). If yes, delete them via the switch's management interface prior to
     deploying neutron.
    </p></li><li class="listitem"><p>
     When using the Cisco plugin, neutron reconfigures the VLAN trunk
     configuration on all ports used for the <code class="literal">nova-fixed</code>
     traffic (the traffic between the instances). This requires to
     configure separate network interfaces exclusively used by
     <code class="literal">nova-fixed</code>. This can be achieved by adjusting
     <code class="filename">/etc/crowbar/network.json</code> (refer to
     <a class="xref" href="sec-depl-adm-inst-crowbar.html#sec-depl-inst-admserv-post-network" title="7.5. Custom Network Configuration">Section 7.5, “Custom Network Configuration”</a>). The following example shows
     an appropriate configuration for dual mode, where
     <span class="guimenu">nova-fixed</span> has been mapped to conduit
     <span class="guimenu">intf1</span> and all other networks to other conduits.
     Configuration attributes not relevant in this context have been
     replaced with <code class="literal">...</code>.
    </p><div class="example" id="id-1.4.8.4.3.6.2" data-id-title="Exclusively Mapping nova-fixed to conduit intf1 in dual mode"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example A.1: </span><span class="title-name">Exclusively Mapping <span class="guimenu">nova-fixed</span> to conduit <span class="guimenu">intf1</span> in dual mode </span></span><a title="Permalink" class="permalink" href="app-deploy-cisco.html#id-1.4.8.4.3.6.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">{
   "attributes" : {
      "network" : {
         "conduit_map" : [
            <em class="replaceable">...</em>
         ],
         "mode" : "single",
         "networks" : {
            "nova_fixed" : {
              <em class="replaceable">...</em>,
              "conduit" : "intf1"
            },
            "nova_floating" : {
              <em class="replaceable">...</em>,
              "conduit" : "intf0"
            },
            "public" : {
              <em class="replaceable">...</em>,
              "conduit" : "intf0"
            },
            "storage" : {
              <em class="replaceable">...</em>,
              "conduit" : "intf0"
            },
            "os_sdn" : {
              <em class="replaceable">...</em>,
              "conduit" : "intf0"
            },
            "admin" : {
              <em class="replaceable">...</em>,
              "conduit" : "intf0"
            },
            "bmc" : {
              <em class="replaceable">...</em>,
              "conduit" : "bmc"
            },
            "bmc_vlan" : {
              <em class="replaceable">...</em>,
              "conduit" : "intf2"
            },
         },
         <em class="replaceable">...</em>,
      },
   }
}</pre></div></div></div></li><li class="listitem"><p>
     Make a note of all switch ports to which the interfaces using the
     <code class="literal">nova-fixed</code> network on the Compute Nodes are
     connected. This information will be needed when deploying neutron.
    </p></li></ul></div></section><section class="sect1" id="app-deploy-cisco-deploy" data-id-title="Deploying neutron with the Cisco Plugin"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">A.2 </span><span class="title-name">Deploying neutron with the Cisco Plugin</span></span> <a title="Permalink" class="permalink" href="app-deploy-cisco.html#app-deploy-cisco-deploy">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></div></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Create a neutron barclamp proposal in the Crowbar Web
     interface.
    </p></li><li class="step"><p>
     As the <span class="guimenu">Plugin</span>, select <code class="literal">ml2</code>.
    </p></li><li class="step"><p>
     As <span class="guimenu">Modular Layer 2 mechanism drive</span>, select
     <code class="literal">cisco_nexus</code>.
    </p></li><li class="step"><p>
     In <span class="guimenu">Modular Layer2 type drivers</span>, select
     <code class="literal">vlan</code>.
    </p></li><li class="step"><p>
     In the <span class="guimenu">Cisco Switch Credentials</span> table, enter the
     <span class="guimenu">IP Address</span>, the SSH
     <span class="guimenu">Port</span> number and the login credentials for the
     switch's management interface. If you have multiple switches, open a
     new row in the table by clicking <span class="guimenu">Add</span> and enter the
     data for another switch.
    </p><div class="figure" id="id-1.4.8.5.2.5.2"><div class="figure-contents"><div class="mediaobject"><a href="images/depl_barclamp_network_cisco.png"><img src="images/depl_barclamp_network_cisco.png" width="75%" alt="The neutron barclamp: Cisco Plugin" title="The neutron barclamp: Cisco Plugin"/></a></div></div><div class="title-container"><div class="figure-title-wrap"><div class="figure-title"><span class="title-number-name"><span class="title-number">Figure A.1: </span><span class="title-name">The neutron barclamp: Cisco Plugin </span></span><a title="Permalink" class="permalink" href="app-deploy-cisco.html#id-1.4.8.5.2.5.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a></div></div></div></li><li class="step"><p>
     Choose whether to encrypt public communication
     (<span class="guimenu">HTTPS</span>) or not (<span class="guimenu">HTTP</span>). If
     choosing <span class="guimenu">HTTPS</span>, refer to
     <a class="xref" href="cha-depl-ostack.html#sec-depl-ostack-keystone-ssl">SSL Support: Protocol
    </a> for configuration
     details.
    </p></li><li class="step"><p>
     Choose a node for deployment and <span class="guimenu">Apply</span> the proposal.
    </p></li><li class="step"><p>
     Deploy nova (see <a class="xref" href="cha-depl-ostack.html#sec-depl-ostack-nova" title="12.11. Deploying nova">Section 12.11, “Deploying nova”</a>),
     horizon (see <a class="xref" href="cha-depl-ostack.html#sec-depl-ostack-dash" title="12.12. Deploying horizon (OpenStack Dashboard)">Section 12.12, “Deploying horizon (<span class="productname">OpenStack</span> Dashboard)”</a> and all other
     remaining barclamps.
    </p></li><li class="step"><p>
     When all barclamps have been deployed, return to the neutron
     barclamp by choosing <span class="guimenu">Barclamps</span> › <span class="guimenu">OpenStack</span> › <span class="guimenu">neutron</span> › <span class="guimenu">Edit</span>. The proposal now contains an
     additional table named <span class="guimenu">Assign Switch Ports</span>, listing
     all Compute Nodes.
    </p><p>
     For each Compute Node enter the switch it is connected to and the port
     number from the notes you took earlier. The values need to be entered
     like the following: <code class="literal">1/13</code> or
     <code class="literal">Eth1/20</code>.
    </p></li><li class="step"><p>
     When you have entered the data for all Compute Nodes, re-apply the
     proposal.
    </p><div id="id-1.4.8.5.2.10.2" data-id-title="Deploying Additional Compute Nodes" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Deploying Additional Compute Nodes</div><p>
      Whenever you deploy additional Compute Nodes to an active SUSE <span class="productname">OpenStack</span> Cloud
      deployment using the Cisco plugin with neutron, update
      the neutron barclamp proposal by entering their port data as
      described in the previous step.
     </p></div></li></ol></div></div><div id="id-1.4.8.5.3" data-id-title="Verifying the Setup" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Verifying the Setup</div><p>
    To verify if neutron was correctly deployed, do the following:
   </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
      Launch an instance (refer to the <em class="citetitle">User Guide</em>, chapter
      <em class="citetitle">Launch and manage instances</em>

      for instructions).
     </p></li><li class="listitem"><p>
      Find out which VLAN was assigned to the network by running the command
      <code class="command">openstack network show fixed</code>. The result lists a
      <span class="guimenu">segmentation_id</span> matching the VLAN.
     </p></li><li class="listitem"><p>
      Log in to the switch's management interface and list the VLAN
      configuration. If the setup was deployed correctly, the port of the
      Compute Node the instance is running on, is in trunk mode for the
      matching VLAN.
     </p></li></ol></div></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-depl-trouble.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 18 </span>Troubleshooting and Support</span></a> </div><div><a class="pagination-link next" href="app-deploy-docupdates.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Appendix B </span>Documentation Updates</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="app-deploy-cisco.html#app-deploy-cisco-requirements"><span class="title-number">A.1 </span><span class="title-name">Requirements</span></a></span></li><li><span class="sect1"><a href="app-deploy-cisco.html#app-deploy-cisco-deploy"><span class="title-number">A.2 </span><span class="title-name">Deploying neutron with the Cisco Plugin</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>