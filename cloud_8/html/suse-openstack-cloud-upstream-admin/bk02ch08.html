<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Shared File Systems | OpenStack Administrator Guide | SUSE OpenStack Cloud 8</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 3.2.0 (https://opensuse.github.io/daps) using SUSE XSL Stylesheets 2.81.0 (based on DocBook XSL Stylesheets 1.79.2) - chunked" /><meta name="product-name" content="SUSE OpenStack Cloud" /><meta name="product-number" content="8" /><meta name="book-title" content="OpenStack Administrator Guide" /><meta name="chapter-title" content="Chapter 8. Shared File Systems" /><meta name="description" content="Shared File Systems service provides a set of services for management of shared file systems in a multi-project cloud environment. The service resembles OpenStack block-based storage management from the OpenStack Block Storage service project. With the Shared File Systems service, you can create a r…" /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 8" /><link rel="home" href="index.html" title="SUSE OpenStack Cloud Crowbar 8 Documentation" /><link rel="up" href="book-upstream-admin.html" title="OpenStack Administrator Guide" /><link rel="prev" href="bk02ch07.html" title="Chapter 7. Block Storage" /><link rel="next" href="networking.html" title="Chapter 9. Networking" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css"></link>');
}
else {
  document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE OpenStack Cloud Crowbar 8 Documentation"><span class="book-icon">SUSE OpenStack Cloud Crowbar 8 Documentation</span></a><span> › </span><a class="crumb" href="book-upstream-admin.html">OpenStack Administrator Guide</a><span> › </span><a class="crumb" href="bk02ch08.html">Shared File Systems</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>OpenStack Administrator Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="bk02ch01.html"><span class="number">1 </span><span class="name">Documentation Conventions</span></a></li><li class="inactive"><a href="bk02ch02.html"><span class="number">2 </span><span class="name">Get started with OpenStack</span></a></li><li class="inactive"><a href="cha-identity.html"><span class="number">3 </span><span class="name">Identity management</span></a></li><li class="inactive"><a href="bk02ch04.html"><span class="number">4 </span><span class="name">Dashboard</span></a></li><li class="inactive"><a href="bk02ch05.html"><span class="number">5 </span><span class="name">Compute</span></a></li><li class="inactive"><a href="bk02ch06.html"><span class="number">6 </span><span class="name">Object Storage</span></a></li><li class="inactive"><a href="bk02ch07.html"><span class="number">7 </span><span class="name">Block Storage</span></a></li><li class="inactive"><a href="bk02ch08.html"><span class="number">8 </span><span class="name">Shared File Systems</span></a></li><li class="inactive"><a href="networking.html"><span class="number">9 </span><span class="name">Networking</span></a></li><li class="inactive"><a href="bk02ch10.html"><span class="number">10 </span><span class="name">Telemetry</span></a></li><li class="inactive"><a href="bk02ch11.html"><span class="number">11 </span><span class="name">Database</span></a></li><li class="inactive"><a href="bk02ch12.html"><span class="number">12 </span><span class="name">Bare Metal</span></a></li><li class="inactive"><a href="bk02ch13.html"><span class="number">13 </span><span class="name">Orchestration</span></a></li><li class="inactive"><a href="osadm-os-cli.html"><span class="number">14 </span><span class="name">OpenStack command-line clients</span></a></li><li class="inactive"><a href="bk02ch15.html"><span class="number">15 </span><span class="name">Cross-project features</span></a></li><li class="inactive"><a href="bk02ch16.html"><span class="number">16 </span><span class="name">Appendix</span></a></li><li class="inactive"><a href="bk02go01.html"><span class="number"> </span><span class="name">Glossary</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 7. Block Storage" href="bk02ch07.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 9. Networking" href="networking.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE OpenStack Cloud Crowbar 8 Documentation"><span class="book-icon">SUSE OpenStack Cloud Crowbar 8 Documentation</span></a><span> › </span><a class="crumb" href="book-upstream-admin.html">OpenStack Administrator Guide</a><span> › </span><a class="crumb" href="bk02ch08.html">Shared File Systems</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 7. Block Storage" href="bk02ch07.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 9. Networking" href="networking.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="id-1.4.10"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname ">SUSE OpenStack Cloud</span> <span class="productnumber ">8</span></div><div><h1 class="title"><span class="number">8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Shared File Systems</span> <a title="Permalink" class="permalink" href="bk02ch08.html#">#</a></h1><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="bk02ch08.html#id-1.4.10.5"><span class="number">8.1 </span><span class="name">Introduction</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#id-1.4.10.6"><span class="number">8.2 </span><span class="name">Key concepts</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#id-1.4.10.7"><span class="number">8.3 </span><span class="name">Share management</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#id-1.4.10.8"><span class="number">8.4 </span><span class="name">Migrate shares</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#shared-file-systems-share-types"><span class="number">8.5 </span><span class="name">Share types</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#shared-file-systems-snapshots"><span class="number">8.6 </span><span class="name">Share snapshots</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#shared-file-systems-security-services"><span class="number">8.7 </span><span class="name">Security services</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#shared-file-systems-cgroups"><span class="number">8.8 </span><span class="name">Consistency groups</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#id-1.4.10.13"><span class="number">8.9 </span><span class="name">Share replication</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#shared-file-systems-multi-backend"><span class="number">8.10 </span><span class="name">Multi-storage configuration</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#id-1.4.10.15"><span class="number">8.11 </span><span class="name">Networking</span></a></span></dt><dt><span class="sect1"><a href="bk02ch08.html#id-1.4.10.16"><span class="number">8.12 </span><span class="name">Troubleshoot Shared File Systems service</span></a></span></dt></dl></div></div><p>Shared File Systems service provides a set of services for management of
shared file systems in a multi-project cloud environment. The service resembles
OpenStack block-based storage management from the OpenStack Block Storage
service project. With the Shared File Systems service, you can
create a remote file system, mount the file system on your instances, and then
read and write data from your instances to and from your file system.</p><p>The Shared File Systems service serves same purpose as the Amazon Elastic File
System (EFS) does.</p><div class="sect1 " id="id-1.4.10.5"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Introduction</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.5">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The OpenStack File Share service allows you to offer shared file systems
service to OpenStack users in your installation. The Shared File Systems
service can run in a single-node or multiple node configuration.
The Shared File Systems service can be configured to provision shares
from one or more back ends, so it is required to declare at least one
back end. Shared File System service contains several configurable
components.</p><p>It is important to understand these components:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Share networks</p></li><li class="listitem "><p>Shares</p></li><li class="listitem "><p>Multi-tenancy</p></li><li class="listitem "><p>Back ends</p></li></ul></div><p>The Shared File Systems service consists of four types of services,
most of which are similar to those of the Block Storage service:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
            <code class="literal">manila-api</code>
          </p></li><li class="listitem "><p>
            <code class="literal">manila-data</code>
          </p></li><li class="listitem "><p>
            <code class="literal">manila-scheduler</code>
          </p></li><li class="listitem "><p>
            <code class="literal">manila-share</code>
          </p></li></ul></div><p>Installation of first three - <code class="literal">manila-api</code>, <code class="literal">manila-data</code>, and
<code class="literal">manila-scheduler</code> is common for almost all deployments. But configuration
of <code class="literal">manila-share</code> is backend-specific and can differ from deployment to
deployment.</p></div><div class="sect1 " id="id-1.4.10.6"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Key concepts</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect2 " id="id-1.4.10.6.2"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.2">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>In the Shared File Systems service <code class="literal">share</code> is the fundamental resource unit
allocated by the Shared File System service. It represents an allocation of a
persistent, readable, and writable filesystems. Compute instances access these
filesystems. Depending on the deployment configuration, clients outside of
OpenStack can also access the filesystem.</p><div id="id-1.4.10.6.2.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>A <code class="literal">share</code> is an abstract storage object that may or may not directly
map to a "share" concept from the underlying storage provider.
See the description of <code class="literal">share instance</code> for more details.</p></div></div><div class="sect2 " id="id-1.4.10.6.3"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share instance</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.3">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This concept is tied with <code class="literal">share</code> and represents created resource on specific
back end, when <code class="literal">share</code> represents abstraction between end user and
back-end storages. In common cases, it is one-to-one relation.
One single <code class="literal">share</code> has more than one <code class="literal">share instance</code> in two cases:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>When <code class="literal">share migration</code> is being applied</p></li><li class="listitem "><p>When <code class="literal">share replication</code> is enabled</p></li></ul></div><p>Therefore, each <code class="literal">share instance</code> stores information specific to real
allocated resource on storage. And <code class="literal">share</code> represents the information
that is common for <code class="literal">share instances</code>.
A user with <code class="literal">member</code> role will not be able to work with it directly. Only
a user with <code class="literal">admin</code> role has rights to perform actions against specific
share instances.</p></div><div class="sect2 " id="id-1.4.10.6.4"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Snapshot</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.4">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>A <code class="literal">snapshot</code> is a point-in-time, read-only copy of a <code class="literal">share</code>. You can
create <code class="literal">Snapshots</code> from an existing, operational <code class="literal">share</code> regardless
of whether a client has mounted the file system. A <code class="literal">snapshot</code>
can serve as the content source for a new <code class="literal">share</code>. Specify the
<span class="bold"><strong>Create from snapshot</strong></span> option when creating a new <code class="literal">share</code> on the
dashboard.</p></div><div class="sect2 " id="id-1.4.10.6.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Storage Pools</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>With the Kilo release of OpenStack, Shared File Systems can use
<code class="literal">storage pools</code>. The storage may present one or more logical storage
resource pools that the Shared File Systems service
will select as a storage location when provisioning <code class="literal">shares</code>.</p></div><div class="sect2 " id="id-1.4.10.6.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share Type</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.6">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p><code class="literal">Share type</code> is an abstract collection of criteria used to characterize
<code class="literal">shares</code>. They are most commonly used to create a hierarchy of functional
capabilities. This hierarchy represents tiered storage services levels. For
example, an administrator might define a premium <code class="literal">share type</code> that
indicates a greater level of performance than a basic <code class="literal">share type</code>.
Premium represents the best performance level.</p></div><div class="sect2 " id="id-1.4.10.6.7"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share Access Rules</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.7">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p><code class="literal">Share access rules</code> define which users can access a particular <code class="literal">share</code>.
For example, administrators can declare rules for NFS shares by
listing the valid IP networks which will access the <code class="literal">share</code>. List the
IP networks in CIDR notation.</p></div><div class="sect2 " id="id-1.4.10.6.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Security Services</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p><code class="literal">Security services``allow granular client access rules for
administrators. They can declare rules for authentication or
authorization to access ``share</code> content. External services including LDAP,
Active Directory, and Kerberos can be declared as resources. Examine and
consult these resources when making an access decision for a
particular <code class="literal">share</code>. You can associate <code class="literal">Shares</code> with multiple
security services, but only one service per one type.</p></div><div class="sect2 " id="id-1.4.10.6.9"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share Networks</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.9">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>A <code class="literal">share network</code> is an object that defines a relationship between a
project network and subnet, as defined in an OpenStack Networking service or
Compute service. The <code class="literal">share network</code> is also defined in <code class="literal">shares</code>
created by the same project. A project may find it desirable to
provision <code class="literal">shares</code> such that only instances connected to a particular
OpenStack-defined network have access to the <code class="literal">share</code>. Also,
<code class="literal">security services</code> can be attached to <code class="literal">share networks</code>,
because most of auth protocols require some interaction with network services.</p><p>The Shared File Systems service has the ability to work outside of OpenStack.
That is due to the <code class="literal">StandaloneNetworkPlugin</code>. The plugin is compatible with
any network platform, and does not require specific network services in
OpenStack like Compute or Networking service. You can set the network
parameters in the <code class="literal">manila.conf</code> file.</p></div><div class="sect2 " id="id-1.4.10.6.10"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.2.9 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share Servers</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.6.10">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>A <code class="literal">share server</code> is a logical entity that hosts the shares created
on a specific <code class="literal">share network</code>. A <code class="literal">share server</code> may be a
configuration object within the storage controller, or it may represent
logical resources provisioned within an OpenStack deployment used to
support the data path used to access <code class="literal">shares</code>.</p><p><code class="literal">Share servers</code> interact with network services to determine the appropriate
IP addresses on which to export <code class="literal">shares</code> according to the related <code class="literal">share
network</code>. The Shared File Systems service has a pluggable network model that
allows <code class="literal">share servers</code> to work with different implementations of
the Networking service.</p></div></div><div class="sect1 " id="id-1.4.10.7"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share management</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>A share is a remote, mountable file system. You can mount a share to and access
a share from several hosts by several users at a time.</p><p>You can create a share and associate it with a network, list shares, and show
information for, update, and delete a specified share.
You can also create snapshots of shares. To create a snapshot, you specify the
ID of the share that you want to snapshot.</p><p>The shares are based on of the supported Shared File Systems protocols:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="emphasis"><em>NFS</em></span>. Network File System (NFS).</p></li><li class="listitem "><p><span class="emphasis"><em>CIFS</em></span>. Common Internet File System (CIFS).</p></li><li class="listitem "><p><span class="emphasis"><em>GLUSTERFS</em></span>. Gluster file system (GlusterFS).</p></li><li class="listitem "><p><span class="emphasis"><em>HDFS</em></span>. Hadoop Distributed File System (HDFS).</p></li><li class="listitem "><p><span class="emphasis"><em>CEPHFS</em></span>. Ceph File System (CephFS).</p></li></ul></div><p>The Shared File Systems service provides set of drivers that enable you to use
various network file storage devices, instead of the base implementation. That
is the real purpose of the Shared File Systems service in production.</p><div class="sect2 " id="id-1.4.10.7.7"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share basic operations</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.7">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect3 " id="id-1.4.10.7.7.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">General concepts</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.7.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To create a file share, and access it, the following general concepts
are prerequisite knowledge:</p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>To create a share, use <code class="command">manila create</code> command and
specify the required arguments: the size of the share and the shared file
system protocol. <code class="literal">NFS</code>, <code class="literal">CIFS</code>, <code class="literal">GlusterFS</code>, <code class="literal">HDFS</code>, or
<code class="literal">CephFS</code> share file system protocols are supported.</p></li><li class="step "><p>You can also optionally specify the share network and the share type.</p></li><li class="step "><p>After the share becomes available, use the <code class="command">manila show</code> command
to get the share export locations.</p></li><li class="step "><p>After getting the share export locations, you can create an
<a class="xref" href="bk02ch08.html#access-to-share" title="8.3.1.8. Manage access to share">Section 8.3.1.8, “Manage access to share”</a> for the share, mount it and work with
files on the remote file system.</p></li></ol></div></div><p>There are big number of the share drivers created by different vendors in the
Shared File Systems service. As a Python class, each share driver can be set
for the <a class="xref" href="bk02ch08.html#shared-file-systems-multi-backend" title="8.10. Multi-storage configuration">Section 8.10, “Multi-storage configuration”</a> and run in the back
end to manage the share operations.</p><p>Initially there are two driver modes for the back ends:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>no share servers mode</p></li><li class="listitem "><p>share servers mode</p></li></ul></div><p>Each share driver supports one or two of possible back end modes that can be
configured in the <code class="literal">manila.conf</code> file. The configuration option
<code class="literal">driver_handles_share_servers</code> in the <code class="literal">manila.conf</code> file sets the share
servers mode or no share servers mode, and defines the driver mode for share
storage lifecycle management:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /><col class="c3" /></colgroup><thead><tr><th>
                    <p>Mode</p>
                  </th><th>
                    <p>Config option</p>
                  </th><th>
                    <p>Description</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>no share servers</p>
                  </td><td>
                    <p>driver_handles_share_servers = False</p>
                  </td><td>
                    <p>An administrator
rather than a share
driver manages the
bare metal storage
with some net
interface instead
of the presence of
the share servers.</p>
                  </td></tr><tr><td>
                    <p>share servers</p>
                  </td><td>
                    <p>driver_handles_share_servers = True</p>
                  </td><td>
                    <p>The share driver
creates the share
server and manages,
or handles, the
share server life
cycle.</p>
                  </td></tr></tbody></table></div><p>It is <a class="xref" href="bk02ch08.html#shared-file-systems-share-types" title="8.5. Share types">Section 8.5, “Share types”</a> which have the
extra specifications that help scheduler to filter back ends and choose the
appropriate back end for the user that requested to create a share. The
required extra boolean specification for each share type is
<code class="literal">driver_handles_share_servers</code>. As an administrator, you can create the share
types with the specifications you need. For details of managing the share types
and configuration the back ends, see <a class="xref" href="bk02ch08.html#shared-file-systems-share-types" title="8.5. Share types">Section 8.5, “Share types”</a> and
<a class="xref" href="bk02ch08.html#shared-file-systems-multi-backend" title="8.10. Multi-storage configuration">Section 8.10, “Multi-storage configuration”</a> documentation.</p><p>You can create a share in two described above modes:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>in a no share servers mode without specifying the share network and
specifying the share type with <code class="literal">driver_handles_share_servers = False</code>
parameter. See subsection <a class="xref" href="bk02ch08.html#create-share-in-no-share-server-mode" title="8.3.1.2. Create a share in no share servers mode">Section 8.3.1.2, “Create a share in no share servers mode”</a>.</p></li><li class="listitem "><p>in a share servers mode with specifying the share network and the share
type with <code class="literal">driver_handles_share_servers = True</code> parameter. See subsection
<a class="xref" href="bk02ch08.html#create-share-in-share-server-mode" title="8.3.1.3. Create a share in share servers mode">Section 8.3.1.3, “Create a share in share servers mode”</a>.</p></li></ul></div></div><div class="sect3 " id="create-share-in-no-share-server-mode"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Create a share in no share servers mode</span> <a title="Permalink" class="permalink" href="bk02ch08.html#create-share-in-no-share-server-mode">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>create-share-in-no-share-server-mode</li></ul></div></div></div></div><p>To create a file share in no share servers mode, you need to:</p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>To create a share, use <code class="command">manila create</code> command and
specify the required arguments: the size of the share and the shared file
system protocol. <code class="literal">NFS</code>, <code class="literal">CIFS</code>, <code class="literal">GlusterFS</code>, <code class="literal">HDFS</code>, or
<code class="literal">CephFS</code> share file system protocols are supported.</p></li><li class="step "><p>You should specify the <a class="xref" href="bk02ch08.html#shared-file-systems-share-types" title="8.5. Share types">Section 8.5, “Share types”</a>
with <code class="literal">driver_handles_share_servers = False</code> extra specification.</p></li><li class="step "><p>You must not specify the <code class="literal">share network</code> because no share servers are
created. In this mode the Shared File Systems service expects that
administrator has some bare metal storage with some net interface.</p></li><li class="step "><p>The <code class="command">manila create</code> command creates a share. This command does the
following things:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>The <a class="xref" href="bk02ch08.html#shared-file-systems-scheduling" title="8.10.1. Scheduling">Section 8.10.1, “Scheduling”</a> service will
find the back end with <code class="literal">driver_handles_share_servers = False</code> mode due
to filtering the extra specifications of the share type.</p></li><li class="listitem "><p>The share is created using the storage that is specified in the found
back end.</p></li></ul></div></li><li class="step "><p>After the share becomes available, use the <code class="command">manila show</code> command
to get the share export locations.</p></li></ol></div></div><p>In the example to create a share, the created already share type named
<code class="literal">my_type</code> with <code class="literal">driver_handles_share_servers = False</code> extra specification
is used.</p><p>Check share types that exist, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila type-list
+------+---------+------------+------------+--------------------------------------+-------------------------+
| ID   | Name    | visibility | is_default | required_extra_specs                 | optional_extra_specs    |
+------+---------+------------+------------+--------------------------------------+-------------------------+
| %ID% | my_type | public     | -          | driver_handles_share_servers : False | snapshot_support : True |
+------+---------+------------+------------+--------------------------------------+-------------------------+</pre></div><p>Create a private share with <code class="literal">my_type</code> share type, NFS shared file system
protocol, and size 1 GB:</p><div class="verbatim-wrap"><pre class="screen">$ manila create nfs 1 --name Share1 --description "My share" --share-type my_type
+-----------------------------+--------------------------------------+
| Property                    | Value                                |
+-----------------------------+--------------------------------------+
| status                      | creating                             |
| share_type_name             | my_type                              |
| description                 | My share                             |
| availability_zone           | None                                 |
| share_network_id            | None                                 |
| share_server_id             | None                                 |
| host                        |                                      |
| access_rules_status         | active                               |
| snapshot_id                 | None                                 |
| is_public                   | False                                |
| task_state                  | None                                 |
| snapshot_support            | True                                 |
| id                          | 10f5a2a1-36f5-45aa-a8e6-00e94e592e88 |
| size                        | 1                                    |
| name                        | Share1                               |
| share_type                  | 14ee8575-aac2-44af-8392-d9c9d344f392 |
| has_replicas                | False                                |
| replication_type            | None                                 |
| created_at                  | 2016-03-25T12:02:46.000000           |
| share_proto                 | NFS                                  |
| consistency_group_id        | None                                 |
| source_cgsnapshot_member_id | None                                 |
| project_id                  | 907004508ef4447397ce6741a8f037c1     |
| metadata                    | {}                                   |
+-----------------------------+--------------------------------------+</pre></div><p>New share <code class="literal">Share2</code> should have a status <code class="literal">available</code>:</p><div class="verbatim-wrap"><pre class="screen">$ manila show Share2
+-----------------------------+----------------------------------------------------------+
| Property                    | Value                                                    |
+-----------------------------+----------------------------------------------------------+
| status                      | available                                                |
| share_type_name             | my_type                                                  |
| description                 | My share                                                 |
| availability_zone           | nova                                                     |
| share_network_id            | None                                                     |
| export_locations            |                                                          |
|                             | path = 10.0.0.4:/shares/manila_share_a5fb1ab7_...        |
|                             | preferred = False                                        |
|                             | is_admin_only = False                                    |
|                             | id = 9e078eee-bcad-40b8-b4fe-1c916cf98ed1                |
|                             | share_instance_id = a5fb1ab7-0bbd-465b-ac14-05706294b6e9 |
|                             | path = 172.18.198.52:/shares/manila_share_a5fb1ab7_...   |
|                             | preferred = False                                        |
|                             | is_admin_only = True                                     |
|                             | id = 44933f59-e0e3-4483-bb88-72ba7c486f41                |
|                             | share_instance_id = a5fb1ab7-0bbd-465b-ac14-05706294b6e9 |
| share_server_id             | None                                                     |
| host                        | manila@paris#epsilon                                     |
| access_rules_status         | active                                                   |
| snapshot_id                 | None                                                     |
| is_public                   | False                                                    |
| task_state                  | None                                                     |
| snapshot_support            | True                                                     |
| id                          | 10f5a2a1-36f5-45aa-a8e6-00e94e592e88                     |
| size                        | 1                                                        |
| name                        | Share1                                                   |
| share_type                  | 14ee8575-aac2-44af-8392-d9c9d344f392                     |
| has_replicas                | False                                                    |
| replication_type            | None                                                     |
| created_at                  | 2016-03-25T12:02:46.000000                               |
| share_proto                 | NFS                                                      |
| consistency_group_id        | None                                                     |
| source_cgsnapshot_member_id | None                                                     |
| project_id                  | 907004508ef4447397ce6741a8f037c1                         |
| metadata                    | {}                                                       |
+-----------------------------+----------------------------------------------------------+</pre></div></div><div class="sect3 " id="create-share-in-share-server-mode"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Create a share in share servers mode</span> <a title="Permalink" class="permalink" href="bk02ch08.html#create-share-in-share-server-mode">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>create-share-in-share-server-mode</li></ul></div></div></div></div><p>To create a file share in share servers mode, you need to:</p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>To create a share, use <code class="command">manila create</code> command and
specify the required arguments: the size of the share and the shared file
system protocol. <code class="literal">NFS</code>, <code class="literal">CIFS</code>, <code class="literal">GlusterFS</code>, <code class="literal">HDFS</code>, or
<code class="literal">CephFS</code> share file system protocols are supported.</p></li><li class="step "><p>You should specify the <a class="xref" href="bk02ch08.html#shared-file-systems-share-types" title="8.5. Share types">Section 8.5, “Share types”</a>
with <code class="literal">driver_handles_share_servers = True</code> extra specification.</p></li><li class="step "><p>You should specify the
<a class="xref" href="bk02ch08.html#shared-file-systems-share-networks" title="8.11.1. Share networks">Section 8.11.1, “Share networks”</a>.</p></li><li class="step "><p>The <code class="command">manila create</code> command creates a share. This command does the
following things:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>The <a class="xref" href="bk02ch08.html#shared-file-systems-scheduling" title="8.10.1. Scheduling">Section 8.10.1, “Scheduling”</a> service will
find the back end with <code class="literal">driver_handles_share_servers = True</code> mode due to
filtering the extra specifications of the share type.</p></li><li class="listitem "><p>The share driver will create a share server with the share network. For
details of creating the resources, see the <a class="link" href="http://docs.openstack.org/developer/manila/devref/index.html#share-backends" target="_blank">documentation</a> of the
specific share driver.</p></li></ul></div></li><li class="step "><p>After the share becomes available, use the <code class="command">manila show</code> command
to get the share export location.</p></li></ol></div></div><p>In the example to create a share, the default share type and the already
existing share network are used.</p><div id="id-1.4.10.7.7.4.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>There is no default share type just after you started manila as the
administrator. See <a class="xref" href="bk02ch08.html#shared-file-systems-share-types" title="8.5. Share types">Section 8.5, “Share types”</a> to
create the default share type. To create a share network, use
<a class="xref" href="bk02ch08.html#shared-file-systems-share-networks" title="8.11.1. Share networks">Section 8.11.1, “Share networks”</a>.</p></div><p>Check share types that exist, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila type-list
+------+---------+------------+------------+--------------------------------------+-------------------------+
| ID   | Name    | visibility | is_default | required_extra_specs                 | optional_extra_specs    |
+------+---------+------------+------------+--------------------------------------+-------------------------+
| %id% | default | public     | YES        | driver_handles_share_servers : True  | snapshot_support : True |
+------+---------+------------+------------+--------------------------------------+-------------------------+</pre></div><p>Check share networks that exist, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila share-network-list
+--------------------------------------+--------------+
| id                                   | name         |
+--------------------------------------+--------------+
| c895fe26-92be-4152-9e6c-f2ad230efb13 | my_share_net |
+--------------------------------------+--------------+</pre></div><p>Create a public share with <code class="literal">my_share_net</code> network, <code class="literal">default</code>
share type, NFS shared file system protocol, and size 1 GB:</p><div class="verbatim-wrap"><pre class="screen">$ manila create nfs 1 \
    --name "Share2" \
    --description "My second share" \
    --share-type default \
    --share-network my_share_net \
    --metadata aim=testing \
    --public
+-----------------------------+--------------------------------------+
| Property                    | Value                                |
+-----------------------------+--------------------------------------+
| status                      | creating                             |
| share_type_name             | default                              |
| description                 | My second share                      |
| availability_zone           | None                                 |
| share_network_id            | c895fe26-92be-4152-9e6c-f2ad230efb13 |
| share_server_id             | None                                 |
| host                        |                                      |
| access_rules_status         | active                               |
| snapshot_id                 | None                                 |
| is_public                   | True                                 |
| task_state                  | None                                 |
| snapshot_support            | True                                 |
| id                          | 195e3ba2-9342-446a-bc93-a584551de0ac |
| size                        | 1                                    |
| name                        | Share2                               |
| share_type                  | bf6ada49-990a-47c3-88bc-c0cb31d5c9bf |
| has_replicas                | False                                |
| replication_type            | None                                 |
| created_at                  | 2016-03-25T12:13:40.000000           |
| share_proto                 | NFS                                  |
| consistency_group_id        | None                                 |
| source_cgsnapshot_member_id | None                                 |
| project_id                  | 907004508ef4447397ce6741a8f037c1     |
| metadata                    | {u'aim': u'testing'}                 |
+-----------------------------+--------------------------------------+</pre></div><p>The share also can be created from a share snapshot. For details, see
<a class="xref" href="bk02ch08.html#shared-file-systems-snapshots" title="8.6. Share snapshots">Section 8.6, “Share snapshots”</a>.</p><p>See the share in a share list:</p><div class="verbatim-wrap"><pre class="screen">$ manila list
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+
| ID                                   | Name    | Size | Share Proto | Status    | Is Public | Share Type Name | Host                 | Availability Zone |
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+
| 10f5a2a1-36f5-45aa-a8e6-00e94e592e88 | Share1  | 1    | NFS         | available | False     | my_type         | manila@paris#epsilon | nova              |
| 195e3ba2-9342-446a-bc93-a584551de0ac | Share2  | 1    | NFS         | available | True      | default         | manila@london#LONDON | nova              |
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+</pre></div><p>Check the share status and see the share export locations. After <code class="literal">creating</code>
status share should have status <code class="literal">available</code>:</p><div class="verbatim-wrap"><pre class="screen">$ manila show Share2
+----------------------+----------------------------------------------------------------------+
| Property             | Value                                                                |
+----------------------+----------------------------------------------------------------------+
| status               | available                                                            |
| share_type_name      | default                                                              |
| description          | My second share                                                      |
| availability_zone    | nova                                                                 |
| share_network_id     | c895fe26-92be-4152-9e6c-f2ad230efb13                                 |
| export_locations     |                                                                      |
|                      | path = 10.254.0.3:/shares/share-fe874928-39a2-441b-8d24-29e6f0fde965 |
|                      | preferred = False                                                    |
|                      | is_admin_only = False                                                |
|                      | id = de6d4012-6158-46f0-8b28-4167baca51a7                            |
|                      | share_instance_id = fe874928-39a2-441b-8d24-29e6f0fde965             |
|                      | path = 10.0.0.3:/shares/share-fe874928-39a2-441b-8d24-29e6f0fde965   |
|                      | preferred = False                                                    |
|                      | is_admin_only = True                                                 |
|                      | id = 602d0f5c-921b-4e45-bfdb-5eec8a89165a                            |
|                      | share_instance_id = fe874928-39a2-441b-8d24-29e6f0fde965             |
| share_server_id      | 2e9d2d02-883f-47b5-bb98-e053b8d1e683                                 |
| host                 | manila@london#LONDON                                                 |
| access_rules_status  | active                                                               |
| snapshot_id          | None                                                                 |
| is_public            | True                                                                 |
| task_state           | None                                                                 |
| snapshot_support     | True                                                                 |
| id                   | 195e3ba2-9342-446a-bc93-a584551de0ac                                 |
| size                 | 1                                                                    |
| name                 | Share2                                                               |
| share_type           | bf6ada49-990a-47c3-88bc-c0cb31d5c9bf                                 |
| has_replicas         | False                                                                |
| replication_type     | None                                                                 |
| created_at           | 2016-03-25T12:13:40.000000                                           |
| share_proto          | NFS                                                                  |
| consistency_group_id | None                                                                 |
| project_id           | 907004508ef4447397ce6741a8f037c1                                     |
| metadata             | {u'aim': u'testing'}                                                 |
+----------------------+----------------------------------------------------------------------+</pre></div><p><code class="literal">is_public</code> defines the level of visibility for the share: whether other
projects can or cannot see the share. By default, the share is private.</p></div><div class="sect3 " id="id-1.4.10.7.7.5"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.1.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Update share</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.7.5">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Update the name, or description, or level of visibility for all projects for
the share if you need:</p><div class="verbatim-wrap"><pre class="screen">$ manila update Share2 --description "My second share. Updated" --is-public False

$ manila show Share2
+----------------------+----------------------------------------------------------------------+
| Property             | Value                                                                |
+----------------------+----------------------------------------------------------------------+
| status               | available                                                            |
| share_type_name      | default                                                              |
| description          | My second share. Updated                                             |
| availability_zone    | nova                                                                 |
| share_network_id     | c895fe26-92be-4152-9e6c-f2ad230efb13                                 |
| export_locations     |                                                                      |
|                      | path = 10.254.0.3:/shares/share-fe874928-39a2-441b-8d24-29e6f0fde965 |
|                      | preferred = False                                                    |
|                      | is_admin_only = False                                                |
|                      | id = de6d4012-6158-46f0-8b28-4167baca51a7                            |
|                      | share_instance_id = fe874928-39a2-441b-8d24-29e6f0fde965             |
|                      | path = 10.0.0.3:/shares/share-fe874928-39a2-441b-8d24-29e6f0fde965   |
|                      | preferred = False                                                    |
|                      | is_admin_only = True                                                 |
|                      | id = 602d0f5c-921b-4e45-bfdb-5eec8a89165a                            |
|                      | share_instance_id = fe874928-39a2-441b-8d24-29e6f0fde965             |
| share_server_id      | 2e9d2d02-883f-47b5-bb98-e053b8d1e683                                 |
| host                 | manila@london#LONDON                                                 |
| access_rules_status  | active                                                               |
| snapshot_id          | None                                                                 |
| is_public            | False                                                                |
| task_state           | None                                                                 |
| snapshot_support     | True                                                                 |
| id                   | 195e3ba2-9342-446a-bc93-a584551de0ac                                 |
| size                 | 1                                                                    |
| name                 | Share2                                                               |
| share_type           | bf6ada49-990a-47c3-88bc-c0cb31d5c9bf                                 |
| has_replicas         | False                                                                |
| replication_type     | None                                                                 |
| created_at           | 2016-03-25T12:13:40.000000                                           |
| share_proto          | NFS                                                                  |
| consistency_group_id | None                                                                 |
| project_id           | 907004508ef4447397ce6741a8f037c1                                     |
| metadata             | {u'aim': u'testing'}                                                 |
+----------------------+----------------------------------------------------------------------+</pre></div><p>A share can have one of these status values:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Status</p>
                  </th><th>
                    <p>Description</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>creating</p>
                  </td><td>
                    <p>The share is being created.</p>
                  </td></tr><tr><td>
                    <p>deleting</p>
                  </td><td>
                    <p>The share is being deleted.</p>
                  </td></tr><tr><td>
                    <p>error</p>
                  </td><td>
                    <p>An error occurred during share creation.</p>
                  </td></tr><tr><td>
                    <p>error_deleting</p>
                  </td><td>
                    <p>An error occurred during share deletion.</p>
                  </td></tr><tr><td>
                    <p>available</p>
                  </td><td>
                    <p>The share is ready to use.</p>
                  </td></tr><tr><td>
                    <p>manage_starting</p>
                  </td><td>
                    <p>Share manage started.</p>
                  </td></tr><tr><td>
                    <p>manage_error</p>
                  </td><td>
                    <p>Share manage failed.</p>
                  </td></tr><tr><td>
                    <p>unmanage_starting</p>
                  </td><td>
                    <p>Share unmanage started.</p>
                  </td></tr><tr><td>
                    <p>unmanage_error</p>
                  </td><td>
                    <p>Share cannot be unmanaged.</p>
                  </td></tr><tr><td>
                    <p>unmanaged</p>
                  </td><td>
                    <p>Share was unmanaged.</p>
                  </td></tr><tr><td>
                    <p>extending</p>
                  </td><td>
                    <p>The extend, or increase, share size
request was issued successfully.</p>
                  </td></tr><tr><td>
                    <p>extending_error</p>
                  </td><td>
                    <p>Extend share failed.</p>
                  </td></tr><tr><td>
                    <p>shrinking</p>
                  </td><td>
                    <p>Share is being shrunk.</p>
                  </td></tr><tr><td>
                    <p>shrinking_error</p>
                  </td><td>
                    <p>Failed to update quota on share
shrinking.</p>
                  </td></tr><tr><td>
                    <p>shrinking_possible_data_loss_error</p>
                  </td><td>
                    <p>Shrink share failed due to possible data
loss.</p>
                  </td></tr><tr><td>
                    <p>migrating</p>
                  </td><td>
                    <p>Share migration is in progress.</p>
                  </td></tr></tbody></table></div></div><div class="sect3 " id="id-1.4.10.7.7.6"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.1.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share metadata</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.7.6">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>If you want to set the metadata key-value pairs on the share, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila metadata Share2 set project=my_abc deadline=01/20/16</pre></div><p>Get all metadata key-value pairs of the share:</p><div class="verbatim-wrap"><pre class="screen">$ manila metadata-show Share2
+----------+----------+
| Property | Value    |
+----------+----------+
| aim      | testing  |
| project  | my_abc   |
| deadline | 01/20/16 |
+----------+----------+</pre></div><p>You can update the metadata:</p><div class="verbatim-wrap"><pre class="screen">$ manila metadata-update-all Share2 deadline=01/30/16
+----------+----------+
| Property | Value    |
+----------+----------+
| deadline | 01/30/16 |
+----------+----------+</pre></div><p>You also can unset the metadata using
<span class="bold"><strong>manila metadata &lt;share_name&gt; unset &lt;metadata_key(s)&gt;</strong></span>.</p></div><div class="sect3 " id="id-1.4.10.7.7.7"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.1.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Reset share state</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.7.7">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>As administrator, you can reset the state of a share.</p><p>Use <span class="bold"><strong>manila reset-state [--state &lt;state&gt;] &lt;share&gt;</strong></span> command to reset share
state, where <code class="literal">state</code> indicates which state to assign the share. Options
include <code class="literal">available</code>, <code class="literal">error</code>, <code class="literal">creating</code>, <code class="literal">deleting</code>,
<code class="literal">error_deleting</code> states.</p><div class="verbatim-wrap"><pre class="screen">$ manila reset-state Share2 --state deleting

$ manila show Share2
+----------------------+----------------------------------------------------------------------+
| Property             | Value                                                                |
+----------------------+----------------------------------------------------------------------+
| status               | deleting                                                             |
| share_type_name      | default                                                              |
| description          | My second share. Updated                                             |
| availability_zone    | nova                                                                 |
| share_network_id     | c895fe26-92be-4152-9e6c-f2ad230efb13                                 |
| export_locations     |                                                                      |
|                      | path = 10.254.0.3:/shares/share-fe874928-39a2-441b-8d24-29e6f0fde965 |
|                      | preferred = False                                                    |
|                      | is_admin_only = False                                                |
|                      | id = de6d4012-6158-46f0-8b28-4167baca51a7                            |
|                      | share_instance_id = fe874928-39a2-441b-8d24-29e6f0fde965             |
|                      | path = 10.0.0.3:/shares/share-fe874928-39a2-441b-8d24-29e6f0fde965   |
|                      | preferred = False                                                    |
|                      | is_admin_only = True                                                 |
|                      | id = 602d0f5c-921b-4e45-bfdb-5eec8a89165a                            |
|                      | share_instance_id = fe874928-39a2-441b-8d24-29e6f0fde965             |
| share_server_id      | 2e9d2d02-883f-47b5-bb98-e053b8d1e683                                 |
| host                 | manila@london#LONDON                                                 |
| access_rules_status  | active                                                               |
| snapshot_id          | None                                                                 |
| is_public            | False                                                                |
| task_state           | None                                                                 |
| snapshot_support     | True                                                                 |
| id                   | 195e3ba2-9342-446a-bc93-a584551de0ac                                 |
| size                 | 1                                                                    |
| name                 | Share2                                                               |
| share_type           | bf6ada49-990a-47c3-88bc-c0cb31d5c9bf                                 |
| has_replicas         | False                                                                |
| replication_type     | None                                                                 |
| created_at           | 2016-03-25T12:13:40.000000                                           |
| share_proto          | NFS                                                                  |
| consistency_group_id | None                                                                 |
| project_id           | 907004508ef4447397ce6741a8f037c1                                     |
| metadata             | {u'deadline': u'01/30/16'}                                           |
+----------------------+----------------------------------------------------------------------+</pre></div></div><div class="sect3 " id="id-1.4.10.7.7.8"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.1.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Delete and force-delete share</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.7.8">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>You also can force-delete a share.
The shares cannot be deleted in transitional states. The transitional
states are <code class="literal">creating</code>, <code class="literal">deleting</code>, <code class="literal">managing</code>, <code class="literal">unmanaging</code>,
<code class="literal">migrating</code>, <code class="literal">extending</code>, and <code class="literal">shrinking</code> statuses for the shares.
Force-deletion deletes an object in any state. Use the <code class="literal">policy.json</code> file
to grant permissions for this action to other roles.</p><div id="id-1.4.10.7.7.8.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.png" /><h6>Tip</h6><p>The configuration file <code class="literal">policy.json</code> may be used from different places.
The path <code class="literal">/etc/manila/policy.json</code> is one of expected paths by default.</p></div><p>Use <span class="bold"><strong>manila delete &lt;share_name_or_ID&gt;</strong></span> command to delete a specified share:</p><div class="verbatim-wrap"><pre class="screen">$ manila delete %share_name_or_id%</pre></div><div id="id-1.4.10.7.7.8.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>If you specified <a class="xref" href="bk02ch08.html#shared-file-systems-cgroups" title="8.8. Consistency groups">Section 8.8, “Consistency groups”</a>
while creating a share, you should provide the <code class="literal">--consistency-group</code>
parameter to delete the share:</p></div><div class="verbatim-wrap"><pre class="screen">$ manila delete %share_name_or_id% --consistency-group %consistency-group-id%</pre></div><p>If you try to delete the share in one of the transitional
state using soft-deletion you'll get an error:</p><div class="verbatim-wrap"><pre class="screen">$ manila delete Share2
Delete for share 195e3ba2-9342-446a-bc93-a584551de0ac failed: Invalid share: Share status must be one of ('available', 'error', 'inactive'). (HTTP 403) (Request-ID: req-9a77b9a0-17d2-4d97-8a7a-b7e23c27f1fe)
ERROR: Unable to delete any of the specified shares.</pre></div><p>A share cannot be deleted in a transitional status, that it why an error from
<code class="literal">python-manilaclient</code> appeared.</p><p>Print the list of all shares for all projects:</p><div class="verbatim-wrap"><pre class="screen">$ manila list --all-tenants
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+
| ID                                   | Name    | Size | Share Proto | Status    | Is Public | Share Type Name | Host                 | Availability Zone |
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+
| 10f5a2a1-36f5-45aa-a8e6-00e94e592e88 | Share1  | 1    | NFS         | available | False     | my_type         | manila@paris#epsilon | nova              |
| 195e3ba2-9342-446a-bc93-a584551de0ac | Share2  | 1    | NFS         | available | False     | default         | manila@london#LONDON | nova              |
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+</pre></div><p>Force-delete Share2 and check that it is absent in the list of shares,
run:</p><div class="verbatim-wrap"><pre class="screen">$ manila force-delete Share2

$ manila list
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+
| ID                                   | Name    | Size | Share Proto | Status    | Is Public | Share Type Name | Host                 | Availability Zone |
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+
| 10f5a2a1-36f5-45aa-a8e6-00e94e592e88 | Share1  | 1    | NFS         | available | False     | my_type         | manila@paris#epsilon | nova              |
+--------------------------------------+---------+------+-------------+-----------+-----------+-----------------+----------------------+-------------------+</pre></div></div><div class="sect3 " id="access-to-share"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.1.8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Manage access to share</span> <a title="Permalink" class="permalink" href="bk02ch08.html#access-to-share">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>access-to-share</li></ul></div></div></div></div><p>The Shared File Systems service allows to grant or deny access to a specified
share, and list the permissions for a specified share.</p><p>To grant or deny access to a share, specify one of these supported share
access levels:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="bold"><strong>rw</strong></span>. Read and write (RW) access. This is the default value.</p></li><li class="listitem "><p><span class="bold"><strong>ro</strong></span>. Read-only (RO) access.</p></li></ul></div><p>You must also specify one of these supported authentication methods:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="bold"><strong>ip</strong></span>. Authenticates an instance through its IP address. A valid
format is <code class="literal">XX.XX.XX.XX</code> or <code class="literal">XX.XX.XX.XX/XX</code>. For example <code class="literal">0.0.0.0/0</code>.</p></li><li class="listitem "><p><span class="bold"><strong>user</strong></span>. Authenticates by a specified user or group name. A valid value is
an alphanumeric string that can contain some special characters and is from
4 to 32 characters long.</p></li><li class="listitem "><p><span class="bold"><strong>cert</strong></span>. Authenticates an instance through a TLS certificate. Specify the
TLS identity as the IDENTKEY. A valid value is any string up to 64 characters
long in the common name (CN) of the certificate. The meaning of a string
depends on its interpretation.</p></li><li class="listitem "><p><span class="bold"><strong>cephx</strong></span>. Ceph authentication system. Specify the Ceph auth ID that needs
to be authenticated and authorized for share access by the Ceph back end. A
valid value must be non-empty, consist of ASCII printable characters, and not
contain periods.</p></li></ul></div><p>Try to mount NFS share with export path
<code class="literal">10.0.0.4:/shares/manila_share_a5fb1ab7_0bbd_465b_ac14_05706294b6e9</code> on the
node with IP address <code class="literal">10.0.0.13</code>:</p><div class="verbatim-wrap"><pre class="screen">$ sudo mount -v -t nfs 10.0.0.4:/shares/manila_share_a5fb1ab7_0bbd_465b_ac14_05706294b6e9 /mnt/
mount.nfs: timeout set for Tue Oct  6 10:37:23 2015
mount.nfs: trying text-based options 'vers=4,addr=10.0.0.4,clientaddr=10.0.0.13'
mount.nfs: mount(2): Permission denied
mount.nfs: access denied by server while mounting 10.0.0.4:/shares/manila_share_a5fb1ab7_0bbd_465b_ac14_05706294b6e9</pre></div><p>An error message "Permission denied" appeared, so you are not allowed to mount
a share without an access rule. Allow access to the share with <code class="literal">ip</code> access
type and <code class="literal">10.0.0.13</code> IP address:</p><div class="verbatim-wrap"><pre class="screen">$ manila access-allow Share1 ip 10.0.0.13 --access-level rw
+--------------+--------------------------------------+
| Property     | Value                                |
+--------------+--------------------------------------+
| share_id     | 10f5a2a1-36f5-45aa-a8e6-00e94e592e88 |
| access_type  | ip                                   |
| access_to    | 10.0.0.13                            |
| access_level | rw                                   |
| state        | new                                  |
| id           | de715226-da00-4cfc-b1ab-c11f3393745e |
+--------------+--------------------------------------+</pre></div><p>Try to mount a share again. This time it is mounted successfully:</p><div class="verbatim-wrap"><pre class="screen">$ sudo mount -v -t nfs 10.0.0.4:/shares/manila_share_a5fb1ab7_0bbd_465b_ac14_05706294b6e9 /mnt/</pre></div><p>Since it is allowed node on 10.0.0.13 read and write access, try to create
a file on a mounted share:</p><div class="verbatim-wrap"><pre class="screen">$ cd /mnt
$ ls
lost+found
$ touch my_file.txt</pre></div><p>Connect via SSH to the <code class="literal">10.0.0.4</code> node and check new file <code class="literal">my_file.txt</code>
in the <code class="literal">/shares/manila_share_a5fb1ab7_0bbd_465b_ac14_05706294b6e9</code> directory:</p><div class="verbatim-wrap"><pre class="screen">$ ssh 10.0.0.4
$ cd /shares
$ ls
manila_share_a5fb1ab7_0bbd_465b_ac14_05706294b6e9
$ cd manila_share_a5fb1ab7_0bbd_465b_ac14_05706294b6e9
$ ls
lost+found  my_file.txt</pre></div><p>You have successfully created a file from instance that was given access by
its IP address.</p><p>Allow access to the share with <code class="literal">user</code> access type:</p><div class="verbatim-wrap"><pre class="screen">$ manila access-allow Share1 user demo --access-level rw
+--------------+--------------------------------------+
| Property     | Value                                |
+--------------+--------------------------------------+
| share_id     | 10f5a2a1-36f5-45aa-a8e6-00e94e592e88 |
| access_type  | user                                 |
| access_to    | demo                                 |
| access_level | rw                                   |
| state        | new                                  |
| id           | 4f391c6b-fb4f-47f5-8b4b-88c5ec9d568a |
+--------------+--------------------------------------+</pre></div><div id="id-1.4.10.7.7.9.20" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>Different share features are supported by different share drivers.
For the example, the Generic driver with the Block Storage service as a
back-end doesn't support <code class="literal">user</code> and <code class="literal">cert</code> authentications methods. For
details of supporting of features by different drivers, see <a class="link" href="http://docs.openstack.org/developer/manila/devref/share_back_ends_feature_support_mapping.html" target="_blank">Manila share
features support mapping</a>.</p></div><p>To verify that the access rules (ACL) were configured correctly for a share,
you list permissions for a share:</p><div class="verbatim-wrap"><pre class="screen">$ manila access-list Share1
+--------------------------------------+-------------+------------+--------------+--------+
| id                                   | access type | access to  | access level | state  |
+--------------------------------------+-------------+------------+--------------+--------+
| 4f391c6b-fb4f-47f5-8b4b-88c5ec9d568a | user        | demo       | rw           | error  |
| de715226-da00-4cfc-b1ab-c11f3393745e | ip          | 10.0.0.13  | rw           | active |
+--------------------------------------+-------------+------------+--------------+--------+</pre></div><p>Deny access to the share and check that deleted access rule is absent in the
access rule list:</p><div class="verbatim-wrap"><pre class="screen">$ manila access-deny Share1 de715226-da00-4cfc-b1ab-c11f3393745e

$ manila access-list Share1
+--------------------------------------+-------------+-----------+--------------+-------+
| id                                   | access type | access to | access level | state |
+--------------------------------------+-------------+-----------+--------------+-------+
| 4f391c6b-fb4f-47f5-8b4b-88c5ec9d568a | user        | demo      | rw           | error |
+--------------------------------------+-------------+-----------+--------------+-------+</pre></div></div></div><div class="sect2 " id="id-1.4.10.7.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.3.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Manage and unmanage share</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To <code class="literal">manage</code> a share means that an administrator, rather than a share
driver, manages the storage lifecycle. This approach is appropriate when an
administrator already has the custom non-manila share with its size, shared
file system protocol, and export path, and an administrator wants to
register it in the Shared File System service.</p><p>To <code class="literal">unmanage</code> a share means to unregister a specified share from the Shared
File Systems service. Administrators can revert an unmanaged share to managed
status if needed.</p><div class="sect3 " id="id-1.4.10.7.8.4"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Unmanage a share</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.8.4">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The <code class="literal">unmanage</code> operation is not supported for shares that were
created on top of share servers and created with share networks.
The Share service should have the
option <code class="literal">driver_handles_share_servers = False</code>
set in the <code class="literal">manila.conf</code> file. You can unmanage a share that has
no dependent snapshots.</p><p>To unmanage managed share, run the <code class="command">manila unmanage &lt;share&gt;</code>
command. Then try to print the information about the share. The
returned result should indicate that Shared File Systems service won't
find the share:</p><div class="verbatim-wrap"><pre class="screen">$ manila unmanage share_for_docs
$ manila show share_for_docs
ERROR: No share with a name or ID of 'share_for_docs' exists.</pre></div></div><div class="sect3 " id="id-1.4.10.7.8.5"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Manage a share</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.8.5">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To register the non-managed share in the File System service, run the
<code class="command">manila manage</code> command:</p><div class="verbatim-wrap"><pre class="screen">manila manage [--name &lt;name&gt;] [--description &lt;description&gt;]
              [--share_type &lt;share-type&gt;]
              [--driver_options [&lt;key=value&gt; [&lt;key=value&gt; ...]]]
              &lt;service_host&gt; &lt;protocol&gt; &lt;export_path&gt;</pre></div><p>The positional arguments are:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>service_host. The manage-share service host in
<code class="literal">host@backend#POOL</code> format, which consists of the host name for
the back end, the name of the back end, and the pool name for the
back end.</p></li><li class="listitem "><p>protocol. The Shared File Systems protocol of the share to manage. Valid
values are NFS, CIFS, GlusterFS, or HDFS.</p></li><li class="listitem "><p>export_path. The share export path in the format appropriate for the
protocol:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>NFS protocol. 10.0.0.1:/foo_path.</p></li><li class="listitem "><p>CIFS protocol. \\10.0.0.1\foo_name_of_cifs_share.</p></li><li class="listitem "><p>HDFS protocol. hdfs://10.0.0.1:foo_port/foo_share_name.</p></li><li class="listitem "><p>GlusterFS. 10.0.0.1:/foo_volume.</p></li></ul></div></li></ul></div><p>The <code class="literal">driver_options</code> is an optional set of one or more key and value pairs
that describe driver options. Note that the share type must have the
<code class="literal">driver_handles_share_servers = False</code> option. As a result, a special share
type named <code class="literal">for_managing</code> was used in example.</p><p>To manage share, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila manage \
    manila@paris#shares \
    nfs \
    1.0.0.4:/shares/manila_share_6d2142d8_2b9b_4405_867f_8a48094c893f \
    --name share_for_docs \
    --description "We manage share." \
    --share_type for_managing
+-----------------------------+--------------------------------------+
| Property                    | Value                                |
+-----------------------------+--------------------------------------+
| status                      | manage_starting                      |
| share_type_name             | for_managing                         |
| description                 | We manage share.                     |
| availability_zone           | None                                 |
| share_network_id            | None                                 |
| share_server_id             | None                                 |
| host                        | manila@paris#shares                  |
| access_rules_status         | active                               |
| snapshot_id                 | None                                 |
| is_public                   | False                                |
| task_state                  | None                                 |
| snapshot_support            | True                                 |
| id                          | ddfb1240-ed5e-4071-a031-b842035a834a |
| size                        | None                                 |
| name                        | share_for_docs                       |
| share_type                  | 14ee8575-aac2-44af-8392-d9c9d344f392 |
| has_replicas                | False                                |
| replication_type            | None                                 |
| created_at                  | 2016-03-25T15:22:43.000000           |
| share_proto                 | NFS                                  |
| consistency_group_id        | None                                 |
| source_cgsnapshot_member_id | None                                 |
| project_id                  | 907004508ef4447397ce6741a8f037c1     |
| metadata                    | {}                                   |
+-----------------------------+--------------------------------------+</pre></div><p>Check that the share is available:</p><div class="verbatim-wrap"><pre class="screen">$ manila show share_for_docs
+----------------------+--------------------------------------------------------------------------+
| Property             | Value                                                                    |
+----------------------+--------------------------------------------------------------------------+
| status               | available                                                                |
| share_type_name      | for_managing                                                             |
| description          | We manage share.                                                         |
| availability_zone    | None                                                                     |
| share_network_id     | None                                                                     |
| export_locations     |                                                                          |
|                      | path = 1.0.0.4:/shares/manila_share_6d2142d8_2b9b_4405_867f_8a48094c893f |
|                      | preferred = False                                                        |
|                      | is_admin_only = False                                                    |
|                      | id = d4d048bf-4159-4a94-8027-e567192b8d30                                |
|                      | share_instance_id = 4c8e3887-4f9a-4775-bab4-e5840a09c34e                 |
|                      | path = 2.0.0.3:/shares/manila_share_6d2142d8_2b9b_4405_867f_8a48094c893f |
|                      | preferred = False                                                        |
|                      | is_admin_only = True                                                     |
|                      | id = 1dd4f0a3-778d-486a-a851-b522f6e7cf5f                                |
|                      | share_instance_id = 4c8e3887-4f9a-4775-bab4-e5840a09c34e                 |
| share_server_id      | None                                                                     |
| host                 | manila@paris#shares                                                      |
| access_rules_status  | active                                                                   |
| snapshot_id          | None                                                                     |
| is_public            | False                                                                    |
| task_state           | None                                                                     |
| snapshot_support     | True                                                                     |
| id                   | ddfb1240-ed5e-4071-a031-b842035a834a                                     |
| size                 | 1                                                                        |
| name                 | share_for_docs                                                           |
| share_type           | 14ee8575-aac2-44af-8392-d9c9d344f392                                     |
| has_replicas         | False                                                                    |
| replication_type     | None                                                                     |
| created_at           | 2016-03-25T15:22:43.000000                                               |
| share_proto          | NFS                                                                      |
| consistency_group_id | None                                                                     |
| project_id           | 907004508ef4447397ce6741a8f037c1                                         |
| metadata             | {}                                                                       |
+----------------------+--------------------------------------------------------------------------+</pre></div></div></div><div class="sect2 " id="id-1.4.10.7.9"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.3.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Manage and unmanage share snapshot</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.9">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To <code class="literal">manage</code> a share snapshot means that an administrator, rather than a
share driver, manages the storage lifecycle. This approach is appropriate
when an administrator manages share snapshots outside of the Shared File
Systems service and wants to register it with the service.</p><p>To <code class="literal">unmanage</code> a share snapshot means to unregister a specified share
snapshot from the Shared File Systems service. Administrators can revert an
unmanaged share snapshot to managed status if needed.</p><div class="sect3 " id="id-1.4.10.7.9.4"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Unmanage a share snapshot</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.9.4">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The <code class="literal">unmanage</code> operation is not supported for shares that were
created on top of share servers and created with share networks.
The Share service should have the option
<code class="literal">driver_handles_share_servers = False</code> set in the <code class="literal">manila.conf</code> file.</p><p>To unmanage managed share snapshot, run the :command:
<code class="literal">manila snapshot-unmanage &lt;share_snapshot&gt;</code> command. Then try to print the
information about the share snapshot. The returned result should indicate that
Shared File Systems service won't find the share snapshot:</p><div class="verbatim-wrap"><pre class="screen">$ manila snapshot-unmanage my_test_share_snapshot
$ manila snapshot-show my_test_share_snapshot
ERROR: No sharesnapshot with a name or ID of 'my_test_share_snapshot'
exists.</pre></div></div><div class="sect3 " id="id-1.4.10.7.9.5"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.3.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Manage a share snapshot</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.9.5">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To register the non-managed share snapshot in the File System service, run the
<code class="command">manila snapshot-manage</code> command:</p><div class="verbatim-wrap"><pre class="screen">manila snapshot-manage [--name &lt;name&gt;] [--description &lt;description&gt;]
              [--driver_options [&lt;key=value&gt; [&lt;key=value&gt; ...]]]
              &lt;share&gt; &lt;provider_location&gt;</pre></div><p>The positional arguments are:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>share. Name or ID of the share.</p></li><li class="listitem "><p>provider_location. Provider location of the share snapshot on the backend.</p></li></ul></div><p>The <code class="literal">driver_options</code> is an optional set of one or more key and value pairs
that describe driver options.</p><p>To manage share snapshot, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila snapshot-manage \
    9ba52cc6-c97e-4b40-8653-4bcbaaf9628d \
    4d1e2863-33dd-4243-bf39-f7354752097d \
    --name my_test_share_snapshot \
    --description "My test share snapshot" \
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| status            | manage_starting                      |
| share_id          | 9ba52cc6-c97e-4b40-8653-4bcbaaf9628d |
| user_id           | d9f4003655c94db5b16c591920be1f91     |
| description       | My test share snapshot               |
| created_at        | 2016-07-25T04:49:42.600980           |
| size              | None                                 |
| share_proto       | NFS                                  |
| provider_location | 4d1e2863-33dd-4243-bf39-f7354752097d |
| id                | 89c663b5-026d-45c7-a43b-56ef0ba0faab |
| project_id        | aaa33a0ca4324965a3e65ae47e864e94     |
| share_size        | 1                                    |
| name              | my_test_share_snapshot               |
+-------------------+--------------------------------------+</pre></div><p>Check that the share snapshot is available:</p><div class="verbatim-wrap"><pre class="screen">$ manila snapshot-show my_test_share_snapshot
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| status            | available                            |
| share_id          | 9ba52cc6-c97e-4b40-8653-4bcbaaf9628d |
| user_id           | d9f4003655c94db5b16c591920be1f91     |
| description       | My test share snapshot               |
| created_at        | 2016-07-25T04:49:42.000000           |
| size              | 1                                    |
| share_proto       | NFS                                  |
| provider_location | 4d1e2863-33dd-4243-bf39-f7354752097d |
| id                | 89c663b5-026d-45c7-a43b-56ef0ba0faab |
| project_id        | aaa33a0ca4324965a3e65ae47e864e94     |
| share_size        | 1                                    |
| name              | my_test_share_snapshot               |
+-------------------+--------------------------------------+</pre></div></div></div><div class="sect2 " id="id-1.4.10.7.10"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.3.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Resize share</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.10">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To change file share size, use the <code class="command">manila extend</code> command and
the <code class="command">manila shrink</code> command. For most drivers it is safe
operation. If you want to be sure that your data is safe, you can make
a share back up by creating a snapshot of it.</p><p>You can extend and shrink the share with the <code class="command">manila extend</code> and
<code class="command">manila shrink</code> commands respectively, and specify the share
with the new size that does not exceed the quota. For details, see
<a class="xref" href="bk02ch08.html#shared-file-systems-quotas" title="8.3.5. Quotas and limits">Section 8.3.5, “Quotas and limits”</a>. You also cannot shrink
share size to 0 or to a greater value than the current share size.</p><p>While extending, the share has an <code class="literal">extending</code> status. This means that
the increase share size request was issued successfully.</p><p>To extend the share and check the result, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila extend docs_resize 2
$ manila show docs_resize
+----------------------+--------------------------------------------------------------------------+
| Property             | Value                                                                    |
+----------------------+--------------------------------------------------------------------------+
| status               | available                                                                |
| share_type_name      | my_type                                                                  |
| description          | None                                                                     |
| availability_zone    | nova                                                                     |
| share_network_id     | None                                                                     |
| export_locations     |                                                                          |
|                      | path = 1.0.0.4:/shares/manila_share_b8afc508_8487_442b_b170_ea65b07074a8 |
|                      | preferred = False                                                        |
|                      | is_admin_only = False                                                    |
|                      | id = 3ffb76f4-92b9-4639-83fd-025bc3e302ff                                |
|                      | share_instance_id = b8afc508-8487-442b-b170-ea65b07074a8                 |
|                      | path = 2.0.0.3:/shares/manila_share_b8afc508_8487_442b_b170_ea65b07074a8 |
|                      | preferred = False                                                        |
|                      | is_admin_only = True                                                     |
|                      | id = 1f0e263f-370d-47d3-95f6-1be64088b9da                                |
|                      | share_instance_id = b8afc508-8487-442b-b170-ea65b07074a8                 |
| share_server_id      | None                                                                     |
| host                 | manila@paris#shares                                                      |
| access_rules_status  | active                                                                   |
| snapshot_id          | None                                                                     |
| is_public            | False                                                                    |
| task_state           | None                                                                     |
| snapshot_support     | True                                                                     |
| id                   | b07dbebe-a328-403c-b402-c8871c89e3d1                                     |
| size                 | 2                                                                        |
| name                 | docs_resize                                                              |
| share_type           | 14ee8575-aac2-44af-8392-d9c9d344f392                                     |
| has_replicas         | False                                                                    |
| replication_type     | None                                                                     |
| created_at           | 2016-03-25T15:33:18.000000                                               |
| share_proto          | NFS                                                                      |
| consistency_group_id | None                                                                     |
| project_id           | 907004508ef4447397ce6741a8f037c1                                         |
| metadata             | {}                                                                       |
+----------------------+--------------------------------------------------------------------------+</pre></div><p>While shrinking, the share has a <code class="literal">shrinking</code> status. This means that the
decrease share size request was issued successfully. To shrink the share and
check the result, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila shrink docs_resize 1
$ manila show docs_resize
+----------------------+--------------------------------------------------------------------------+
| Property             | Value                                                                    |
+----------------------+--------------------------------------------------------------------------+
| status               | available                                                                |
| share_type_name      | my_type                                                                  |
| description          | None                                                                     |
| availability_zone    | nova                                                                     |
| share_network_id     | None                                                                     |
| export_locations     |                                                                          |
|                      | path = 1.0.0.4:/shares/manila_share_b8afc508_8487_442b_b170_ea65b07074a8 |
|                      | preferred = False                                                        |
|                      | is_admin_only = False                                                    |
|                      | id = 3ffb76f4-92b9-4639-83fd-025bc3e302ff                                |
|                      | share_instance_id = b8afc508-8487-442b-b170-ea65b07074a8                 |
|                      | path = 2.0.0.3:/shares/manila_share_b8afc508_8487_442b_b170_ea65b07074a8 |
|                      | preferred = False                                                        |
|                      | is_admin_only = True                                                     |
|                      | id = 1f0e263f-370d-47d3-95f6-1be64088b9da                                |
|                      | share_instance_id = b8afc508-8487-442b-b170-ea65b07074a8                 |
| share_server_id      | None                                                                     |
| host                 | manila@paris#shares                                                      |
| access_rules_status  | active                                                                   |
| snapshot_id          | None                                                                     |
| is_public            | False                                                                    |
| task_state           | None                                                                     |
| snapshot_support     | True                                                                     |
| id                   | b07dbebe-a328-403c-b402-c8871c89e3d1                                     |
| size                 | 1                                                                        |
| name                 | docs_resize                                                              |
| share_type           | 14ee8575-aac2-44af-8392-d9c9d344f392                                     |
| has_replicas         | False                                                                    |
| replication_type     | None                                                                     |
| created_at           | 2016-03-25T15:33:18.000000                                               |
| share_proto          | NFS                                                                      |
| consistency_group_id | None                                                                     |
| project_id           | 907004508ef4447397ce6741a8f037c1                                         |
| metadata             | {}                                                                       |
+----------------------+--------------------------------------------------------------------------+</pre></div></div><div class="sect2 " id="shared-file-systems-quotas"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.3.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Quotas and limits</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-quotas">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-quotas</li></ul></div></div></div></div><div class="sect3 " id="id-1.4.10.7.11.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.5.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Limits</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.11.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Limits are the resource limitations that are allowed for each project.
An administrator can configure limits in the <code class="literal">manila.conf</code> file.</p><p>Users can query their rate and absolute limits.</p><p>To see the absolute limits, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila absolute-limits
+----------------------------+-------+
| Name                       | Value |
+----------------------------+-------+
| maxTotalShareGigabytes     | 1000  |
| maxTotalShareNetworks      | 10    |
| maxTotalShareSnapshots     | 50    |
| maxTotalShares             | 50    |
| maxTotalSnapshotGigabytes  | 1000  |
| totalShareGigabytesUsed    | 1     |
| totalShareNetworksUsed     | 2     |
| totalShareSnapshotsUsed    | 1     |
| totalSharesUsed            | 1     |
| totalSnapshotGigabytesUsed | 1     |
+----------------------------+-------+</pre></div><p>Rate limits control the frequency at which users can issue specific API
requests. Administrators use rate limiting to configure limits on the type and
number of API calls that can be made in a specific time interval. For example,
a rate limit can control the number of <code class="literal">GET</code> requests processed
during a one-minute period.</p><p>To set the API rate limits, modify the
<code class="literal">etc/manila/api-paste.ini</code> file, which is a part of the WSGI pipeline and
defines the actual limits. You need to restart <code class="literal">manila-api</code> service after
you edit the <code class="literal">etc/manila/api-paste.ini</code> file.</p><div class="verbatim-wrap highlight ini"><pre class="screen">[filter:ratelimit]
paste.filter_factory = manila.api.v1.limits:RateLimitingMiddleware.factory
limits = (POST, "*/shares", ^/shares, 120, MINUTE);(PUT, "*/shares", .*, 120, MINUTE);(DELETE, "*", .*, 120, MINUTE)</pre></div><p>Also, add the <code class="literal">ratelimit</code> to <code class="literal">noauth</code>, <code class="literal">keystone</code>, <code class="literal">keystone_nolimit</code>
parameters in the <code class="literal">[composite:openstack_share_api]</code> and
<code class="literal">[composite:openstack_share_api_v2]</code> groups.</p><div class="verbatim-wrap highlight ini"><pre class="screen">[composite:openstack_share_api]
use = call:manila.api.middleware.auth:pipeline_factory
noauth = cors faultwrap ssl ratelimit sizelimit noauth api
keystone = cors faultwrap ssl ratelimit sizelimit authtoken keystonecontext api
keystone_nolimit = cors faultwrap ssl ratelimit sizelimit authtoken keystonecontext api

[composite:openstack_share_api_v2]
use = call:manila.api.middleware.auth:pipeline_factory
noauth = cors faultwrap ssl ratelimit sizelimit noauth apiv2
keystone = cors faultwrap ssl ratelimit sizelimit authtoken keystonecontext apiv2
keystone_nolimit = cors faultwrap ssl ratelimit sizelimit authtoken keystonecontext apiv2</pre></div><p>To see the rate limits, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila rate-limits
+--------+------------+-------+--------+--------+----------------------+
| Verb   | URI        | Value | Remain | Unit   | Next_Available       |
+--------+------------+-------+--------+--------+----------------------+
| DELETE | "*"        | 120   | 120    | MINUTE | 2015-10-20T15:17:20Z |
| POST   | "*/shares" | 120   | 120    | MINUTE | 2015-10-20T15:17:20Z |
| PUT    | "*/shares" | 120   | 120    | MINUTE | 2015-10-20T15:17:20Z |
+--------+------------+-------+--------+--------+----------------------+</pre></div></div><div class="sect3 " id="id-1.4.10.7.11.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.3.5.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Quotas</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.7.11.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Quota sets provide quota management support.</p><p>To list the quotas for a project or user, use the <code class="command">manila quota-show</code>
command. If you specify the optional <code class="literal">--user</code> parameter, you get the
quotas for this user in the specified project. If you omit this parameter,
you get the quotas for the specified project.</p><div id="id-1.4.10.7.11.3.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>The Shared File Systems service does not perform mapping of usernames and
project names to IDs. Provide only ID values to get correct setup
of quotas. Setting it by names you set quota for nonexistent project/user.
In case quota is not set explicitly by project/user ID,
The Shared File Systems service just applies default quotas.</p></div><div class="verbatim-wrap"><pre class="screen">$ manila quota-show --tenant %project_id% --user %user_id%
+--------------------+-------+
| Property           | Value |
+--------------------+-------+
| gigabytes          | 1000  |
| snapshot_gigabytes | 1000  |
| snapshots          | 50    |
| shares             | 50    |
| share_networks     | 10    |
+--------------------+-------+</pre></div><p>There are default quotas for a project that are set from the
<code class="literal">manila.conf</code> file. To list the default quotas for a project, use
the <code class="command">manila quota-defaults</code> command:</p><div class="verbatim-wrap"><pre class="screen">$ manila quota-defaults --tenant %project_id%
+--------------------+-------+
| Property           | Value |
+--------------------+-------+
| gigabytes          | 1000  |
| snapshot_gigabytes | 1000  |
| snapshots          | 50    |
| shares             | 50    |
| share_networks     | 10    |
+--------------------+-------+</pre></div><p>The administrator can update the quotas for a specific project, or for a
specific user by providing both the <code class="literal">--tenant</code> and <code class="literal">--user</code> optional
arguments. It is possible to update the <code class="literal">shares</code>, <code class="literal">snapshots</code>,
<code class="literal">gigabytes</code>, <code class="literal">snapshot-gigabytes</code>, and <code class="literal">share-networks</code> quotas.</p><div class="verbatim-wrap"><pre class="screen">$ manila quota-update %project_id% --user %user_id% --shares 49 --snapshots 49</pre></div><p>As administrator, you can also permit or deny the force-update of a quota that
is already used, or if the requested value exceeds the configured quota limit.
To force-update a quota, use <code class="literal">force</code> optional key.</p><div class="verbatim-wrap"><pre class="screen">$ manila quota-update %project_id% --shares 51 --snapshots 51 --force</pre></div><p>To revert quotas to default for a project or for a user, delete quotas:</p><div class="verbatim-wrap"><pre class="screen">$ manila quota-delete --tenant %project_id% --user %user_id%</pre></div></div></div></div><div class="sect1 " id="id-1.4.10.8"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Migrate shares</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.8">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>As an administrator, you can migrate a share with its data from one
location to another in a manner that is transparent to users and
workloads. You can use <code class="literal">manila</code> client commands to complete a share
migration.</p><p>Possible use cases for data migration include:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Bring down a physical storage device for maintenance without
disrupting workloads.</p></li><li class="listitem "><p>Modify the properties of a share.</p></li><li class="listitem "><p>Free up space in a thinly-provisioned back end.</p></li></ul></div><p>Migrate a share with the <code class="command">manila migrate</code> command, as shown in the
following example:</p><div class="verbatim-wrap"><pre class="screen">$ manila migrate shareID destinationHost --force-host-copy True|False</pre></div><p>In this example, <code class="literal">--force-host-copy True</code> forces the generic
host-based migration mechanism and bypasses any driver optimizations.
<code class="literal">destinationHost</code> is in this format <code class="literal">host#pool</code> which includes
destination host and pool.</p><div id="id-1.4.10.8.8" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>If the user is not an administrator, the migration fails.</p></div></div><div class="sect1 " id="shared-file-systems-share-types"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share types</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-share-types">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-share-types</li></ul></div></div></div></div><p>A share type enables you to filter or choose back ends before you create a
share and to set data for the share driver. A share type behaves in the same
way as a Block Storage volume type behaves.</p><p>In the Shared File Systems configuration file <code class="literal">manila.conf</code>, the
administrator can set the share type used by default for the share creation
and then create a default share type.</p><p>To create a share type, use <code class="command">manila type-create</code> command as:</p><div class="verbatim-wrap"><pre class="screen">manila type-create [--snapshot_support &lt;snapshot_support&gt;]
                   [--is_public &lt;is_public&gt;]
                   &lt;name&gt; &lt;spec_driver_handles_share_servers&gt;</pre></div><p>where the <code class="literal">name</code> is the share type name, <code class="literal">--is_public</code> defines the level of
the visibility for the share type, <code class="literal">snapshot_support</code> and
<code class="literal">spec_driver_handles_share_servers</code> are the extra specifications used to
filter back ends. Administrators can create share types with these extra
specifications for the back ends filtering:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><code class="literal">driver_handles_share_servers</code>. Required. Defines the driver mode for share
server lifecycle management. Valid values are <code class="literal">true</code>/<code class="literal">1</code> and
<code class="literal">false</code>/<code class="literal">0</code>.
Set to True when the share driver can manage, or handle, the share server
lifecycle.
Set to False when an administrator, rather than a share driver, manages
the bare metal storage with some net interface instead of the presence
of the share servers.</p></li><li class="listitem "><p><code class="literal">snapshot_support</code>. Filters back ends by whether they do or do not support
share snapshots. Default is <code class="literal">True</code>.
Set to True to find back ends that support share snapshots.
Set to False to find back ends that do not support share snapshots.</p></li></ul></div><div id="id-1.4.10.9.8" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>The extra specifications set in the share types are operated in the
<a class="xref" href="bk02ch08.html#shared-file-systems-scheduling" title="8.10.1. Scheduling">Section 8.10.1, “Scheduling”</a>.</p></div><p>Administrators can also set additional extra specifications for a share type
for the following purposes:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="emphasis"><em>Filter back ends</em></span>. Unqualified extra specifications written in
this format: <code class="literal">extra_spec=value</code>. For example, <span class="bold"><strong>netapp_raid_type=raid4</strong></span>.</p></li><li class="listitem "><p><span class="emphasis"><em>Set data for the driver</em></span>. Qualified extra specifications always written
with the prefix with a colon, except for the special <code class="literal">capabilities</code>
prefix, in this format: <code class="literal">vendor:extra_spec=value</code>. For example,
<span class="bold"><strong>netapp:thin_provisioned=true</strong></span>.</p></li></ul></div><p>The scheduler uses the special capabilities prefix for filtering. The scheduler
can only create a share on a back end that reports capabilities matching the
un-scoped extra-spec keys for the share type. For details, see <a class="link" href="http://docs.openstack.org/developer/manila/devref/capabilities_and_extra_specs.html" target="_blank">Capabilities
and Extra-Specs</a>.</p><p>Each driver implementation determines which extra specification keys it uses.
For details, see the documentation for the driver.</p><p>An administrator can use the <code class="literal">policy.json</code> file to grant permissions for
share type creation with extra specifications to other roles.</p><p>You set a share type to private or public and
<a class="xref" href="bk02ch08.html#share-type-access" title="8.5.2. Share type access">Section 8.5.2, “Share type access”</a> to the private share types. By
default a share type is created as publicly accessible. Set
<code class="literal">--is_public</code> to <code class="literal">False</code> to make the share type private.</p><div class="sect2 " id="id-1.4.10.9.15"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.5.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share type operations</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.9.15">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To create a new share type you need to specify the name of the new share
type. You also require an extra spec <code class="literal">driver_handles_share_servers</code>.
The new share type can also be public.</p><div class="verbatim-wrap"><pre class="screen">$ manila type-create netapp1 False --is_public True

$ manila type-list
+-----+--------+-----------+-----------+-----------------------------------+-----------------------+
| ID  | Name   | Visibility| is_default| required_extra_specs              | optional_extra_specs  |
+-----+--------+-----------+-----------+-----------------------------------+-----------------------+
| c0..| netapp1| public    | -         | driver_handles_share_servers:False| snapshot_support:True |
+-----+--------+-----------+-----------+-----------------------------------+-----------------------+</pre></div><p>You can set or unset extra specifications for a share type
using <span class="bold"><strong>manila type-key &lt;share_type&gt; set &lt;key=value&gt;</strong></span> command. Since it is up
to each driver what extra specification keys it uses, see the documentation
for the specified driver.</p><div class="verbatim-wrap"><pre class="screen">$ manila type-key netapp1 set thin_provisioned=True</pre></div><p>It is also possible to view a list of current share types and extra
specifications:</p><div class="verbatim-wrap"><pre class="screen">$ manila extra-specs-list
+-------------+---------+-------------------------------------+
| ID          | Name    | all_extra_specs                     |
+-------------+---------+-------------------------------------+
| c0086582-...| netapp1 | snapshot_support : True             |
|             |         | thin_provisioned : True             |
|             |         | driver_handles_share_servers : True |
+-------------+---------+-------------------------------------+</pre></div><p>Use <code class="command">manila type-key &lt;share_type&gt; unset &lt;key&gt;</code> to unset an extra
specification.</p><p>The public or private share type can be deleted with the
<code class="command">manila type-delete &lt;share_type&gt;</code> command.</p></div><div class="sect2 " id="share-type-access"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.5.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share type access</span> <a title="Permalink" class="permalink" href="bk02ch08.html#share-type-access">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>share-type-access</li></ul></div></div></div></div><p>You can manage access to a private share type for different projects.
Administrators can provide access, remove access, and retrieve
information about access for a specified private share.</p><p>Create a private type:</p><div class="verbatim-wrap"><pre class="screen">$ manila type-create my_type1 True --is_public False
+----------------------+--------------------------------------+
| Property             | Value                                |
+----------------------+--------------------------------------+
| required_extra_specs | driver_handles_share_servers : True  |
| Name                 | my_type1                             |
| Visibility           | private                              |
| is_default           | -                                    |
| ID                   | 06793be5-9a79-4516-89fe-61188cad4d6c |
| optional_extra_specs | snapshot_support : True              |
+----------------------+--------------------------------------+</pre></div><div id="id-1.4.10.9.16.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>If you run <code class="command">manila type-list</code> only public share types appear.
To see private share types, run <code class="command">manila type-list</code> with
<code class="literal">--all</code> optional argument.</p></div><p>Grant access to created private type for a demo and alt_demo projects
by providing their IDs:</p><div class="verbatim-wrap"><pre class="screen">$ manila type-access-add my_type1 d8f9af6915404114ae4f30668a4f5ba7
$ manila type-access-add my_type1 e4970f57f1824faab2701db61ee7efdf</pre></div><p>To view information about access for a private share, type <code class="literal">my_type1</code>:</p><div class="verbatim-wrap"><pre class="screen">$ manila type-access-list my_type1
+----------------------------------+
| Project_ID                       |
+----------------------------------+
| d8f9af6915404114ae4f30668a4f5ba7 |
| e4970f57f1824faab2701db61ee7efdf |
+----------------------------------+</pre></div><p>After granting access to the share, the target project
can see the share type in the list, and create private
shares.</p><p>To deny access for a specified project, use
<code class="command">manila type-access-remove &lt;share_type&gt; &lt;project_id&gt;</code> command.</p></div></div><div class="sect1 " id="shared-file-systems-snapshots"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share snapshots</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-snapshots">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-snapshots</li></ul></div></div></div></div><p>The Shared File Systems service provides a snapshot mechanism to help users
restore data by running the <code class="command">manila snapshot-create</code> command.</p><p>To export a snapshot, create a share from it, then mount the new share
to an instance. Copy files from the attached share into the archive.</p><p>To import a snapshot, create a new share with appropriate size, attach it to
instance, and then copy a file from the archive to the attached file
system.</p><div id="id-1.4.10.10.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>You cannot delete a share while it has saved dependent snapshots.</p></div><p>Create a snapshot from the share:</p><div class="verbatim-wrap"><pre class="screen">$ manila snapshot-create Share1 --name Snapshot1 --description "Snapshot of Share1"
+-------------+--------------------------------------+
| Property    | Value                                |
+-------------+--------------------------------------+
| status      | creating                             |
| share_id    | aca648eb-8c03-4394-a5cc-755066b7eb66 |
| name        | Snapshot1                            |
| created_at  | 2015-09-25T05:27:38.862040           |
| share_proto | NFS                                  |
| id          | 962e8126-35c3-47bb-8c00-f0ee37f42ddd |
| size        | 1                                    |
| share_size  | 1                                    |
| description | Snapshot of Share1                   |
+-------------+--------------------------------------+</pre></div><p>Update snapshot name or description if needed:</p><div class="verbatim-wrap"><pre class="screen">$ manila snapshot-rename Snapshot1 Snapshot_1 --description "Snapshot of Share1. Updated."</pre></div><p>Check that status of a snapshot is <code class="literal">available</code>:</p><div class="verbatim-wrap"><pre class="screen">$ manila snapshot-show Snapshot1
+-------------+--------------------------------------+
| Property    | Value                                |
+-------------+--------------------------------------+
| status      | available                            |
| share_id    | aca648eb-8c03-4394-a5cc-755066b7eb66 |
| name        | Snapshot1                            |
| created_at  | 2015-09-25T05:27:38.000000           |
| share_proto | NFS                                  |
| id          | 962e8126-35c3-47bb-8c00-f0ee37f42ddd |
| size        | 1                                    |
| share_size  | 1                                    |
| description | Snapshot of Share1                   |
+-------------+--------------------------------------+</pre></div><p>To restore your data from a snapshot, use <code class="command">manila create</code> with
key <code class="literal">--snapshot-id</code>. This creates a new share from an
existing snapshot. Create a share from a snapshot and check whether
it is available:</p><div class="verbatim-wrap"><pre class="screen">$ manila create nfs 1 --name Share2 --metadata source=snapshot --description "Share from a snapshot." --snapshot-id 962e8126-35c3-47bb-8c00-f0ee37f42ddd
+-----------------------------+--------------------------------------+
| Property                    | Value                                |
+-----------------------------+--------------------------------------+
| status                      | None                                 |
| share_type_name             | default                              |
| description                 | Share from a snapshot.               |
| availability_zone           | None                                 |
| share_network_id            | None                                 |
| export_locations            | []                                   |
| share_server_id             | None                                 |
| host                        | None                                 |
| snapshot_id                 | 962e8126-35c3-47bb-8c00-f0ee37f42ddd |
| is_public                   | False                                |
| task_state                  | None                                 |
| snapshot_support            | True                                 |
| id                          | b6b0617c-ea51-4450-848e-e7cff69238c7 |
| size                        | 1                                    |
| name                        | Share2                               |
| share_type                  | c0086582-30a6-4060-b096-a42ec9d66b86 |
| created_at                  | 2015-09-25T06:25:50.240417           |
| export_location             | None                                 |
| share_proto                 | NFS                                  |
| consistency_group_id        | None                                 |
| source_cgsnapshot_member_id | None                                 |
| project_id                  | 20787a7ba11946adad976463b57d8a2f     |
| metadata                    | {u'source': u'snapshot'}             |
+-----------------------------+--------------------------------------+

$ manila show Share2
+-----------------------------+-------------------------------------------+
| Property                    | Value                                     |
+-----------------------------+-------------------------------------------+
| status                      | available                                 |
| share_type_name             | default                                   |
| description                 | Share from a snapshot.                    |
| availability_zone           | nova                                      |
| share_network_id            | 5c3cbabb-f4da-465f-bc7f-fadbe047b85a      |
| export_locations            | 10.254.0.3:/shares/share-1dc2a471-3d47-...|
| share_server_id             | 41b7829d-7f6b-4c96-aea5-d106c2959961      |
| host                        | manila@generic1#GENERIC1                  |
| snapshot_id                 | 962e8126-35c3-47bb-8c00-f0ee37f42ddd      |
| is_public                   | False                                     |
| task_state                  | None                                      |
| snapshot_support            | True                                      |
| id                          | b6b0617c-ea51-4450-848e-e7cff69238c7      |
| size                        | 1                                         |
| name                        | Share2                                    |
| share_type                  | c0086582-30a6-4060-b096-a42ec9d66b86      |
| created_at                  | 2015-09-25T06:25:50.000000                |
| share_proto                 | NFS                                       |
| consistency_group_id        | None                                      |
| source_cgsnapshot_member_id | None                                      |
| project_id                  | 20787a7ba11946adad976463b57d8a2f          |
| metadata                    | {u'source': u'snapshot'}                  |
+-----------------------------+-------------------------------------------+</pre></div><p>You can soft-delete a snapshot using <code class="command">manila snapshot-delete
&lt;snapshot_name_or_ID&gt;</code>. If a snapshot is in busy state, and during
the delete an <code class="literal">error_deleting</code> status appeared, administrator can
force-delete it or explicitly reset the state.</p><p>Use <code class="command">snapshot-reset-state [--state &lt;state&gt;] &lt;snapshot&gt;</code> to update
the state of a snapshot explicitly. A valid value of a status are
<code class="literal">available</code>, <code class="literal">error</code>, <code class="literal">creating</code>, <code class="literal">deleting</code>, <code class="literal">error_deleting</code>.
If no state is provided, the <code class="literal">available</code> state will be used.</p><p>Use <code class="command">manila snapshot-force-delete &lt;snapshot&gt;</code> to force-delete
a specified share snapshot in any state.</p></div><div class="sect1 " id="shared-file-systems-security-services"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Security services</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-security-services">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-security-services</li></ul></div></div></div></div><p>A security service stores client configuration information used for
authentication and authorization (AuthN/AuthZ). For example, a share server
will be the client for an existing service such as LDAP, Kerberos, or
Microsoft Active Directory.</p><p>You can associate a share with one to three security service types:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><code class="literal">ldap</code>: LDAP.</p></li><li class="listitem "><p><code class="literal">kerberos</code>: Kerberos.</p></li><li class="listitem "><p><code class="literal">active_directory</code>: Microsoft Active Directory.</p></li></ul></div><p>You can configure a security service with these options:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>A DNS IP address.</p></li><li class="listitem "><p>An IP address or host name.</p></li><li class="listitem "><p>A domain.</p></li><li class="listitem "><p>A user or group name.</p></li><li class="listitem "><p>The password for the user, if you specify a user name.</p></li></ul></div><p>You can add the security service to the
<a class="xref" href="bk02ch08.html#shared-file-systems-share-networks" title="8.11.1. Share networks">Section 8.11.1, “Share networks”</a>.</p><p>To create a security service, specify the security service type, a
description of a security service, DNS IP address used inside project's
network, security service IP address or host name, domain, security
service user or group used by project, and a password for the user. The
share name is optional.</p><p>Create a <code class="literal">ldap</code> security service:</p><div class="verbatim-wrap"><pre class="screen">$ manila security-service-create ldap --dns-ip 8.8.8.8 --server 10.254.0.3 --name my_ldap_security_service
+-------------+--------------------------------------+
| Property    | Value                                |
+-------------+--------------------------------------+
| status      | new                                  |
| domain      | None                                 |
| password    | None                                 |
| name        | my_ldap_security_service             |
| dns_ip      | 8.8.8.8                              |
| created_at  | 2015-09-25T10:19:06.019527           |
| updated_at  | None                                 |
| server      | 10.254.0.3                           |
| user        | None                                 |
| project_id  | 20787a7ba11946adad976463b57d8a2f     |
| type        | ldap                                 |
| id          | 413479b2-0d20-4c58-a9d3-b129fa592d8e |
| description | None                                 |
+-------------+--------------------------------------+</pre></div><p>To create <code class="literal">kerberos</code> security service, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila security-service-create kerberos --server 10.254.0.3 --user demo --password secret --name my_kerberos_security_service --description "Kerberos security service"
+-------------+--------------------------------------+
| Property    | Value                                |
+-------------+--------------------------------------+
| status      | new                                  |
| domain      | None                                 |
| password    | secret                               |
| name        | my_kerberos_security_service         |
| dns_ip      | None                                 |
| created_at  | 2015-09-25T10:26:03.211849           |
| updated_at  | None                                 |
| server      | 10.254.0.3                           |
| user        | demo                                 |
| project_id  | 20787a7ba11946adad976463b57d8a2f     |
| type        | kerberos                             |
| id          | 7f46a447-2534-453d-924d-bd7c8e63bbec |
| description | Kerberos security service            |
+-------------+--------------------------------------+</pre></div><p>To see the list of created security service use
<code class="command">manila security-service-list</code>:</p><div class="verbatim-wrap"><pre class="screen">$ manila security-service-list
+--------------------------------------+------------------------------+--------+----------+
| id                                   | name                         | status | type     |
+--------------------------------------+------------------------------+--------+----------+
| 413479b2-0d20-4c58-a9d3-b129fa592d8e | my_ldap_security_service     | new    | ldap     |
| 7f46a447-2534-453d-924d-bd7c8e63bbec | my_kerberos_security_service | new    | kerberos |
+--------------------------------------+------------------------------+--------+----------+</pre></div><p>You can add a security service to the existing
<a class="xref" href="bk02ch08.html#shared-file-systems-share-networks" title="8.11.1. Share networks">Section 8.11.1, “Share networks”</a>, which is not
yet used (a <code class="literal">share network</code> not associated with a share).</p><p>Add a security service to the share network with
<code class="literal">share-network-security-service-add</code> specifying share network and
security service. The command returns information about the
security service. You can see view new attributes and <code class="literal">share_networks</code>
using the associated share network ID.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-network-security-service-add share_net2 my_ldap_security_service

$ manila security-service-show my_ldap_security_service
+----------------+-------------------------------------------+
| Property       | Value                                     |
+----------------+-------------------------------------------+
| status         | new                                       |
| domain         | None                                      |
| password       | None                                      |
| name           | my_ldap_security_service                  |
| dns_ip         | 8.8.8.8                                   |
| created_at     | 2015-09-25T10:19:06.000000                |
| updated_at     | None                                      |
| server         | 10.254.0.3                                |
| share_networks | [u'6d36c41f-d310-4aff-a0c2-ffd870e91cab'] |
| user           | None                                      |
| project_id     | 20787a7ba11946adad976463b57d8a2f          |
| type           | ldap                                      |
| id             | 413479b2-0d20-4c58-a9d3-b129fa592d8e      |
| description    | None                                      |
+----------------+-------------------------------------------+</pre></div><p>It is possible to see the list of security services associated
with a given share network. List security services for <code class="literal">share_net2</code>
share network with:</p><div class="verbatim-wrap"><pre class="screen">$ manila share-network-security-service-list share_net2
+--------------------------------------+--------------------------+--------+------+
| id                                   | name                     | status | type |
+--------------------------------------+--------------------------+--------+------+
| 413479b2-0d20-4c58-a9d3-b129fa592d8e | my_ldap_security_service | new    | ldap |
+--------------------------------------+--------------------------+--------+------+</pre></div><p>You also can dissociate a security service from the share network
and confirm that the security service now has an empty list of
share networks:</p><div class="verbatim-wrap"><pre class="screen">$ manila share-network-security-service-remove share_net2 my_ldap_security_service

$ manila security-service-show my_ldap_security_service
+----------------+--------------------------------------+
| Property       | Value                                |
+----------------+--------------------------------------+
| status         | new                                  |
| domain         | None                                 |
| password       | None                                 |
| name           | my_ldap_security_service             |
| dns_ip         | 8.8.8.8                              |
| created_at     | 2015-09-25T10:19:06.000000           |
| updated_at     | None                                 |
| server         | 10.254.0.3                           |
| share_networks | []                                   |
| user           | None                                 |
| project_id     | 20787a7ba11946adad976463b57d8a2f     |
| type           | ldap                                 |
| id             | 413479b2-0d20-4c58-a9d3-b129fa592d8e |
| description    | None                                 |
+----------------+--------------------------------------+</pre></div><p>The Shared File Systems service allows you to update a security service field
using <code class="command">manila security-service-update</code> command with optional
arguments such as <code class="literal">--dns-ip</code>, <code class="literal">--server</code>, <code class="literal">--domain</code>,
<code class="literal">--user</code>, <code class="literal">--password</code>, <code class="literal">--name</code>, or
<code class="literal">--description</code>.</p><p>To remove a security service not associated with any share networks
run:</p><div class="verbatim-wrap"><pre class="screen">$ manila security-service-delete my_ldap_security_service</pre></div></div><div class="sect1 " id="shared-file-systems-cgroups"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Consistency groups</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-cgroups">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-cgroups</li></ul></div></div></div></div><p>Consistency groups enable you to create snapshots from multiple file system
shares at the same point in time. For example, a database might place its
tables, logs, and configurations on separate shares. Store logs, tables,
and configurations at the same point in time to effectively restore a
database.</p><p>The Shared File System service allows you to create a snapshot of the
consistency group and restore all shares that were associated with a
consistency group.</p><div id="id-1.4.10.12.4" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important</h6><p>The <span class="bold"><strong>consistency groups and snapshots</strong></span> are an <span class="bold"><strong>experimental</strong></span>
Shared File Systems API in the Liberty release.
Contributors can change or remove the experimental part of the
Shared File Systems API in further releases without maintaining
backward compatibility. Experimental APIs have an
<code class="literal">X-OpenStack-Manila-API-Experimental: true</code> header in
their HTTP requests.</p></div><div class="sect2 " id="id-1.4.10.12.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.8.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Consistency groups</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.12.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div id="id-1.4.10.12.5.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>Before using consistency groups, make sure the Shared File System driver
that you are running has consistency group support. You can check it in the
<code class="literal">manila-scheduler</code> service reports. The <code class="literal">consistency_group_support</code> can
have the following values:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><code class="literal">pool</code> or <code class="literal">host</code>. Consistency groups are supported. Specifies the
level of consistency groups support.</p></li><li class="listitem "><p><code class="literal">false</code>. Consistency groups are not supported.</p></li></ul></div></div><p>The <code class="command">manila cg-create</code> command creates a new consistency group.
With this command, you can specify a share network, and one or more share
types. In the example a consistency group <code class="literal">cgroup1</code> was created by
specifying two comma-separated share types:</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-create --name cgroup1 --description "My first CG." --share-types my_type1,default --share-network my_share_net
+----------------------+--------------------------------------+
| Property             | Value                                |
+----------------------+--------------------------------------+
| status               | creating                             |
| description          | My first CG.                         |
| source_cgsnapshot_id | None                                 |
| created_at           | 2015-09-29T15:01:12.102472           |
| share_network_id     | 5c3cbabb-f4da-465f-bc7f-fadbe047b85a |
| share_server_id      | None                                 |
| host                 | None                                 |
| project_id           | 20787a7ba11946adad976463b57d8a2f     |
| share_types          | a4218aa5-f16a-42b3-945d-113496d40558 |
|                      | c0086582-30a6-4060-b096-a42ec9d66b86 |
| id                   | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |
| name                 | cgroup1                              |
+----------------------+--------------------------------------+</pre></div><p>Check that consistency group status is <code class="literal">available</code>:</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-show cgroup1
+----------------------+--------------------------------------+
| Property             | Value                                |
+----------------------+--------------------------------------+
| status               | available                            |
| description          | My first CG.                         |
| source_cgsnapshot_id | None                                 |
| created_at           | 2015-09-29T15:05:40.000000           |
| share_network_id     | 5c3cbabb-f4da-465f-bc7f-fadbe047b85a |
| share_server_id      | None                                 |
| host                 | manila@generic1#GENERIC1             |
| project_id           | 20787a7ba11946adad976463b57d8a2f     |
| share_types          | c0086582-30a6-4060-b096-a42ec9d66b86 |
|                      | a4218aa5-f16a-42b3-945d-113496d40558 |
| id                   | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |
| name                 | cgroup1                              |
+----------------------+--------------------------------------+</pre></div><p>To add a share to the consistency group, create a share by adding the
<code class="literal">--consistency-group</code> option where you specify the ID of the consistency
group in <code class="literal">available</code> status:</p><div class="verbatim-wrap"><pre class="screen">$ manila create nfs 1 --name "Share2" --description "My second share" \
--share-type default --share-network my_share_net --consistency-group cgroup1
+-----------------------------+--------------------------------------+
| Property                    | Value                                |
+-----------------------------+--------------------------------------+
| status                      | None                                 |
| share_type_name             | default                              |
| description                 | My second share                      |
| availability_zone           | None                                 |
| share_network_id            | None                                 |
| export_locations            | []                                   |
| share_server_id             | None                                 |
| host                        | None                                 |
| snapshot_id                 | None                                 |
| is_public                   | False                                |
| task_state                  | None                                 |
| snapshot_support            | True                                 |
| id                          | 7bcd888b-681b-4836-ac9c-c3add4e62537 |
| size                        | 1                                    |
| name                        | Share2                               |
| share_type                  | c0086582-30a6-4060-b096-a42ec9d66b86 |
| created_at                  | 2015-09-29T15:09:24.156387           |
| export_location             | None                                 |
| share_proto                 | NFS                                  |
| consistency_group_id        | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |
| source_cgsnapshot_member_id | None                                 |
| project_id                  | 20787a7ba11946adad976463b57d8a2f     |
| metadata                    | {}                                   |
+-----------------------------+--------------------------------------+</pre></div><p>Administrators can rename the consistency group, or change its
description using the <code class="command">manila cg-update</code> command. Delete the group
with the <code class="command">manila cg-delete</code> command.</p><p>As an administrator, you can also reset the state of a consistency group and
force delete a specified consistency group in any state. Use the
<code class="literal">policy.json</code> file to grant permissions for these actions to other roles.</p><p>Use <code class="command">manila cg-reset-state [--state &lt;state&gt;] &lt;consistency_group&gt;</code>
to update the state of a consistency group explicitly. A valid value of a
status are <code class="literal">available</code>, <code class="literal">error</code>, <code class="literal">creating</code>, <code class="literal">deleting</code>,
<code class="literal">error_deleting</code>. If no state is provided, <code class="literal">available</code> will be used.</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-reset-state cgroup1 --state error</pre></div><p>Use <code class="command">manila cg-delete &lt;consistency_group&gt; [&lt;consistency_group&gt; ...]</code>
to soft-delete one or more consistency groups.</p><div id="id-1.4.10.12.5.14" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>A consistency group can be deleted only if it has no dependent
<a class="xref" href="bk02ch08.html#shared-file-systems-cgsnapshots" title="8.8.2. Consistency group snapshots">Section 8.8.2, “Consistency group snapshots”</a>.</p></div><div class="verbatim-wrap"><pre class="screen">$ manila cg-delete cgroup1</pre></div><p>Use <code class="command">manila cg-delete --force &lt;consistency_group&gt;
[&lt;consistency_group&gt; ...]</code>
to force-delete a specified consistency group in any state.</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-delete --force cgroup1</pre></div></div><div class="sect2 " id="shared-file-systems-cgsnapshots"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.8.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Consistency group snapshots</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-cgsnapshots">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-cgsnapshots</li></ul></div></div></div></div><p>To create a snapshot, specify the ID or name of the consistency group.
After creating a consistency group snapshot, it is possible to generate
a new consistency group.</p><p>Create a snapshot of consistency group <code class="literal">cgroup1</code>:</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-snapshot-create cgroup1 --name CG_snapshot1 --description "A snapshot of the first CG."
+----------------------+--------------------------------------+
| Property             | Value                                |
+----------------------+--------------------------------------+
| status               | creating                             |
| name                 | CG_snapshot1                         |
| created_at           | 2015-09-29T15:26:16.839704           |
| consistency_group_id | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |
| project_id           | 20787a7ba11946adad976463b57d8a2f     |
| id                   | 876ad24c-1efd-4607-a2b1-6a2c90034fa5 |
| description          | A snapshot of the first CG.          |
+----------------------+--------------------------------------+</pre></div><p>Check the status of created consistency group snapshot:</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-snapshot-show CG_snapshot1
+----------------------+--------------------------------------+
| Property             | Value                                |
+----------------------+--------------------------------------+
| status               | available                            |
| name                 | CG_snapshot1                         |
| created_at           | 2015-09-29T15:26:22.000000           |
| consistency_group_id | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |
| project_id           | 20787a7ba11946adad976463b57d8a2f     |
| id                   | 876ad24c-1efd-4607-a2b1-6a2c90034fa5 |
| description          | A snapshot of the first CG.          |
+----------------------+--------------------------------------+</pre></div><p>Administrators can rename a consistency group snapshot, change its
description using the <code class="command">cg-snapshot-update</code> command, or delete
it with the <code class="command">cg-snapshot-delete</code> command.</p><p>A consistency group snapshot can have <code class="literal">members</code>. To add a member,
include the <code class="literal">--consistency-group</code> optional parameter in the
create share command. This ID must match the ID of the consistency group from
which the consistency group snapshot was created. Then, while restoring data,
and operating with consistency group snapshots, you can quickly
find which shares belong to a specified consistency group.</p><p>You created the share <code class="literal">Share2</code> in <code class="literal">cgroup1</code> consistency group. Since
you made a snapshot of it, you can see that the only member of the consistency
group snapshot is <code class="literal">Share2</code> share:</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-snapshot-members CG_snapshot1
+--------------+------+----------------------------+----------------+--------------+--------------+
| Id           | Size | Created_at                 | Share_protocol | Share_id     | Share_type_id|
+--------------+------+----------------------------+----------------+--------------+--------------+
| 5c62af2b-... | 1    | 2015-09-29T15:26:22.000000 | NFS            | 7bcd888b-... | c0086582-... |
+--------------+------+----------------------------+----------------+--------------+--------------+</pre></div><p>After you create a consistency group snapshot, you can create a consistency
group from the new snapshot:</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-create --source-cgsnapshot-id 876ad24c-1efd-4607-a2b1-6a2c90034fa5 --name cgroup2 --description "A consistency group from a CG snapshot."
+----------------------+-----------------------------------------+
| Property             | Value                                   |
+----------------------+-----------------------------------------+
| status               | creating                                |
| description          | A consistency group from a CG snapshot. |
| source_cgsnapshot_id | 876ad24c-1efd-4607-a2b1-6a2c90034fa5    |
| created_at           | 2015-09-29T15:47:47.937991              |
| share_network_id     | None                                    |
| share_server_id      | None                                    |
| host                 | manila@generic1#GENERIC1                |
| project_id           | 20787a7ba11946adad976463b57d8a2f        |
| share_types          | c0086582-30a6-4060-b096-a42ec9d66b86    |
|                      | a4218aa5-f16a-42b3-945d-113496d40558    |
| id                   | ffee08d9-c86c-45e5-861e-175c731daca2    |
| name                 | cgroup2                                 |
+----------------------+-----------------------------------------+</pre></div><p>Check the consistency group list. Two groups now appear:</p><div class="verbatim-wrap"><pre class="screen">$ manila cg-list
+-------------------+---------+-----------------------------------------+-----------+
| id                | name    | description                             | status    |
+-------------------+---------+-----------------------------------------+-----------+
| 6fdd91bc-7a48-... | cgroup1 | My first CG.                            | available |
| ffee08d9-c86c-... | cgroup2 | A consistency group from a CG snapshot. | available |
+-------------------+---------+-----------------------------------------+-----------+</pre></div><p>Check a list of the shares. New share with
<code class="literal">ba52454e-2ea3-47fa-a683-3176a01295e6</code> ID appeared after the
consistency group <code class="literal">cgroup2</code> was built from a snapshot with a member.</p><div class="verbatim-wrap"><pre class="screen">$ manila list
+------+-------+-----+------------+----------+----------+-----------+--------------------------+
| ID   | Name  | Size| Share Proto| Status   | Is Public| Share Type| Host                     |
+------+-------+-----+------------+----------+----------+-----------+--------------------------+
| 7bc..| Share2| 1   | NFS        | available| False    | c008658...| manila@generic1#GENERIC1 |
| ba5..| None  | 1   | NFS        | available| False    | c008658...| manila@generic1#GENERIC1 |
+------+-------+-----+------------+----------+----------+-----------+--------------------------+</pre></div><p>Print detailed information about new share:</p><div id="id-1.4.10.12.6.18" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>Pay attention on the <code class="literal">source_cgsnapshot_member_id</code> and
<code class="literal">consistency_group_id</code> fields in a new share. It has
<code class="literal">source_cgsnapshot_member_id</code> that is equal to the ID of the consistency
group snapshot and <code class="literal">consistency_group_id</code> that is equal to the ID of
<code class="literal">cgroup2</code> created from a snapshot.</p></div><div class="verbatim-wrap"><pre class="screen">$ manila show ba52454e-2ea3-47fa-a683-3176a01295e6
+-----------------------------+---------------------------------------------------------------+
| Property                    | Value                                                         |
+-----------------------------+---------------------------------------------------------------+
| status                      | available                                                     |
| share_type_name             | default                                                       |
| description                 | None                                                          |
| availability_zone           | None                                                          |
| share_network_id            | None                                                          |
| export_locations            | 10.254.0.5:/shares/share-5acadf4d-f81a-4515-b5ce-3ab641ab4d1e |
| share_server_id             | None                                                          |
| host                        | manila@generic1#GENERIC1                                      |
| snapshot_id                 | None                                                          |
| is_public                   | False                                                         |
| task_state                  | None                                                          |
| snapshot_support            | True                                                          |
| id                          | ba52454e-2ea3-47fa-a683-3176a01295e6                          |
| size                        | 1                                                             |
| name                        | None                                                          |
| share_type                  | c0086582-30a6-4060-b096-a42ec9d66b86                          |
| created_at                  | 2015-09-29T15:47:48.000000                                    |
| share_proto                 | NFS                                                           |
| consistency_group_id        | ffee08d9-c86c-45e5-861e-175c731daca2                          |
| source_cgsnapshot_member_id | 5c62af2b-0870-4d00-b3fa-174831eb15ca                          |
| project_id                  | 20787a7ba11946adad976463b57d8a2f                              |
| metadata                    | {}                                                            |
+-----------------------------+---------------------------------------------------------------+</pre></div><p>As an administrator, you can also reset the state of a consistency group
snapshot with the <code class="command">cg-snapshot-reset-state</code> command, and force delete a specified
consistency group snapshot in any state using the <code class="command">cg-snapshot-delete</code> command
with the <code class="literal">--force</code> key. Use the <code class="literal">policy.json</code> file to grant permissions for
these actions to other roles.</p></div></div><div class="sect1 " id="id-1.4.10.13"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.9 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share replication</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Replication of data has a number of use cases in the cloud. One use case is
High Availability of the data in a shared file system, used for example, to
support a production database. Another use case is ensuring Data Protection;
i.e being prepared for a disaster by having a replication location that will be
ready to back up your primary data source.</p><p>The Shared File System service supports user facing APIs that allow users to
create shares that support replication, add and remove share replicas and
manage their snapshots and access rules. Three replication types are currently
supported and they vary in the semantics associated with the primary share and
the secondary copies.</p><div id="id-1.4.10.13.4" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.png" /><h6>Important</h6><p><span class="bold"><strong>Share replication</strong></span> is an <span class="bold"><strong>experimental</strong></span> Shared File Systems API in
the Mitaka release. Contributors can change or remove the experimental
part of the Shared File Systems API in further releases without maintaining
backward compatibility. Experimental APIs have an
<code class="literal">X-OpenStack-Manila-API-Experimental: true</code> header in their HTTP requests.</p></div><div class="sect2 " id="id-1.4.10.13.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.9.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Replication types supported</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Before using share replication, make sure the Shared File System driver that
you are running supports this feature. You can check it in the
<code class="literal">manila-scheduler</code> service reports. The <code class="literal">replication_type</code> capability
reported can have one of the following values:</p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.10.13.5.3.1"><span class="term ">writable</span></dt><dd><p>The driver supports creating <code class="literal">writable</code> share replicas. All share replicas
can be accorded read/write access and would be synchronously mirrored.</p></dd><dt id="id-1.4.10.13.5.3.2"><span class="term ">readable</span></dt><dd><p>The driver supports creating <code class="literal">read-only</code> share replicas. All secondary
share replicas can be accorded read access. Only the primary (or <code class="literal">active</code>
share replica) can be written into.</p></dd><dt id="id-1.4.10.13.5.3.3"><span class="term ">dr</span></dt><dd><p>The driver supports creating <code class="literal">dr</code> (abbreviated from Disaster Recovery)
share replicas. A secondary share replica is inaccessible until after a
<code class="literal">promotion</code>.</p></dd><dt id="id-1.4.10.13.5.3.4"><span class="term ">None</span></dt><dd><p>The driver does not support Share Replication.</p></dd></dl></div><div id="id-1.4.10.13.5.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>The term <code class="literal">active</code> share replica refers to the <code class="literal">primary</code> share. In
<code class="literal">writable</code> style of replication, all share replicas are <code class="literal">active</code>, and
there could be no distinction of a <code class="literal">primary</code> share. In <code class="literal">readable</code> and
<code class="literal">dr</code> styles of replication, a <code class="literal">secondary</code> share replica may be referred
to as <code class="literal">passive</code>, <code class="literal">non-active</code> or simply, <code class="literal">replica</code>.</p></div></div><div class="sect2 " id="id-1.4.10.13.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.9.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configuration</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.6">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Two new configuration options have been introduced to support Share
Replication.</p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.10.13.6.3.1"><span class="term ">replica_state_update_interval</span></dt><dd><p>Specify this option in the <code class="literal">DEFAULT</code> section of your <code class="literal">manila.conf</code>.
The Shared File Systems service requests periodic update of the
<code class="literal">replica_state</code> of all <code class="literal">non-active</code> share replicas. The update occurs with
respect to an interval corresponding to this option. If it is not specified,
it defaults to 300 seconds.</p></dd><dt id="id-1.4.10.13.6.3.2"><span class="term ">replication_domain</span></dt><dd><p>Specify this option in the backend stanza when using a multi-backend style
configuration. The value can be any ASCII string. Two backends that can
replicate between each other would have the same <code class="literal">replication_domain</code>.
This comes from the premise that the Shared File Systems service expects
Share Replication to be performed between symmetric backends. This option
is <span class="emphasis"><em>required</em></span> for using the Share Replication feature.</p></dd></dl></div></div><div class="sect2 " id="id-1.4.10.13.7"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.9.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Health of a share replica</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.7">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Apart from the <code class="literal">status</code> attribute, share replicas have the
<code class="literal">replica_state</code> attribute to denote the state of data replication on the
storage backend. The <code class="literal">primary</code> share replica will have it's <code class="literal">replica_state</code>
attribute set to <code class="literal">active</code>. The <code class="literal">secondary</code> share replicas may have one of
the following as their <code class="literal">replica_state</code>:</p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.10.13.7.3.1"><span class="term ">in_sync</span></dt><dd><p>The share replica is up to date with the <code class="literal">active</code> share replica (possibly
within a backend-specific <code class="literal">recovery point objective</code>).</p></dd><dt id="id-1.4.10.13.7.3.2"><span class="term ">out_of_sync</span></dt><dd><p>The share replica is out of date (all new share replicas start out in
this <code class="literal">replica_state</code>).</p></dd><dt id="id-1.4.10.13.7.3.3"><span class="term ">error</span></dt><dd><p>When the scheduler fails to schedule this share replica or some potentially
irrecoverable error occurred with regard to updating data for this replica.</p></dd></dl></div></div><div class="sect2 " id="id-1.4.10.13.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.9.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Promotion or failover</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>For <code class="literal">readable</code> and <code class="literal">dr</code> types of replication, we refer to the task
of switching a <code class="literal">non-active</code> share replica with the <code class="literal">active</code> replica as
<code class="literal">promotion</code>. For the <code class="literal">writable</code> style of replication, promotion does
not make sense since all share replicas are <code class="literal">active</code> (or writable) at all
times.</p><p>The <code class="literal">status</code> attribute of the non-active replica being promoted will be
set to <code class="literal">replication_change</code> during its promotion. This has been classified as
a <code class="literal">busy</code> state and thus API interactions with the share are restricted
while one of its share replicas is in this state.</p></div><div class="sect2 " id="id-1.4.10.13.9"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.9.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share replication workflows</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.9">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The following examples have been implemented with the ZFSonLinux driver that
is a reference implementation in the Shared File Systems service. It operates
in <code class="literal">driver_handles_share_servers=False</code> mode and supports the <code class="literal">readable</code>
type of replication. In the example, we assume a configuration of two
Availability Zones (configuration option: <code class="literal">storage_availability_zone</code>),
called <code class="literal">availability_zone_1</code> and <code class="literal">availability_zone_2</code>.</p><p>Multiple availability zones are not necessary to use the replication feature.
However, the use of an availability zone as a <code class="literal">failure domain</code> is encouraged.</p><p>Pay attention to the network configuration for the ZFS driver. Here, we assume
a configuration of <code class="literal">zfs_service_ip</code> and <code class="literal">zfs_share_export_ip</code> from two
separate networks. The service network is reachable from the host where the
<code class="literal">manila-share</code> service is running. The share export IP is from a network that
allows user access.</p><p>See <a class="link" href="http://docs.openstack.org/newton/config-reference/shared-file-systems/drivers/zfs-on-linux-driver.html" target="_blank">Configuring the ZFSonLinux driver</a>
for information on how to set up the ZFSonLinux driver.</p><div class="sect3 " id="id-1.4.10.13.9.6"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.9.5.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Creating a share that supports replication</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.9.6">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Create a new share type and specify the <code class="literal">replication_type</code> as an extra-spec
within the share-type being used.</p><p>Use the <code class="command">manila type-create</code> command to create a new share type.
Specify the name and the value for the extra-spec
<code class="literal">driver_handles_share_servers</code>.</p><div class="verbatim-wrap"><pre class="screen">$ manila type-create readable_type_replication False
+----------------------+--------------------------------------+
| Property             | Value                                |
+----------------------+--------------------------------------+
| required_extra_specs | driver_handles_share_servers : False |
| Name                 | readable_type_replication            |
| Visibility           | public                               |
| is_default           | -                                    |
| ID                   | 3b3ee3f7-6e43-4aa1-859d-0b0511c43074 |
| optional_extra_specs | snapshot_support : True              |
+----------------------+--------------------------------------+</pre></div><p>Use the <code class="command">manila type-key</code> command to set an extra-spec to the
share type.</p><div class="verbatim-wrap"><pre class="screen">$ manila type-key readable_type_replication set replication_type=readable</pre></div><div id="id-1.4.10.13.9.6.7" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>This command has no output. To verify the extra-spec, use the
<code class="command">manila extra-specs-list</code> command and specify the share type's name
or ID as a parameter.</p></div><p>Create a share with the share type</p><p>Use the <code class="command">manila create</code> command to create a share. Specify the share
protocol, size and the availability zone.</p><div class="verbatim-wrap"><pre class="screen">$ manila create NFS 1 --share_type readable_type_replication --name my_share --description "This share will have replicas" --az availability_zone_1
+-----------------------------+--------------------------------------+
| Property                    | Value                                |
+-----------------------------+--------------------------------------+
| status                      | creating                             |
| share_type_name             | readable_type_replication            |
| description                 | This share will have replicas        |
| availability_zone           | availability_zone_1                  |
| share_network_id            | None                                 |
| share_server_id             | None                                 |
| host                        |                                      |
| access_rules_status         | active                               |
| snapshot_id                 | None                                 |
| is_public                   | False                                |
| task_state                  | None                                 |
| snapshot_support            | True                                 |
| id                          | e496ed61-8f2e-436b-b299-32c3e90991cc |
| size                        | 1                                    |
| name                        | my_share                             |
| share_type                  | 3b3ee3f7-6e43-4aa1-859d-0b0511c43074 |
| has_replicas                | False                                |
| replication_type            | readable                             |
| created_at                  | 2016-03-29T20:22:18.000000           |
| share_proto                 | NFS                                  |
| consistency_group_id        | None                                 |
| source_cgsnapshot_member_id | None                                 |
| project_id                  | 48a5ca76ac69405e99dc1c13c5195186     |
| metadata                    | {}                                   |
+-----------------------------+--------------------------------------+</pre></div><p>Use the <code class="command">manila show</code> command to retrieve details of the share.
Specify the share ID or name as a parameter.</p><div class="verbatim-wrap"><pre class="screen">$ manila show my_share
+-----------------------------+--------------------------------------------------------------------+
| Property                    | Value                                                              |
+-----------------------------+--------------------------------------------------------------------+
| status                      | available                                                          |
| share_type_name             | readable_type_replication                                          |
| description                 | This share will have replicas                                      |
| availability_zone           | availability_zone_1                                                |
| share_network_id            | None                                                               |
| export_locations            |                                                                    |
|                             | path =                                                             |
|                             |10.32.62.26:/alpha/manila_share_38efc042_50c2_4825_a6d8_cba2a8277b28|
|                             | preferred = False                                                  |
|                             | is_admin_only = False                                              |
|                             | id = e1d754b5-ec06-42d2-afff-3e98c0013faf                          |
|                             | share_instance_id = 38efc042-50c2-4825-a6d8-cba2a8277b28           |
|                             | path =                                                             |
|                             |172.21.0.23:/alpha/manila_share_38efc042_50c2_4825_a6d8_cba2a8277b28|
|                             | preferred = False                                                  |
|                             | is_admin_only = True                                               |
|                             | id = 6f843ecd-a7ea-4939-86de-e1e01d9e8672                          |
|                             | share_instance_id = 38efc042-50c2-4825-a6d8-cba2a8277b28           |
| share_server_id             | None                                                               |
| host                        | openstack4@zfsonlinux_1#alpha                                      |
| access_rules_status         | active                                                             |
| snapshot_id                 | None                                                               |
| is_public                   | False                                                              |
| task_state                  | None                                                               |
| snapshot_support            | True                                                               |
| id                          | e496ed61-8f2e-436b-b299-32c3e90991cc                               |
| size                        | 1                                                                  |
| name                        | my_share                                                           |
| share_type                  | 3b3ee3f7-6e43-4aa1-859d-0b0511c43074                               |
| has_replicas                | False                                                              |
| replication_type            | readable                                                           |
| created_at                  | 2016-03-29T20:22:18.000000                                         |
| share_proto                 | NFS                                                                |
| consistency_group_id        | None                                                               |
| source_cgsnapshot_member_id | None                                                               |
| project_id                  | 48a5ca76ac69405e99dc1c13c5195186                                   |
| metadata                    | {}                                                                 |
+-----------------------------+--------------------------------------------------------------------+</pre></div><div id="id-1.4.10.13.9.6.13" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>When you create a share that supports replication, an <code class="literal">active</code> replica is
created for you. You can verify this with the
<code class="command">manila share-replica-list</code> command.</p></div></div><div class="sect3 " id="id-1.4.10.13.9.7"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.9.5.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Creating and promoting share replicas</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.9.7">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Create a share replica</p><p>Use the <code class="command">manila share-replica-create</code> command to create a share
replica. Specify the share ID or name as a parameter. You may
optionally provide the <code class="literal">availability_zone</code> and <code class="literal">share_network_id</code>. In the
example below, <code class="literal">share_network_id</code> is not used since the ZFSonLinux driver
does not support it.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-create my_share --az availability_zone_2
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| status            | creating                             |
| share_id          | e496ed61-8f2e-436b-b299-32c3e90991cc |
| availability_zone | availability_zone_2                  |
| created_at        | 2016-03-29T20:24:53.148992           |
| updated_at        | None                                 |
| share_network_id  | None                                 |
| share_server_id   | None                                 |
| host              |                                      |
| replica_state     | None                                 |
| id                | 78a5ef96-6c36-42e0-b50b-44efe7c1807e |
+-------------------+--------------------------------------+</pre></div><p>See details of the newly created share replica</p><p>Use the <code class="command">manila share-replica-show</code> command to see details
of the newly created share replica. Specify the share replica's ID as a
parameter.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-show 78a5ef96-6c36-42e0-b50b-44efe7c1807e
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| status            | available                            |
| share_id          | e496ed61-8f2e-436b-b299-32c3e90991cc |
| availability_zone | availability_zone_2                  |
| created_at        | 2016-03-29T20:24:53.000000           |
| updated_at        | 2016-03-29T20:24:58.000000           |
| share_network_id  | None                                 |
| share_server_id   | None                                 |
| host              | openstack4@zfsonlinux_2#beta         |
| replica_state     | in_sync                              |
| id                | 78a5ef96-6c36-42e0-b50b-44efe7c1807e |
+-------------------+--------------------------------------+</pre></div><p>See all replicas of the share</p><p>Use the <code class="command">manila share-replica-list</code> command to see all the replicas
of the share. Specify the share ID or name as an optional parameter.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-list --share-id my_share
+--------------------------------------+-----------+---------------+--------------------------------------+-------------------------------+---------------------+----------------------------+
| ID                                   | Status    | Replica State | Share ID                             | Host                          | Availability Zone   | Updated At                 |
+--------------------------------------+-----------+---------------+--------------------------------------+-------------------------------+---------------------+----------------------------+
| 38efc042-50c2-4825-a6d8-cba2a8277b28 | available | active        | e496ed61-8f2e-436b-b299-32c3e90991cc | openstack4@zfsonlinux_1#alpha | availability_zone_1 | 2016-03-29T20:22:19.000000 |
| 78a5ef96-6c36-42e0-b50b-44efe7c1807e | available | in_sync       | e496ed61-8f2e-436b-b299-32c3e90991cc | openstack4@zfsonlinux_2#beta  | availability_zone_2 | 2016-03-29T20:24:58.000000 |
+--------------------------------------+-----------+---------------+--------------------------------------+-------------------------------+---------------------+----------------------------+</pre></div><p>Promote the secondary share replica to be the new active replica</p><p>Use the <code class="command">manila share-replica-promote</code> command to promote a
non-active share replica to become the <code class="literal">active</code> replica. Specify the
non-active replica's ID as a parameter.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-promote 78a5ef96-6c36-42e0-b50b-44efe7c1807e</pre></div><div id="id-1.4.10.13.9.7.14" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>This command has no output.</p></div><p>The promotion may take time. During the promotion, the <code class="literal">replica_state</code>
attribute of the share replica being promoted will be set to
<code class="literal">replication_change</code>.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-list --share-id my_share
+--------------------------------------+-----------+--------------------+--------------------------------------+-------------------------------+---------------------+----------------------------+
| ID                                   | Status    |    Replica State   | Share ID                             | Host                          | Availability Zone   | Updated At                 |
+--------------------------------------+-----------+--------------------+--------------------------------------+-------------------------------+---------------------+----------------------------+
| 38efc042-50c2-4825-a6d8-cba2a8277b28 | available |       active       | e496ed61-8f2e-436b-b299-32c3e90991cc | openstack4@zfsonlinux_1#alpha | availability_zone_1 | 2016-03-29T20:32:19.000000 |
| 78a5ef96-6c36-42e0-b50b-44efe7c1807e | available | replication_change | e496ed61-8f2e-436b-b299-32c3e90991cc | openstack4@zfsonlinux_2#beta  | availability_zone_2 | 2016-03-29T20:32:19.000000 |
+--------------------------------------+-----------+--------------------+--------------------------------------+-------------------------------+---------------------+----------------------------+</pre></div><p>Once the promotion is complete, the <code class="literal">replica_state</code> will be set to
<code class="literal">active</code>.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-list --share-id my_share
+--------------------------------------+-----------+---------------+--------------------------------------+-------------------------------+---------------------+----------------------------+
| ID                                   | Status    | Replica State | Share ID                             | Host                          | Availability Zone   | Updated At                 |
+--------------------------------------+-----------+---------------+--------------------------------------+-------------------------------+---------------------+----------------------------+
| 38efc042-50c2-4825-a6d8-cba2a8277b28 | available | in_sync       | e496ed61-8f2e-436b-b299-32c3e90991cc | openstack4@zfsonlinux_1#alpha | availability_zone_1 | 2016-03-29T20:32:19.000000 |
| 78a5ef96-6c36-42e0-b50b-44efe7c1807e | available | active        | e496ed61-8f2e-436b-b299-32c3e90991cc | openstack4@zfsonlinux_2#beta  | availability_zone_2 | 2016-03-29T20:32:19.000000 |
+--------------------------------------+-----------+---------------+--------------------------------------+-------------------------------+---------------------+----------------------------+</pre></div></div><div class="sect3 " id="id-1.4.10.13.9.8"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.9.5.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Access rules</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.9.8">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Create an IP access rule for the share</p><p>Use the <code class="command">manila access-allow</code> command to add an access rule.
Specify the share ID or name, protocol and the target as parameters.</p><div class="verbatim-wrap"><pre class="screen">$ manila access-allow my_share ip 0.0.0.0/0 --access-level rw
+--------------+--------------------------------------+
| Property     | Value                                |
+--------------+--------------------------------------+
| share_id     | e496ed61-8f2e-436b-b299-32c3e90991cc |
| access_type  | ip                                   |
| access_to    | 0.0.0.0/0                            |
| access_level | rw                                   |
| state        | new                                  |
| id           | 8b339cdc-c1e0-448f-bf6d-f068ee6e8f45 |
+--------------+--------------------------------------+</pre></div><div id="id-1.4.10.13.9.8.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>Access rules are not meant to be different across the replicas of the share.
However, as per the type of replication, drivers may choose to modify the
access level prescribed. In the above example, even though read/write access
was requested for the share, the driver will provide read-only access to
the non-active replica to the same target, because of the semantics of
the replication type: <code class="literal">readable</code>. However, the target will have read/write
access to the (currently) non-active replica when it is promoted to
become the <code class="literal">active</code> replica.</p></div><p>The <code class="command">manila access-deny</code> command can be used to remove a previously
applied access rule.</p><p>List the export locations of the share</p><p>Use the <code class="command">manila share-export-locations-list</code> command to list the
export locations of a share.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-export-location-list my_share
+--------------------------------------+---------------------------------------------------------------------------+-----------+
| ID                                   | Path                                                                      | Preferred |
+--------------------------------------+---------------------------------------------------------------------------+-----------+
| 3ed3fbf5-2fa1-4dc0-8440-a0af72398cb6 | 10.32.62.21:/beta/subdir/manila_share_78a5ef96_6c36_42e0_b50b_44efe7c1807e| False     |
| 6f843ecd-a7ea-4939-86de-e1e01d9e8672 | 172.21.0.23:/alpha/manila_share_38efc042_50c2_4825_a6d8_cba2a8277b28      | False     |
| e1d754b5-ec06-42d2-afff-3e98c0013faf | 10.32.62.26:/alpha/manila_share_38efc042_50c2_4825_a6d8_cba2a8277b28      | False     |
| f3c5585f-c2f7-4264-91a7-a4a1e754e686 | 172.21.0.29:/beta/subdir/manila_share_78a5ef96_6c36_42e0_b50b_44efe7c1807e| False     |
+--------------------------------------+---------------------------------------------------------------------------+-----------+</pre></div><p>Identify the export location corresponding to the share replica on the user
accessible network and you may mount it on the target node.</p><div id="id-1.4.10.13.9.8.11" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>As an administrator, you can list the export locations for a particular
share replica by using the
<code class="command">manila share-instance-export-location-list</code> command and
specifying the share replica's ID as a parameter.</p></div></div><div class="sect3 " id="id-1.4.10.13.9.9"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.9.5.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Snapshots</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.9.9">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Create a snapshot of the share</p><p>Use the <code class="command">manila snapshot-create</code> command to create a snapshot
of the share. Specify the share ID or name as a parameter.</p><div class="verbatim-wrap"><pre class="screen">$ manila snapshot-create my_share --name "my_snapshot"
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| status            | creating                             |
| share_id          | e496ed61-8f2e-436b-b299-32c3e90991cc |
| description       | None                                 |
| created_at        | 2016-03-29T21:14:03.000000           |
| share_proto       | NFS                                  |
| provider_location | None                                 |
| id                | 06cdccaf-93a0-4e57-9a39-79fb1929c649 |
| size              | 1                                    |
| share_size        | 1                                    |
| name              | my_snapshot                          |
+-------------------+--------------------------------------+</pre></div><p>Show the details of the snapshot</p><p>Use the <code class="command">manila snapshot-show</code> to view details of a snapshot.
Specify the snapshot ID or name as a parameter.</p><div class="verbatim-wrap"><pre class="screen">$ manila snapshot-show my_snapshot
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| status            | available                            |
| share_id          | e496ed61-8f2e-436b-b299-32c3e90991cc |
| description       | None                                 |
| created_at        | 2016-03-29T21:14:03.000000           |
| share_proto       | NFS                                  |
| provider_location | None                                 |
| id                | 06cdccaf-93a0-4e57-9a39-79fb1929c649 |
| size              | 1                                    |
| share_size        | 1                                    |
| name              | my_snapshot                          |
+-------------------+--------------------------------------+</pre></div><div id="id-1.4.10.13.9.9.8" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>The <code class="literal">status</code> attribute of a snapshot will transition from <code class="literal">creating</code>
to <code class="literal">available</code> only when it is present on all the share replicas that have
their <code class="literal">replica_state</code> attribute set to <code class="literal">active</code> or <code class="literal">in_sync</code>.</p><p>Likewise, the <code class="literal">replica_state</code> attribute of a share replica will
transition from <code class="literal">out_of_sync</code> to <code class="literal">in_sync</code> only when all <code class="literal">available</code>
snapshots are present on it.</p></div></div><div class="sect3 " id="id-1.4.10.13.9.10"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.9.5.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Planned failovers</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.9.10">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>As an administrator, you can use the <code class="command">manila share-replica-resync</code>
command to attempt to sync data between <code class="literal">active</code> and <code class="literal">non-active</code> share
replicas of a share before promotion. This will ensure that share replicas have
the most up-to-date data and their relationships can be safely switched.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-resync 38efc042-50c2-4825-a6d8-cba2a8277b28</pre></div><div id="id-1.4.10.13.9.10.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>This command has no output.</p></div></div><div class="sect3 " id="id-1.4.10.13.9.11"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.9.5.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Updating attributes</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.9.11">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>If an error occurs while updating data or replication relationships (during
a <code class="literal">promotion</code>), the Shared File Systems service may not be able to determine
the consistency or health of a share replica. It may require administrator
intervention to make any fixes on the storage backend as necessary. In such a
situation, state correction within the Shared File Systems service is possible.</p><p>As an administrator, you can:</p><p>Reset the <code class="literal">status</code> attribute of a share replica</p><p>Use the <code class="command">manila share-replica-reset-state</code> command to reset
the <code class="literal">status</code> attribute. Specify the share replica's ID as a parameter
and use the <code class="literal">--state</code> option to specify the state intended.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-reset-state 38efc042-50c2-4825-a6d8-cba2a8277b28 --state=available</pre></div><div id="id-1.4.10.13.9.11.7" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>This command has no output.</p></div><p>Reset the <code class="literal">replica_state</code> attribute</p><p>Use the <code class="command">manila share-replica-reset-replica-state</code> command to
reset the <code class="literal">replica_state</code> attribute. Specify the share replica's ID
and use the <code class="literal">--state</code> option to specify the state intended.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-reset-replica-state 38efc042-50c2-4825-a6d8-cba2a8277b28 --state=out_of_sync</pre></div><div id="id-1.4.10.13.9.11.11" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>This command has no output.</p></div><p>Force delete a specified share replica in any state</p><p>Use the <code class="command">manila share-replica-delete</code> command with the
'--force' key to remove the share replica, regardless of the state it is in.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-show 9513de5d-0384-4528-89fb-957dd9b57680
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| status            | error                                |
| share_id          | e496ed61-8f2e-436b-b299-32c3e90991cc |
| availability_zone | availability_zone_1                  |
| created_at        | 2016-03-30T01:32:47.000000           |
| updated_at        | 2016-03-30T01:34:25.000000           |
| share_network_id  | None                                 |
| share_server_id   | None                                 |
| host              | openstack4@zfsonlinux_1#alpha        |
| replica_state     | out_of_sync                          |
| id                | 38efc042-50c2-4825-a6d8-cba2a8277b28 |
+-------------------+--------------------------------------+

$ manila share-replica-delete --force 38efc042-50c2-4825-a6d8-cba2a8277b28</pre></div><div id="id-1.4.10.13.9.11.15" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>This command has no output.</p></div><p>Use the <code class="literal">policy.json</code> file to grant permissions for these actions to other
roles.</p></div><div class="sect3 " id="id-1.4.10.13.9.12"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.9.5.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Deleting share replicas</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.13.9.12">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Use the <code class="command">manila share-replica-delete</code> command with the share
replica's ID to delete a share replica.</p><div class="verbatim-wrap"><pre class="screen">$ manila share-replica-delete 38efc042-50c2-4825-a6d8-cba2a8277b28</pre></div><div id="id-1.4.10.13.9.12.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>This command has no output.</p></div><div id="id-1.4.10.13.9.12.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>You cannot delete the last <code class="literal">active</code> replica with this command. You should
use the <code class="command">manila delete</code> command to remove the share.</p></div></div></div></div><div class="sect1 " id="shared-file-systems-multi-backend"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.10 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Multi-storage configuration</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-multi-backend">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-multi-backend</li></ul></div></div></div></div><p>The Shared File Systems service can provide access to multiple file storage
back ends. In general, the workflow with multiple back ends looks similar
to the Block Storage service one, see <a class="xref" href="bk02ch07.html#multi-backend" title="7.2.4. Configure multiple-storage back ends">Section 7.2.4, “Configure multiple-storage back ends”</a>.</p><p>Using <code class="literal">manila.conf</code>, you can spawn multiple share services. To do it, you
should set the <code class="literal">enabled_share_backends</code> flag in the <code class="literal">manila.conf</code> file. This
flag defines the comma-separated names of the configuration stanzas for the
different back ends. One name is associated to one configuration group for a
back end.</p><p>The following example runs three configured share services:</p><div class="verbatim-wrap highlight ini"><pre class="screen">[DEFAULT]
enabled_share_backends=backendEMC2,backendGeneric1,backendNetApp

[backendGeneric1]
share_driver=manila.share.drivers.generic.GenericShareDriver
share_backend_name=one_name_for_two_backends
service_instance_user=ubuntu_user
service_instance_password=ubuntu_user_password
service_image_name=ubuntu_image_name
path_to_private_key=/home/foouser/.ssh/id_rsa
path_to_public_key=/home/foouser/.ssh/id_rsa.pub

[backendEMC2]
share_driver=manila.share.drivers.emc.driver.EMCShareDriver
share_backend_name=backendEMC2
emc_share_backend=vnx
emc_nas_server=1.1.1.1
emc_nas_password=password
emc_nas_login=user
emc_nas_server_container=server_3
emc_nas_pool_name="Pool 2"

[backendNetApp]
share_driver = manila.share.drivers.netapp.common.NetAppDriver
driver_handles_share_servers = True
share_backend_name=backendNetApp
netapp_login=user
netapp_password=password
netapp_server_hostname=1.1.1.1
netapp_root_volume_aggregate=aggr01</pre></div><p>To spawn separate groups of share services, you can use separate configuration
files. If it is necessary to control each back end in a separate way, you
should provide a single configuration file per each back end.</p><div class="sect2 " id="shared-file-systems-scheduling"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.10.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Scheduling</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-scheduling">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-scheduling</li></ul></div></div></div></div><p>The Shared File Systems service uses a scheduler to provide unified
access for a variety of different types of shared file systems. The
scheduler collects information from the active shared services, and
makes decisions such as what shared services will be used to create
a new share. To manage this process, the Shared File Systems service
provides Share types API.</p><p>A share type is a list from key-value pairs called extra-specs. The
scheduler uses required and un-scoped extra-specs to look up
the shared service most suitable for a new share with the specified share type.
For more information about extra-specs and their type, see <a class="link" href="http://docs.openstack.org/developer/manila/devref/capabilities_and_extra_specs.html" target="_blank">Capabilities
and Extra-Specs</a> section in developer documentation.</p><p>The general scheduler workflow:</p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Share services report information about their existing pool number, their
capacities, and their capabilities.</p></li><li class="step "><p>When a request on share creation arrives, the scheduler picks a service
and pool that best serves the request, using share type
filters and back end capabilities. If back end capabilities pass through,
all filters request the selected back end where the target pool resides.</p></li><li class="step "><p>The share driver receives a reply on the request status, and lets the
target pool serve the request as the scheduler instructs. The scoped
and un-scoped share types are available for the driver implementation
to use as needed.</p></li></ol></div></div></div><div class="sect2 " id="id-1.4.10.14.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.10.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Manage shares services</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.14.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The Shared File Systems service provides API that allows to manage running
share services (<a class="link" href="http://developer.openstack.org/api-ref/shared-file-systems/" target="_blank">Share services API</a>).
Using the <code class="command">manila service-list</code> command, it is possible to get a list
of all kinds of running services. To select only share services, you can pick
items that have field <code class="literal">binary</code> equal to <code class="literal">manila-share</code>. Also, you can
enable or disable share services using raw API requests. Disabling means that
share services are excluded from the scheduler cycle and new shares will not
be placed on the disabled back end. However, shares from this service stay
available.</p></div></div><div class="sect1 " id="id-1.4.10.15"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.11 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Networking</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.15">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Unlike the OpenStack Block Storage service, the Shared File Systems service
must connect to the Networking service. The share service requires the
option to self-manage share servers. For client authentication and
authorization, you can configure the Shared File Systems service to
work with different network authentication services, like LDAP, Kerberos
protocols, or Microsoft Active Directory.</p><div class="sect2 " id="shared-file-systems-share-networks"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.11.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Share networks</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-share-networks">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-share-networks</li></ul></div></div></div></div><p>Share network is an entity that encapsulates interaction with the OpenStack
Networking service. If the share driver that you selected runs in a mode
requiring Networking service interaction, specify the share network when
creating a new share network.</p><div class="sect3 " id="id-1.4.10.15.3.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.11.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">How to create share network</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.15.3.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To list networks in a project, run:</p><div class="verbatim-wrap"><pre class="screen">$ openstack network list
+--------------+---------+--------------------+
| ID           | Name    | Subnets            |
+--------------+---------+--------------------+
| bee7411d-... | public  | 884a6564-0f11-...  |
|              |         | e6da81fa-5d5f-...  |
| 5ed5a854-... | private | 74dcfb5a-b4d7-...  |
|              |         | cc297be2-5213-...  |
+--------------+---------+--------------------+</pre></div><p>A share network stores network information that share servers can use where
shares are hosted. You can associate a share with a single share network.
When you create or update a share, you can optionally specify the ID of a share
network through which instances can access the share.</p><p>When you create a share network, you can specify only one type of network:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>OpenStack Networking (neutron). Specify a network ID and subnet ID.
In this case <code class="literal">manila.network.nova_network_plugin.NeutronNetworkPlugin</code>
will be used.</p></li><li class="listitem "><p>Legacy networking (nova-network). Specify a network ID.
In this case <code class="literal">manila.network.nova_network_plugin.NoveNetworkPlugin</code>
will be used.</p></li></ul></div><p>For more information about supported plug-ins for share networks, see
<a class="xref" href="bk02ch08.html#shared-file-systems-network-plugins" title="8.11.2. Network plug-ins">Section 8.11.2, “Network plug-ins”</a>.</p><p>A share network has these attributes:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>The IP block in Classless Inter-Domain Routing (CIDR) notation from which to
allocate the network.</p></li><li class="listitem "><p>The IP version of the network.</p></li><li class="listitem "><p>The network type, which is <code class="literal">vlan</code>, <code class="literal">vxlan</code>, <code class="literal">gre</code>, or <code class="literal">flat</code>.</p></li></ul></div><p>If the network uses segmentation, a segmentation identifier. For example, VLAN,
VXLAN, and GRE networks use segmentation.</p><p>To create a share network with private network and subnetwork, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila share-network-create --neutron-net-id 5ed5a854-21dc-4ed3-870a-117b7064eb21 \
--neutron-subnet-id 74dcfb5a-b4d7-4855-86f5-a669729428dc --name my_share_net --description "My first share network"
+-------------------+--------------------------------------+
| Property          | Value                                |
+-------------------+--------------------------------------+
| name              | my_share_net                         |
| segmentation_id   | None                                 |
| created_at        | 2015-09-24T12:06:32.602174           |
| neutron_subnet_id | 74dcfb5a-b4d7-4855-86f5-a669729428dc |
| updated_at        | None                                 |
| network_type      | None                                 |
| neutron_net_id    | 5ed5a854-21dc-4ed3-870a-117b7064eb21 |
| ip_version        | None                                 |
| nova_net_id       | None                                 |
| cidr              | None                                 |
| project_id        | 20787a7ba11946adad976463b57d8a2f     |
| id                | 5c3cbabb-f4da-465f-bc7f-fadbe047b85a |
| description       | My first share network               |
+-------------------+--------------------------------------+</pre></div><p>The <code class="literal">segmentation_id</code>, <code class="literal">cidr</code>, <code class="literal">ip_version</code>, and <code class="literal">network_type</code>
share network attributes are automatically set to the values determined by the
network provider.</p><p>To check the network list, run:</p><div class="verbatim-wrap"><pre class="screen">$ manila share-network-list
+--------------------------------------+--------------+
| id                                   | name         |
+--------------------------------------+--------------+
| 5c3cbabb-f4da-465f-bc7f-fadbe047b85a | my_share_net |
+--------------------------------------+--------------+</pre></div><p>If you configured the generic driver with <code class="literal">driver_handles_share_servers =
True</code> (with the share servers) and already had previous operations in the Shared
File Systems service, you can see <code class="literal">manila_service_network</code> in the neutron
list of networks. This network was created by the generic driver for internal
use.</p><div class="verbatim-wrap"><pre class="screen">$ openstack network list
+--------------+------------------------+--------------------+
| ID           | Name                   | Subnets            |
+--------------+------------------------+--------------------+
| 3b5a629a-e...| manila_service_network | 4f366100-50...     |
| bee7411d-... | public                 | 884a6564-0f11-...  |
|              |                        | e6da81fa-5d5f-...  |
| 5ed5a854-... | private                | 74dcfb5a-b4d7-...  |
|              |                        | cc297be2-5213-...  |
+--------------+------------------------+--------------------+</pre></div><p>You also can see detailed information about the share network including
<code class="literal">network_type</code>, and <code class="literal">segmentation_id</code> fields:</p><div class="verbatim-wrap"><pre class="screen">$ openstack network show manila_service_network
+---------------------------+--------------------------------------+
| Field                     | Value                                |
+---------------------------+--------------------------------------+
| admin_state_up            | UP                                   |
| availability_zone_hints   |                                      |
| availability_zones        | nova                                 |
| created_at                | 2016-12-13T09:31:30Z                 |
| description               |                                      |
| id                        | 3b5a629a-e7a1-46a3-afb2-ab666fb884bc |
| ipv4_address_scope        | None                                 |
| ipv6_address_scope        | None                                 |
| mtu                       | 1450                                 |
| name                      | manila_service_network               |
| port_security_enabled     | True                                 |
| project_id                | f6ac448a469b45e888050cf837b6e628     |
| provider:network_type     | vxlan                                |
| provider:physical_network | None                                 |
| provider:segmentation_id  | 73                                   |
| revision_number           | 7                                    |
| router:external           | Internal                             |
| shared                    | False                                |
| status                    | ACTIVE                               |
| subnets                   | 682e3329-60b0-440f-8749-83ef53dd8544 |
| tags                      | []                                   |
| updated_at                | 2016-12-13T09:31:36Z                 |
+---------------------------+--------------------------------------+</pre></div><p>You also can add and remove the security services from the share network.
For more detail, see <a class="xref" href="bk02ch08.html#shared-file-systems-security-services" title="8.7. Security services">Section 8.7, “Security services”</a>.</p></div></div><div class="sect2 " id="shared-file-systems-network-plugins"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.11.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Network plug-ins</span> <a title="Permalink" class="permalink" href="bk02ch08.html#shared-file-systems-network-plugins">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>shared-file-systems-network-plugins</li></ul></div></div></div></div><p>The Shared File Systems service architecture defines an abstraction layer for
network resource provisioning and allowing administrators to choose from a
different options for how network resources are assigned to their projects’
networked storage. There are a set of network plug-ins that provide a variety
of integration approaches with the network services that are available with
OpenStack.</p><p>The Shared File Systems service may need a network resource provisioning if
share service with specified driver works in mode, when a share driver manages
lifecycle of share servers on its own. This behavior is defined by a flag
<code class="literal">driver_handles_share_servers</code> in share service configuration.  When
<code class="literal">driver_handles_share_servers</code> is set to <code class="literal">True</code>, a share driver will be
called to create share servers for shares using information provided within a
share network. This information will be provided to one of the enabled network
plug-ins that will handle reservation, creation and deletion of network
resources including IP addresses and network interfaces.</p><div class="sect3 " id="id-1.4.10.15.4.4"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.11.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">What network plug-ins are available?</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.15.4.4">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>There are three different network plug-ins and five python classes in the
Shared File Systems service:</p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Network plug-in for using the OpenStack Networking service. It allows to use
any network segmentation that the Networking service supports. It is up to
each share driver to support at least one network segmentation type.</p><ol type="a" class="substeps "><li class="step "><p><code class="literal">manila.network.neutron.neutron_network_plugin.NeutronNetworkPlugin</code>.
This is a default network plug-in. It requires the <code class="literal">neutron_net_id</code> and
the <code class="literal">neutron_subnet_id</code> to be provided when defining the share network
that will be used for the creation of share servers. The user may define
any number of share networks corresponding to the various physical
network segments in a project environment.</p></li><li class="step "><p><code class="literal">manila.network.neutron.neutron_network_plugin.
NeutronSingleNetworkPlugin</code>. This is a simplification of the previous
case. It accepts values for <code class="literal">neutron_net_id</code> and <code class="literal">neutron_subnet_id</code>
from the <code class="literal">manila.conf</code> configuration file and uses one network for all
shares.</p></li></ol><p>When only a single network is needed, the NeutronSingleNetworkPlugin (1.b)
is a simple solution. Otherwise NeutronNetworkPlugin (1.a) should be chosen.</p></li><li class="step "><p>Network plug-in for working with OpenStack Networking from the Compute
service. It supports either flat networks or VLAN-segmented networks.</p><ol type="a" class="substeps "><li class="step "><p><code class="literal">manila.network.nova_network_plugin.NovaNetworkPlugin</code>. This plug-in
serves the networking needs when <code class="literal">Nova networking</code> is configured in
the cloud instead of Neutron. It requires a single parameter,
<code class="literal">nova_net_id</code>.</p></li><li class="step "><p><code class="literal">manila.network.nova_network_plugin.NovaSingleNetworkPlugin</code>. This
plug-in works the same way as
<code class="literal">manila.network.nova_network_plugin.NovaNetworkPlugin</code>, except it takes
<code class="literal">nova_net_id</code> from the Shared File Systems service configuration
file and creates the share servers using only one network.</p></li></ol><p>When only a single network is needed, the NovaSingleNetworkPlugin (2.b) is a
simple solution. Otherwise NovaNetworkPlugin (2.a) should be chosen.</p></li><li class="step "><p>Network plug-in for specifying networks independently from OpenStack
networking services.</p><ol type="a" class="substeps "><li class="step "><p><code class="literal">manila.network.standalone_network_plugin.StandaloneNetworkPlugin</code>.
This plug-in uses a pre-existing network that is available to the
manila-share host. This network may be handled either by OpenStack or be
created independently by any other means. The plug-in supports any type
of network - flat and segmented. As above, it is completely up to the
share driver to support the network type for which the network plug-in is
configured.</p></li></ol></li></ol></div></div><div id="id-1.4.10.15.4.4.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>These network plug-ins were introduced in the OpenStack Kilo release. In
the OpenStack Juno version, only NeutronNetworkPlugin is available.</p></div><p>More information about network plug-ins can be found in <a class="link" href="http://docs.openstack.org/developer/manila/adminref/network_plugins.html" target="_blank">Manila developer documentation</a></p></div></div></div><div class="sect1 " id="id-1.4.10.16"><div class="titlepage"><div><div><h2 class="title"><span class="number">8.12 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Troubleshoot Shared File Systems service</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect2 " id="id-1.4.10.16.2"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.12.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Failures in Share File Systems service during a share creation</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.2">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect3 " id="id-1.4.10.16.2.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Problem</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.2.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>New shares can enter <code class="literal">error</code> state during the creation process.</p></div><div class="sect3 " id="id-1.4.10.16.2.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Solution</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.2.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Make sure, that share services are running in debug mode. If the debug mode
is not set, you will not get any tips from logs how to fix your issue.</p></li><li class="step "><p>Find what share service holds a specified share. To do that, run command
<code class="command">manila show &lt;share_id_or_name&gt;</code> and find a share host in the
output. Host uniquely identifies what share service holds the broken share.</p></li><li class="step "><p>Look thought logs of this share service. Usually, it can be found at
<code class="literal">/etc/var/log/manila-share.log</code>. This log should contain kind of
traceback with extra information to help you to find the origin of issues.</p></li></ol></div></div></div></div><div class="sect2 " id="id-1.4.10.16.3"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.12.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">No valid host was found</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.3">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect3 " id="id-1.4.10.16.3.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Problem</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.3.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>If a share type contains invalid extra specs, the scheduler will not be
able to locate a valid host for the shares.</p></div><div class="sect3 " id="id-1.4.10.16.3.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Solution</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.3.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To diagnose this issue, make sure that scheduler service is running in
debug mode. Try to create a new share and look for message <code class="literal">Failed to
schedule create_share: No valid host was found.</code> in
<code class="literal">/etc/var/log/manila-scheduler.log</code>.</p><p>To solve this issue look carefully through the list of extra specs in
the share type, and the list of share services reported capabilities.
Make sure that extra specs are pointed in the right way.</p></div></div><div class="sect2 " id="id-1.4.10.16.4"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.12.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Created share is unreachable</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.4">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect3 " id="id-1.4.10.16.4.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Problem</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.4.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>By default, a new share does not have any active access rules.</p></div><div class="sect3 " id="id-1.4.10.16.4.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.3.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Solution</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.4.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To provide access to new share, you need to create
appropriate access rule with the right value.
The value must defines access.</p></div></div><div class="sect2 " id="id-1.4.10.16.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.12.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Service becomes unavailable after upgrade</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect3 " id="id-1.4.10.16.5.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.4.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Problem</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.5.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>After upgrading the Shared File Systems service from version v1 to version
v2.x, you must update the service endpoint in the OpenStack Identity service.
Otherwise, the service may become unavailable.</p></div><div class="sect3 " id="id-1.4.10.16.5.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.4.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Solution</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.5.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>To get the service type related to the Shared File Systems service, run:</p><div class="verbatim-wrap"><pre class="screen"># openstack endpoint list

# openstack endpoint show &lt;share-service-type&gt;</pre></div><p>You will get the endpoints expected from running the Shared File Systems
service.</p></li><li class="step "><p>Make sure that these endpoints are updated. Otherwise, delete the outdated
endpoints and create new ones.</p></li></ol></div></div></div></div><div class="sect2 " id="id-1.4.10.16.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">8.12.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Failures during management of internal resources</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.6">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect3 " id="id-1.4.10.16.6.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.5.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Problem</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.6.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The Shared File System service manages internal resources effectively.
Administrators may need to manually adjust internal resources to
handle failures.</p></div><div class="sect3 " id="id-1.4.10.16.6.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">8.12.5.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Solution</span> <a title="Permalink" class="permalink" href="bk02ch08.html#id-1.4.10.16.6.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Some drivers in the Shared File Systems service can create service entities,
like servers and networks. If it is necessary, you can log in to
project <code class="literal">service</code> and take manual control over it.</p></div></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="networking.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 9 </span>Networking</span></a><a class="nav-link" href="bk02ch07.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 7 </span>Block Storage</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2021 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>