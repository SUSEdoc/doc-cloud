<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Networking | OpenStack Administrator Guide | SUSE OpenStack Cloud 8</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 3.2.0 (https://opensuse.github.io/daps) using SUSE XSL Stylesheets 2.81.0 (based on DocBook XSL Stylesheets 1.79.2) - chunked" /><meta name="product-name" content="SUSE OpenStack Cloud" /><meta name="product-number" content="8" /><meta name="book-title" content="OpenStack Administrator Guide" /><meta name="chapter-title" content="Chapter 9. Networking" /><meta name="description" content="Learn OpenStack Networking concepts, architecture, and basic and advanced neutron and nova command-line interface (CLI) commands." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 8" /><link rel="home" href="index.html" title="SUSE OpenStack Cloud Crowbar 8 Documentation" /><link rel="up" href="book-upstream-admin.html" title="OpenStack Administrator Guide" /><link rel="prev" href="bk02ch08.html" title="Chapter 8. Shared File Systems" /><link rel="next" href="bk02ch10.html" title="Chapter 10. Telemetry" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="SUSE OpenStack Cloud Crowbar 8 Documentation"><span class="book-icon">SUSE OpenStack Cloud Crowbar 8 Documentation</span></a><span> › </span><a class="crumb" href="book-upstream-admin.html">OpenStack Administrator Guide</a><span> › </span><a class="crumb" href="networking.html">Networking</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>OpenStack Administrator Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="bk02ch01.html"><span class="number">1 </span><span class="name">Documentation Conventions</span></a></li><li class="inactive"><a href="bk02ch02.html"><span class="number">2 </span><span class="name">Get started with OpenStack</span></a></li><li class="inactive"><a href="cha-identity.html"><span class="number">3 </span><span class="name">Identity management</span></a></li><li class="inactive"><a href="bk02ch04.html"><span class="number">4 </span><span class="name">Dashboard</span></a></li><li class="inactive"><a href="bk02ch05.html"><span class="number">5 </span><span class="name">Compute</span></a></li><li class="inactive"><a href="bk02ch06.html"><span class="number">6 </span><span class="name">Object Storage</span></a></li><li class="inactive"><a href="bk02ch07.html"><span class="number">7 </span><span class="name">Block Storage</span></a></li><li class="inactive"><a href="bk02ch08.html"><span class="number">8 </span><span class="name">Shared File Systems</span></a></li><li class="inactive"><a href="networking.html"><span class="number">9 </span><span class="name">Networking</span></a></li><li class="inactive"><a href="bk02ch10.html"><span class="number">10 </span><span class="name">Telemetry</span></a></li><li class="inactive"><a href="bk02ch11.html"><span class="number">11 </span><span class="name">Database</span></a></li><li class="inactive"><a href="bk02ch12.html"><span class="number">12 </span><span class="name">Bare Metal</span></a></li><li class="inactive"><a href="bk02ch13.html"><span class="number">13 </span><span class="name">Orchestration</span></a></li><li class="inactive"><a href="osadm-os-cli.html"><span class="number">14 </span><span class="name">OpenStack command-line clients</span></a></li><li class="inactive"><a href="bk02ch15.html"><span class="number">15 </span><span class="name">Cross-project features</span></a></li><li class="inactive"><a href="bk02ch16.html"><span class="number">16 </span><span class="name">Appendix</span></a></li><li class="inactive"><a href="bk02go01.html"><span class="number"> </span><span class="name">Glossary</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 8. Shared File Systems" href="bk02ch08.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 10. Telemetry" href="bk02ch10.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="SUSE OpenStack Cloud Crowbar 8 Documentation"><span class="book-icon">SUSE OpenStack Cloud Crowbar 8 Documentation</span></a><span> › </span><a class="crumb" href="book-upstream-admin.html">OpenStack Administrator Guide</a><span> › </span><a class="crumb" href="networking.html">Networking</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 8. Shared File Systems" href="bk02ch08.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 10. Telemetry" href="bk02ch10.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="networking"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname ">SUSE OpenStack Cloud</span> <span class="productnumber ">8</span></div><div><h1 class="title"><span class="number">9 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Networking</span> <a title="Permalink" class="permalink" href="networking.html#">#</a></h1><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>networking</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="networking.html#id-1.4.11.4"><span class="number">9.1 </span><span class="name">Introduction to Networking</span></a></span></dt><dt><span class="sect1"><a href="networking.html#id-1.4.11.5"><span class="number">9.2 </span><span class="name">Networking architecture</span></a></span></dt><dt><span class="sect1"><a href="networking.html#id-1.4.11.6"><span class="number">9.3 </span><span class="name">Plug-in configurations</span></a></span></dt><dt><span class="sect1"><a href="networking.html#id-1.4.11.7"><span class="number">9.4 </span><span class="name">Configure neutron agents</span></a></span></dt><dt><span class="sect1"><a href="networking.html#id-1.4.11.8"><span class="number">9.5 </span><span class="name">Configure Identity service for Networking</span></a></span></dt><dt><span class="sect1"><a href="networking.html#id-1.4.11.9"><span class="number">9.6 </span><span class="name">Advanced configuration options</span></a></span></dt><dt><span class="sect1"><a href="networking.html#id-1.4.11.10"><span class="number">9.7 </span><span class="name">Scalable and highly available DHCP agents</span></a></span></dt><dt><span class="sect1"><a href="networking.html#id-1.4.11.11"><span class="number">9.8 </span><span class="name">Use Networking</span></a></span></dt><dt><span class="sect1"><a href="networking.html#networking-adv-features"><span class="number">9.9 </span><span class="name">Advanced features through API extensions</span></a></span></dt><dt><span class="sect1"><a href="networking.html#id-1.4.11.13"><span class="number">9.10 </span><span class="name">Advanced operational features</span></a></span></dt><dt><span class="sect1"><a href="networking.html#authentication-and-authorization"><span class="number">9.11 </span><span class="name">Authentication and authorization</span></a></span></dt></dl></div></div><p>Learn OpenStack Networking concepts, architecture, and basic and
advanced <code class="literal">neutron</code> and <code class="literal">nova</code> command-line interface (CLI) commands.</p><div class="sect1 " id="id-1.4.11.4"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Introduction to Networking</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.4">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The Networking service, code-named neutron, provides an API that lets
you define network connectivity and addressing in the cloud. The
Networking service enables operators to leverage different networking
technologies to power their cloud networking. The Networking service
also provides an API to configure and manage a variety of network
services ranging from L3 forwarding and NAT to load balancing, edge
firewalls, and IPsec VPN.</p><p>For a detailed description of the Networking API abstractions and their
attributes, see the <a class="link" href="http://developer.openstack.org/api-ref/networking/v2/" target="_blank">OpenStack Networking API v2.0
Reference</a>.</p><div id="id-1.4.11.4.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>If you use the Networking service, do not run the Compute
<code class="literal">nova-network</code> service (like you do in traditional Compute deployments).
When you configure networking, see the Compute-related topics in this
Networking section.</p></div><div class="sect2 " id="id-1.4.11.4.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Networking API</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.4.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Networking is a virtual network service that provides a powerful API to
define the network connectivity and IP addressing that devices from
other services, such as Compute, use.</p><p>The Compute API has a virtual server abstraction to describe computing
resources. Similarly, the Networking API has virtual network, subnet,
and port abstractions to describe networking resources.</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Resource</p>
                </th><th>
                  <p>Description</p>
                </th></tr></thead><tbody><tr><td>
                  <p>
                    <span class="bold"><strong>Network</strong></span>
                  </p>
                </td><td>
                  <p>An isolated L2 segment, analogous to VLAN in the physical
networking world.</p>
                </td></tr><tr><td>
                  <p>
                    <span class="bold"><strong>Subnet</strong></span>
                  </p>
                </td><td>
                  <p>A block of v4 or v6 IP addresses and associated
configuration state.</p>
                </td></tr><tr><td>
                  <p>
                    <span class="bold"><strong>Port</strong></span>
                  </p>
                </td><td>
                  <p>A connection point for attaching a single device, such as
the NIC of a virtual server, to a virtual network. Also
describes the associated network configuration, such as
the MAC and IP addresses to be used on that port.</p>
                </td></tr></tbody></table></div><p>
          <span class="bold"><strong>Networking resources</strong></span>
        </p><p>To configure rich network topologies, you can create and configure
networks and subnets and instruct other OpenStack services like Compute
to attach virtual devices to ports on these networks.</p><p>In particular, Networking supports each project having multiple private
networks and enables projects to choose their own IP addressing scheme,
even if those IP addresses overlap with those that other projects use.</p><p>The Networking service:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Enables advanced cloud networking use cases, such as building
multi-tiered web applications and enabling migration of applications
to the cloud without changing IP addresses.</p></li><li class="listitem "><p>Offers flexibility for administrators to customize network
offerings.</p></li><li class="listitem "><p>Enables developers to extend the Networking API. Over time, the
extended functionality becomes part of the core Networking API.</p></li></ul></div></div><div class="sect2 " id="id-1.4.11.4.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure SSL support for networking API</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.4.6">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>OpenStack Networking supports SSL for the Networking API server. By
default, SSL is disabled but you can enable it in the <code class="literal">neutron.conf</code>
file.</p><p>Set these options to configure SSL:</p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.4.6.4.1"><span class="term ">
              <code class="literal">use_ssl = True</code>
            </span></dt><dd><p>Enables SSL on the networking API server.</p></dd><dt id="id-1.4.11.4.6.4.2"><span class="term ">
              <code class="literal">ssl_cert_file = PATH_TO_CERTFILE</code>
            </span></dt><dd><p>Certificate file that is used when you securely start the Networking
API server.</p></dd><dt id="id-1.4.11.4.6.4.3"><span class="term ">
              <code class="literal">ssl_key_file = PATH_TO_KEYFILE</code>
            </span></dt><dd><p>Private key file that is used when you securely start the Networking
API server.</p></dd><dt id="id-1.4.11.4.6.4.4"><span class="term ">
              <code class="literal">ssl_ca_file = PATH_TO_CAFILE</code>
            </span></dt><dd><p>Optional. CA certificate file that is used when you securely start
the Networking API server. This file verifies connecting clients.
Set this option when API clients must authenticate to the API server
by using SSL certificates that are signed by a trusted CA.</p></dd><dt id="id-1.4.11.4.6.4.5"><span class="term ">
              <code class="literal">tcp_keepidle = 600</code>
            </span></dt><dd><p>The value of TCP_KEEPIDLE, in seconds, for each server socket when
starting the API server. Not supported on OS X.</p></dd><dt id="id-1.4.11.4.6.4.6"><span class="term ">
              <code class="literal">retry_until_window = 30</code>
            </span></dt><dd><p>Number of seconds to keep retrying to listen.</p></dd><dt id="id-1.4.11.4.6.4.7"><span class="term ">
              <code class="literal">backlog = 4096</code>
            </span></dt><dd><p>Number of backlog requests with which to configure the socket.</p></dd></dl></div></div><div class="sect2 " id="id-1.4.11.4.7"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Load-Balancer-as-a-Service (LBaaS) overview</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.4.7">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Load-Balancer-as-a-Service (LBaaS) enables Networking to distribute
incoming requests evenly among designated instances. This distribution
ensures that the workload is shared predictably among instances and
enables more effective use of system resources. Use one of these load
balancing methods to distribute incoming requests:</p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.4.7.3.1"><span class="term ">Round robin</span></dt><dd><p>Rotates requests evenly between multiple instances.</p></dd><dt id="id-1.4.11.4.7.3.2"><span class="term ">Source IP</span></dt><dd><p>Requests from a unique source IP address are consistently directed
to the same instance.</p></dd><dt id="id-1.4.11.4.7.3.3"><span class="term ">Least connections</span></dt><dd><p>Allocates requests to the instance with the least number of active
connections.</p></dd></dl></div><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Feature</p>
                </th><th>
                  <p>Description</p>
                </th></tr></thead><tbody><tr><td>
                  <p>
                    <span class="bold"><strong>Monitors</strong></span>
                  </p>
                </td><td>
                  <p>LBaaS provides availability monitoring with the
<code class="literal">ping</code>, TCP, HTTP and HTTPS GET methods.
Monitors are implemented to determine whether
pool members are available to handle requests.</p>
                </td></tr><tr><td>
                  <p>
                    <span class="bold"><strong>Management</strong></span>
                  </p>
                </td><td>
                  <p>LBaaS is managed using a variety of tool sets.
The REST API is available for programmatic
administration and scripting. Users perform
administrative management of load balancers
through either the CLI (<code class="literal">neutron</code>) or the
OpenStack Dashboard.</p>
                </td></tr><tr><td>
                  <p>
                    <span class="bold"><strong>Connection limits</strong></span>
                  </p>
                </td><td>
                  <p>Ingress traffic can be shaped with <span class="emphasis"><em>connection
limits</em></span>. This feature allows workload control,
and can also assist with mitigating DoS (Denial
of Service) attacks.</p>
                </td></tr><tr><td>
                  <p>
                    <span class="bold"><strong>Session persistence</strong></span>
                  </p>
                </td><td>
                  <p>LBaaS supports session persistence by ensuring
incoming requests are routed to the same instance
within a pool of multiple instances. LBaaS
supports routing decisions based on cookies and
source IP address.</p>
                </td></tr></tbody></table></div></div><div class="sect2 " id="id-1.4.11.4.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.1.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Firewall-as-a-Service (FWaaS) overview</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.4.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>For information on Firewall-as-a-Service (FWaaS), please consult
        the <a class="link" href="http://docs.openstack.org/newton/networking-guide/fwaas.html" target="_blank">Networking
        Guide</a>. OpenSWAN packages are not present in SUSE Linux Enterprise Server 12 SP3.</p></div><div class="sect2 " id="id-1.4.11.4.9"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.1.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Allowed-address-pairs</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.4.9">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p><code class="literal">Allowed-address-pairs</code> enables you to specify
mac_address and ip_address(cidr) pairs that pass through a port regardless
of subnet. This enables the use of protocols such as VRRP, which floats
an IP address between two instances to enable fast data plane failover.</p><div id="id-1.4.11.4.9.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>Currently, only the ML2, Open vSwitch, and VMware NSX plug-ins
support the allowed-address-pairs extension.</p></div><p>
          <span class="bold"><strong>Basic allowed-address-pairs operations.</strong></span>
        </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Create a port with a specified allowed address pair:</p><div class="verbatim-wrap"><pre class="screen">$ neutron port-create net1 --allowed-address-pairs type=dict \
  list=true mac_address=MAC_ADDRESS,ip_address=IP_CIDR</pre></div></li><li class="listitem "><p>Update a port by adding allowed address pairs:</p><div class="verbatim-wrap"><pre class="screen">$ neutron port-update PORT_UUID --allowed-address-pairs type=dict \
list=true mac_address=MAC_ADDRESS,ip_address=IP_CIDR</pre></div></li></ul></div></div><div class="sect2 " id="id-1.4.11.4.10"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.1.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Virtual-Private-Network-as-a-Service (VPNaaS)</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.4.10">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The VPNaaS extension enables OpenStack projects to extend private networks
across the internet.</p><p>VPNaas is a <a class="xref" href="bk02go01.html#term-service" title="service">service</a>. It is a parent object that associates a VPN
with a specific subnet and router. Only one VPN service object can be
created for each router and each subnet. However, each VPN service object
can have any number of IP security connections.</p><p>The Internet Key Exchange (IKE) policy specifies the authentication and
encryption algorithms to use during phase one and two negotiation of a VPN
connection. The IP security policy specifies the authentication and encryption
algorithm and encapsulation mode to use for the established VPN connection.
Note that you cannot update the IKE and IPSec parameters for live tunnels.</p><p>You can set parameters for site-to-site IPsec connections, including peer
CIDRs, MTU, authentication mode, peer address, DPD settings, and status.</p><p>The current implementation of the VPNaaS extension provides:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Site-to-site VPN that connects two private networks.</p></li><li class="listitem "><p>Multiple VPN connections per project.</p></li><li class="listitem "><p>IKEv1 policy support with 3des, aes-128, aes-256, or aes-192 encryption.</p></li><li class="listitem "><p>IPSec policy support with 3des, aes-128, aes-192, or aes-256 encryption,
sha1 authentication, ESP, AH, or AH-ESP transform protocol, and tunnel or
transport mode encapsulation.</p></li><li class="listitem "><p>
            Dead Peer Detection (DPD) with hold, clear, restart, disabled, or
            restart-by-peer actions.
           </p><p>
             OpenSWAN packages are not present in SUSE Linux Enterprise Server 12 SP3.</p></li></ul></div><p>The VPNaaS driver plugin can be configured in the neutron configuration file.
You can then enable the service.</p></div></div><div class="sect1 " id="id-1.4.11.5"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Networking architecture</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.5">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Before you deploy Networking, it is useful to understand the Networking
services and how they interact with the OpenStack components.</p><div class="sect2 " id="id-1.4.11.5.3"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Overview</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.5.3">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Networking is a standalone component in the OpenStack modular
architecture. It is positioned alongside OpenStack components such as
Compute, Image service, Identity, or Dashboard. Like those
components, a deployment of Networking often involves deploying several
services to a variety of hosts.</p><p>The Networking server uses the neutron-server daemon to expose the
Networking API and enable administration of the configured Networking
plug-in. Typically, the plug-in requires access to a database for
persistent storage (also similar to other OpenStack services).</p><p>If your deployment uses a controller host to run centralized Compute
components, you can deploy the Networking server to that same host.
However, Networking is entirely standalone and can be deployed to a
dedicated host. Depending on your configuration, Networking can also
include the following agents:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Agent</p>
                </th><th>
                  <p>Description</p>
                </th></tr></thead><tbody><tr><td>
                  <p><span class="bold"><strong>plug-in agent</strong></span>
(<code class="literal">neutron-*-agent</code>)</p>
                </td><td>
                  <p>Runs on each hypervisor to perform
local vSwitch configuration. The agent that
runs, depends on the plug-in that you use.
Certain plug-ins do not require an agent.</p>
                </td></tr><tr><td>
                  <p><span class="bold"><strong>dhcp agent</strong></span>
(<code class="literal">neutron-dhcp-agent</code>)</p>
                </td><td>
                  <p>Provides DHCP services to project networks.
Required by certain plug-ins.</p>
                </td></tr><tr><td>
                  <p><span class="bold"><strong>l3 agent</strong></span>
(<code class="literal">neutron-l3-agent</code>)</p>
                </td><td>
                  <p>Provides L3/NAT forwarding to provide
external network access for VMs on project
networks. Required by certain plug-ins.</p>
                </td></tr><tr><td>
                  <p><span class="bold"><strong>metering agent</strong></span>
(<code class="literal">neutron-metering-agent</code>)</p>
                </td><td>
                  <p>Provides L3 traffic metering for project
networks.</p>
                </td></tr></tbody></table></div><p>These agents interact with the main neutron process through RPC (for
example, RabbitMQ or Qpid) or through the standard Networking API. In
addition, Networking integrates with OpenStack components in a number of
ways:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Networking relies on the Identity service (keystone) for the
authentication and authorization of all API requests.</p></li><li class="listitem "><p>Compute (nova) interacts with Networking through calls to its
standard API. As part of creating a VM, the <code class="literal">nova-compute</code> service
communicates with the Networking API to plug each virtual NIC on the
VM into a particular network.</p></li><li class="listitem "><p>The dashboard (horizon) integrates with the Networking API, enabling
administrators and project users to create and manage network services
through a web-based GUI.</p></li></ul></div></div><div class="sect2 " id="id-1.4.11.5.4"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">VMware NSX integration</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.5.4">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>OpenStack Networking uses the NSX plug-in to integrate with an existing
VMware vCenter deployment. When installed on the network nodes, the NSX
plug-in enables a NSX controller to centrally manage configuration
settings and push them to managed network nodes. Network nodes are
considered managed when they are added as hypervisors to the NSX
controller.</p><p>The diagrams below depict some VMware NSX deployment examples. The first
diagram illustrates the traffic flow between VMs on separate Compute
nodes, and the second diagram between two VMs on a single compute node.
Note the placement of the VMware NSX plug-in and the neutron-server
service on the network node. The green arrow indicates the management
relationship between the NSX controller and the network node.</p><div class="figure" id="id-1.4.11.5.4.4"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/vmware_nsx_ex1.png" target="_blank"><img src="images/vmware_nsx_ex1.png" width="" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 9.1: </span><span class="name"> </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.5.4.4">#</a></h6></div></div><div class="figure" id="id-1.4.11.5.4.5"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/vmware_nsx_ex2.png" target="_blank"><img src="images/vmware_nsx_ex2.png" width="" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 9.2: </span><span class="name"> </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.5.4.5">#</a></h6></div></div></div></div><div class="sect1 " id="id-1.4.11.6"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Plug-in configurations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.6">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>For configurations options, see <a class="link" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html" target="_blank">Networking configuration
options</a>
in Configuration Reference. These sections explain how to configure
specific plug-ins.</p><div class="sect2 " id="id-1.4.11.6.3"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure Big Switch (Floodlight REST Proxy) plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.6.3">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Edit the <code class="literal">/etc/neutron/neutron.conf</code> file and add this line:</p><div class="verbatim-wrap highlight ini"><pre class="screen">core_plugin = bigswitch</pre></div></li><li class="step "><p>In the <code class="literal">/etc/neutron/neutron.conf</code> file, set the <code class="literal">service_plugins</code>
option:</p><div class="verbatim-wrap highlight ini"><pre class="screen">service_plugins = neutron.plugins.bigswitch.l3_router_plugin.L3RestProxy</pre></div></li><li class="step "><p>Edit the <code class="literal">/etc/neutron/plugins/bigswitch/restproxy.ini</code> file for the
plug-in and specify a comma-separated list of controller_ip:port pairs:</p><div class="verbatim-wrap highlight ini"><pre class="screen">server = CONTROLLER_IP:PORT</pre></div><p>For database configuration, see <a class="link" href="http://docs.openstack.org/newton/install-guide-ubuntu/neutron-controller-install.html" target="_blank">Install Networking
Services</a>
in the Installation Tutorials and Guides. (The link defaults to the Ubuntu
version.)</p></li><li class="step "><p>Restart the <code class="literal">neutron-server</code> to apply the settings:</p><div class="verbatim-wrap"><pre class="screen"># service neutron-server restart</pre></div></li></ol></div></div></div><div class="sect2 " id="id-1.4.11.6.4"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.3.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure Brocade plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.6.4">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Install the Brocade-modified Python netconf client (ncclient) library,
which is available at <a class="link" href="https://github.com/brocade/ncclient" target="_blank">https://github.com/brocade/ncclient</a>:</p><div class="verbatim-wrap"><pre class="screen">$ git clone https://github.com/brocade/ncclient</pre></div></li><li class="step "><p>As root, run this command:</p><div class="verbatim-wrap"><pre class="screen"># cd ncclient;python setup.py install</pre></div></li><li class="step "><p>Edit the <code class="literal">/etc/neutron/neutron.conf</code> file and set the following
option:</p><div class="verbatim-wrap highlight ini"><pre class="screen">core_plugin = brocade</pre></div></li><li class="step "><p>Edit the <code class="literal">/etc/neutron/plugins/brocade/brocade.ini</code> file for the
Brocade plug-in and specify the admin user name, password, and IP
address of the Brocade switch:</p><div class="verbatim-wrap highlight ini"><pre class="screen">[SWITCH]
username = ADMIN
password = PASSWORD
address  = SWITCH_MGMT_IP_ADDRESS
ostype   = NOS</pre></div><p>For database configuration, see <a class="link" href="http://docs.openstack.org/newton/install-guide-ubuntu/neutron-controller-install.html" target="_blank">Install Networking
Services</a>
in any of the Installation Tutorials and Guides in the <a class="link" href="http://docs.openstack.org" target="_blank">OpenStack Documentation
index</a>. (The link defaults to the Ubuntu
version.)</p></li><li class="step "><p>Restart the <code class="literal">neutron-server</code> service to apply the settings:</p><div class="verbatim-wrap"><pre class="screen"># service neutron-server restart</pre></div></li></ol></div></div></div><div class="sect2 " id="id-1.4.11.6.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.3.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure NSX-mh plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.6.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The instructions in this section refer to the VMware NSX-mh platform,
formerly known as Nicira NVP.</p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Install the NSX plug-in:</p><div class="verbatim-wrap"><pre class="screen"># apt-get install neutron-plugin-vmware</pre></div></li><li class="step "><p>Edit the <code class="literal">/etc/neutron/neutron.conf</code> file and set this line:</p><div class="verbatim-wrap highlight ini"><pre class="screen">core_plugin = vmware</pre></div><p>Example <code class="literal">neutron.conf</code> file for NSX-mh integration:</p><div class="verbatim-wrap highlight ini"><pre class="screen">core_plugin = vmware
rabbit_host = 192.168.203.10
allow_overlapping_ips = True</pre></div></li><li class="step "><p>To configure the NSX-mh controller cluster for OpenStack Networking,
locate the <code class="literal">[default]</code> section in the
<code class="literal">/etc/neutron/plugins/vmware/nsx.ini</code> file and add the following
entries:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>To establish and configure the connection with the controller cluster
you must set some parameters, including NSX-mh API endpoints, access
credentials, and optionally specify settings for HTTP timeouts,
redirects and retries in case of connection failures:</p><div class="verbatim-wrap highlight ini"><pre class="screen">nsx_user = ADMIN_USER_NAME
nsx_password = NSX_USER_PASSWORD
http_timeout = HTTP_REQUEST_TIMEOUT # (seconds) default 75 seconds
retries = HTTP_REQUEST_RETRIES # default 2
redirects = HTTP_REQUEST_MAX_REDIRECTS # default 2
nsx_controllers = API_ENDPOINT_LIST # comma-separated list</pre></div><p>To ensure correct operations, the <code class="literal">nsx_user</code> user must have
administrator credentials on the NSX-mh platform.</p><p>A controller API endpoint consists of the IP address and port for the
controller; if you omit the port, port 443 is used. If multiple API
endpoints are specified, it is up to the user to ensure that all
these endpoints belong to the same controller cluster. The OpenStack
Networking VMware NSX-mh plug-in does not perform this check, and
results might be unpredictable.</p><p>When you specify multiple API endpoints, the plug-in takes care of
load balancing requests on the various API endpoints.</p></li><li class="listitem "><p>The UUID of the NSX-mh transport zone that should be used by default
when a project creates a network. You can get this value from the
Transport Zones page for the NSX-mh manager:</p><p>Alternatively the transport zone identifier can be retrieved by query
the NSX-mh API: <code class="literal">/ws.v1/transport-zone</code></p><div class="verbatim-wrap highlight ini"><pre class="screen">default_tz_uuid = TRANSPORT_ZONE_UUID</pre></div></li><li class="listitem "><div class="verbatim-wrap highlight ini"><pre class="screen">default_l3_gw_service_uuid = GATEWAY_SERVICE_UUID</pre></div><div id="id-1.4.11.6.5.3.3.2.3.2" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg" /><h6>Warning</h6><p>Ubuntu packaging currently does not update the neutron init
script to point to the NSX-mh configuration file. Instead, you
must manually update <code class="literal">/etc/default/neutron-server</code> to add this
line:</p><div class="verbatim-wrap highlight ini"><pre class="screen">NEUTRON_PLUGIN_CONFIG = /etc/neutron/plugins/vmware/nsx.ini</pre></div></div><p>For database configuration, see <a class="link" href="http://docs.openstack.org/newton/install-guide-ubuntu/neutron-controller-install.html" target="_blank">Install Networking
Services</a>
in the Installation Tutorials and Guides.</p></li></ul></div></li><li class="step "><p>Restart <code class="literal">neutron-server</code> to apply settings:</p><div class="verbatim-wrap"><pre class="screen"># service neutron-server restart</pre></div><div id="id-1.4.11.6.5.3.4.3" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg" /><h6>Warning</h6><p>The neutron NSX-mh plug-in does not implement initial
re-synchronization of Neutron resources. Therefore resources that
might already exist in the database when Neutron is switched to the
NSX-mh plug-in will not be created on the NSX-mh backend upon
restart.</p></div></li></ol></div></div><p>Example <code class="literal">nsx.ini</code> file:</p><div class="verbatim-wrap highlight ini"><pre class="screen">[DEFAULT]
default_tz_uuid = d3afb164-b263-4aaa-a3e4-48e0e09bb33c
default_l3_gw_service_uuid=5c8622cc-240a-40a1-9693-e6a5fca4e3cf
nsx_user=admin
nsx_password=changeme
nsx_controllers=10.127.0.100,10.127.0.200:8888</pre></div><div id="id-1.4.11.6.5.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>To debug <code class="literal">nsx.ini</code> configuration issues, run this command from the
host that runs neutron-server:</p></div><div class="verbatim-wrap"><pre class="screen"># neutron-check-nsx-config PATH_TO_NSX.INI</pre></div><p>This command tests whether <code class="literal">neutron-server</code> can log into all of the
NSX-mh controllers and the SQL server, and whether all UUID values
are correct.</p></div><div class="sect2 " id="id-1.4.11.6.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.3.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure PLUMgrid plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.6.6">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Edit the <code class="literal">/etc/neutron/neutron.conf</code> file and set this line:</p><div class="verbatim-wrap highlight ini"><pre class="screen">core_plugin = plumgrid</pre></div></li><li class="step "><p>Edit the [PLUMgridDirector] section in the
<code class="literal">/etc/neutron/plugins/plumgrid/plumgrid.ini</code> file and specify the IP
address, port, admin user name, and password of the PLUMgrid Director:</p><div class="verbatim-wrap highlight ini"><pre class="screen">[PLUMgridDirector]
director_server = "PLUMgrid-director-ip-address"
director_server_port = "PLUMgrid-director-port"
username = "PLUMgrid-director-admin-username"
password = "PLUMgrid-director-admin-password"</pre></div><p>For database configuration, see <a class="link" href="http://docs.openstack.org/newton/install-guide-ubuntu/neutron-controller-install.html" target="_blank">Install Networking
Services</a>
in the Installation Tutorials and Guides.</p></li><li class="step "><p>Restart the <code class="literal">neutron-server</code> service to apply the settings:</p><div class="verbatim-wrap"><pre class="screen"># service neutron-server restart</pre></div></li></ol></div></div></div></div><div class="sect1 " id="id-1.4.11.7"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure neutron agents</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Plug-ins typically have requirements for particular software that must
be run on each node that handles data packets. This includes any node
that runs nova-compute and nodes that run dedicated OpenStack Networking
service agents such as <code class="literal">neutron-dhcp-agent</code>, <code class="literal">neutron-l3-agent</code>,
<code class="literal">neutron-metering-agent</code> or <code class="literal">neutron-lbaasv2-agent</code>.</p><p>A data-forwarding node typically has a network interface with an IP
address on the management network and another interface on the data
network.</p><p>This section shows you how to install and configure a subset of the
available plug-ins, which might include the installation of switching
software (for example, <code class="literal">Open vSwitch</code>) and as agents used to communicate
with the <code class="literal">neutron-server</code> process running elsewhere in the data center.</p><div class="sect2 " id="id-1.4.11.7.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.4.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure data-forwarding nodes</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect3 " id="id-1.4.11.7.5.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.4.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Node set up: NSX plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.5.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>If you use the NSX plug-in, you must also install Open vSwitch on each
data-forwarding node. However, you do not need to install an additional
agent on each node.</p><div id="id-1.4.11.7.5.2.3" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg" /><h6>Warning</h6><p>It is critical that you run an Open vSwitch version that is
compatible with the current version of the NSX Controller software.
Do not use the Open vSwitch version that is installed by default on
Ubuntu. Instead, use the Open vSwitch version that is provided on
the VMware support portal for your NSX Controller version.</p></div><p>
            <span class="bold"><strong>To set up each node for the NSX plug-in</strong></span>
          </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Ensure that each data-forwarding node has an IP address on the
management network, and an IP address on the data network that is used
for tunneling data traffic. For full details on configuring your
forwarding node, see the <a class="link" href="http://pubs.vmware.com/NSX-62/index.jsp#com.vmware.nsx.admin.doc/GUID-B5C70003-8194-4EC3-AB36-54C848508818.html" target="_blank">NSX Administration Guide</a>.</p></li><li class="step "><p>Use the NSX Administrator Guide to add the node as a Hypervisor
by using the NSX Manager GUI. Even if your forwarding node has no
VMs and is only used for services agents like <code class="literal">neutron-dhcp-agent</code>
or <code class="literal">neutron-lbaas-agent</code>, it should still be added to NSX as a
Hypervisor.</p></li><li class="step "><p>After following the NSX Administrator Guide, use the page for this
Hypervisor in the NSX Manager GUI to confirm that the node is properly
connected to the NSX Controller Cluster and that the NSX Controller
Cluster can see the <code class="literal">br-int</code> integration bridge.</p></li></ol></div></div></div></div><div class="sect2 " id="id-1.4.11.7.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.4.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure DHCP agent</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.6">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The DHCP service agent is compatible with all existing plug-ins and is
required for all deployments where VMs should automatically receive IP
addresses through DHCP.</p><p>
          <span class="bold"><strong>To install and configure the DHCP agent</strong></span>
        </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>You must configure the host running the neutron-dhcp-agent as a data
forwarding node according to the requirements for your plug-in.</p></li><li class="step "><p>Install the DHCP agent:</p><div class="verbatim-wrap"><pre class="screen"># apt-get install neutron-dhcp-agent</pre></div></li><li class="step "><p>Update any options in the <code class="literal">/etc/neutron/dhcp_agent.ini</code> file
that depend on the plug-in in use. See the sub-sections.</p><div id="id-1.4.11.7.6.4.3.2" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important</h6><p>If you reboot a node that runs the DHCP agent, you must run the
<code class="command">neutron-ovs-cleanup</code> command before the <code class="literal">neutron-dhcp-agent</code>
service starts.</p><p>On Red Hat, SUSE, and Ubuntu based systems, the
<code class="literal">neutron-ovs-cleanup</code> service runs the <code class="command">neutron-ovs-cleanup</code>
command automatically. However, on Debian-based systems, you
must manually run this command or write your own system script
that runs on boot before the <code class="literal">neutron-dhcp-agent</code> service starts.</p></div></li></ol></div></div><p>Networking dhcp-agent can use
<a class="link" href="http://www.thekelleys.org.uk/dnsmasq/doc.html" target="_blank">dnsmasq</a> driver which
supports stateful and stateless DHCPv6 for subnets created with
<code class="literal">--ipv6_address_mode</code> set to <code class="literal">dhcpv6-stateful</code> or
<code class="literal">dhcpv6-stateless</code>.</p><p>For example:</p><div class="verbatim-wrap"><pre class="screen">$ openstack subnet create --ip-version 6 --ipv6-ra-mode dhcpv6-stateful \
  --ipv6-address-mode dhcpv6-stateful --network NETWORK --subnet-range \
  CIDR SUBNET_NAME</pre></div><div class="verbatim-wrap"><pre class="screen">$ openstack subnet create --ip-version 6 --ipv6-ra-mode dhcpv6-stateless \
  --ipv6-address-mode dhcpv6-stateless --network NETWORK --subnet-range \
  CIDR SUBNET_NAME</pre></div><p>If no dnsmasq process for subnet's network is launched, Networking will
launch a new one on subnet's dhcp port in <code class="literal">qdhcp-XXX</code> namespace. If
previous dnsmasq process is already launched, restart dnsmasq with a new
configuration.</p><p>Networking will update dnsmasq process and restart it when subnet gets
updated.</p><div id="id-1.4.11.7.6.11" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>For dhcp-agent to operate in IPv6 mode use at least dnsmasq v2.63.</p></div><p>After a certain, configured timeframe, networks uncouple from DHCP
agents when the agents are no longer in use. You can configure the DHCP
agent to automatically detach from a network when the agent is out of
service, or no longer needed.</p><p>This feature applies to all plug-ins that support DHCP scaling. For more
information, see the <a class="link" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#dhcp-agent" target="_blank">DHCP agent configuration
options</a>
listed in the OpenStack Configuration Reference.</p><div class="sect3 " id="id-1.4.11.7.6.14"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.4.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">DHCP agent setup: OVS plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.6.14">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>These DHCP agent options are required in the
<code class="literal">/etc/neutron/dhcp_agent.ini</code> file for the OVS plug-in:</p><div class="verbatim-wrap highlight bash"><pre class="screen">[DEFAULT]
enable_isolated_metadata = True
interface_driver = openvswitch</pre></div></div><div class="sect3 " id="id-1.4.11.7.6.15"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.4.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">DHCP agent setup: NSX plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.6.15">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>These DHCP agent options are required in the
<code class="literal">/etc/neutron/dhcp_agent.ini</code> file for the NSX plug-in:</p><div class="verbatim-wrap highlight bash"><pre class="screen">[DEFAULT]
enable_metadata_network = True
enable_isolated_metadata = True
interface_driver = openvswitch</pre></div></div><div class="sect3 " id="id-1.4.11.7.6.16"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.4.2.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">DHCP agent setup: Linux-bridge plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.6.16">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>These DHCP agent options are required in the
<code class="literal">/etc/neutron/dhcp_agent.ini</code> file for the Linux-bridge plug-in:</p><div class="verbatim-wrap highlight bash"><pre class="screen">[DEFAULT]
enabled_isolated_metadata = True
interface_driver = linuxbridge</pre></div></div></div><div class="sect2 " id="id-1.4.11.7.7"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.4.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure L3 agent</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.7">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The OpenStack Networking service has a widely used API extension to
allow administrators and projects to create routers to interconnect L2
networks, and floating IPs to make ports on private networks publicly
accessible.</p><p>Many plug-ins rely on the L3 service agent to implement the L3
functionality. However, the following plug-ins already have built-in L3
capabilities:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Big Switch/Floodlight plug-in, which supports both the open source
<a class="link" href="http://www.projectfloodlight.org/floodlight/" target="_blank">Floodlight</a>
controller and the proprietary Big Switch controller.</p><div id="id-1.4.11.7.7.4.1.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>Only the proprietary BigSwitch controller implements L3
functionality. When using Floodlight as your OpenFlow controller,
L3 functionality is not available.</p></div></li><li class="listitem "><p>IBM SDN-VE plug-in</p></li><li class="listitem "><p>MidoNet plug-in</p></li><li class="listitem "><p>NSX plug-in</p></li><li class="listitem "><p>PLUMgrid plug-in</p></li></ul></div><div id="id-1.4.11.7.7.5" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg" /><h6>Warning</h6><p>Do not configure or use <code class="literal">neutron-l3-agent</code> if you use one of these
plug-ins.</p></div><p>
          <span class="bold"><strong>To install the L3 agent for all other plug-ins</strong></span>
        </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Install the <code class="literal">neutron-l3-agent</code> binary on the network node:</p><div class="verbatim-wrap"><pre class="screen"># apt-get install neutron-l3-agent</pre></div></li><li class="step "><p>To uplink the node that runs <code class="literal">neutron-l3-agent</code> to the external network,
create a bridge named <code class="literal">br-ex</code> and attach the NIC for the external
network to this bridge.</p><p>For example, with Open vSwitch and NIC eth1 connected to the external
network, run:</p><div class="verbatim-wrap"><pre class="screen"># ovs-vsctl add-br br-ex
# ovs-vsctl add-port br-ex eth1</pre></div><p>When the <code class="literal">br-ex</code> port is added to the <code class="literal">eth1</code> interface, external
communication is interrupted. To avoid this, edit the
<code class="literal">/etc/network/interfaces</code> file to contain the following information:</p><div class="verbatim-wrap highlight ini"><pre class="screen">## External bridge
auto br-ex
iface br-ex inet static
address 192.27.117.101
netmask 255.255.240.0
gateway 192.27.127.254
dns-nameservers 8.8.8.8

## External network interface
auto eth1
iface eth1 inet manual
up ifconfig $IFACE 0.0.0.0 up
up ip link set $IFACE promisc on
down ip link set $IFACE promisc off
down ifconfig $IFACE down</pre></div><div id="id-1.4.11.7.7.7.2.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>The external bridge configuration address is the external IP address.
This address and gateway should be configured in
<code class="literal">/etc/network/interfaces</code>.</p></div><p>After editing the configuration, restart <code class="literal">br-ex</code>:</p><div class="verbatim-wrap"><pre class="screen"># ifdown br-ex &amp;&amp; ifup br-ex</pre></div><p>Do not manually configure an IP address on the NIC connected to the
external network for the node running <code class="literal">neutron-l3-agent</code>. Rather, you
must have a range of IP addresses from the external network that can be
used by OpenStack Networking for routers that uplink to the external
network. This range must be large enough to have an IP address for each
router in the deployment, as well as each floating IP.</p></li><li class="step "><p>The <code class="literal">neutron-l3-agent</code> uses the Linux IP stack and iptables to perform L3
forwarding and NAT. In order to support multiple routers with
potentially overlapping IP addresses, <code class="literal">neutron-l3-agent</code> defaults to
using Linux network namespaces to provide isolated forwarding contexts.
As a result, the IP addresses of routers are not visible simply by running
the <code class="command">ip addr list</code> or <code class="command">ifconfig</code> command on the node.
Similarly, you cannot directly <code class="command">ping</code> fixed IPs.</p><p>To do either of these things, you must run the command within a
particular network namespace for the router. The namespace has the name
<code class="literal">qrouter-ROUTER_UUID</code>. These example commands run in the router
namespace with UUID 47af3868-0fa8-4447-85f6-1304de32153b:</p><div class="verbatim-wrap"><pre class="screen"># ip netns exec qrouter-47af3868-0fa8-4447-85f6-1304de32153b ip addr list</pre></div><div class="verbatim-wrap"><pre class="screen"># ip netns exec qrouter-47af3868-0fa8-4447-85f6-1304de32153b ping FIXED_IP</pre></div><div id="id-1.4.11.7.7.7.3.5" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important</h6><p>If you reboot a node that runs the L3 agent, you must run the
<code class="command">neutron-ovs-cleanup</code> command before the <code class="literal">neutron-l3-agent</code>
service starts.</p><p>On Red Hat, SUSE and Ubuntu based systems, the neutron-ovs-cleanup
service runs the <code class="command">neutron-ovs-cleanup</code> command
automatically. However, on Debian-based systems, you must manually
run this command or write your own system script that runs on boot
before the neutron-l3-agent service starts.</p></div></li></ol></div></div><p><span class="bold"><strong>How routers are assigned to L3 agents</strong></span>
By default, a router is assigned to the L3 agent with the least number
of routers (LeastRoutersScheduler). This can be changed by altering the
<code class="literal">router_scheduler_driver</code> setting in the configuration file.</p></div><div class="sect2 " id="id-1.4.11.7.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.4.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure metering agent</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The Neutron Metering agent resides beside neutron-l3-agent.</p><p>
          <span class="bold"><strong>To install the metering agent and configure the node</strong></span>
        </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Install the agent by running:</p><div class="verbatim-wrap"><pre class="screen"># apt-get install neutron-metering-agent</pre></div></li><li class="step "><p>If you use one of the following plug-ins, you need to configure the
metering agent with these lines as well:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>An OVS-based plug-in such as OVS, NSX, NEC, BigSwitch/Floodlight:</p><div class="verbatim-wrap highlight ini"><pre class="screen">interface_driver = openvswitch</pre></div></li><li class="listitem "><p>A plug-in that uses LinuxBridge:</p><div class="verbatim-wrap highlight ini"><pre class="screen">interface_driver = linuxbridge</pre></div></li></ul></div></li><li class="step "><p>To use the reference implementation, you must set:</p><div class="verbatim-wrap highlight ini"><pre class="screen">driver = neutron.services.metering.drivers.iptables.iptables_driver
.IptablesMeteringDriver</pre></div></li><li class="step "><p>Set the <code class="literal">service_plugins</code> option in the <code class="literal">/etc/neutron/neutron.conf</code>
file on the host that runs <code class="literal">neutron-server</code>:</p><div class="verbatim-wrap highlight ini"><pre class="screen">service_plugins = metering</pre></div><p>If this option is already defined, add <code class="literal">metering</code> to the list, using a
comma as separator. For example:</p><div class="verbatim-wrap highlight ini"><pre class="screen">service_plugins = router,metering</pre></div></li></ol></div></div></div><div class="sect2 " id="id-1.4.11.7.9"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.4.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure Load-Balancer-as-a-Service (LBaaS v2)</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.9">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>For the back end, use either <a class="xref" href="bk02go01.html#term-octavia" title="Octavia">Octavia</a> or <a class="xref" href="bk02go01.html#term-haproxy" title="HAProxy">HAProxy</a>.
This example uses Octavia.</p><p>
          <span class="bold"><strong>To configure LBaaS V2</strong></span>
        </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Install Octavia using your distribution's package manager.</p></li><li class="step "><p>Edit the <code class="literal">/etc/neutron/neutron_lbaas.conf</code> file and change
the <code class="literal">service_provider</code> parameter to enable Octavia:</p><div class="verbatim-wrap highlight ini"><pre class="screen">service_provider = LOADBALANCERV2:Octavia:neutron_lbaas.
drivers.octavia.driver.OctaviaDriver:default</pre></div></li><li class="step "><p>Edit the <code class="literal">/etc/neutron/neutron.conf</code> file and add the
<code class="literal">service_plugins</code> parameter to enable the load-balancing plug-in:</p><div class="verbatim-wrap highlight ini"><pre class="screen">service_plugins = neutron_lbaas.services.loadbalancer.plugin.LoadBalancerPluginv2</pre></div><p>If this option is already defined, add the load-balancing plug-in to
the list using a comma as a separator. For example:</p><div class="verbatim-wrap highlight ini"><pre class="screen">service_plugins = [already defined plugins],neutron_lbaas.services.loadbalancer.plugin.LoadBalancerPluginv2</pre></div></li><li class="step "><p>Create the required tables in the database:</p><div class="verbatim-wrap"><pre class="screen"># neutron-db-manage --subproject neutron-lbaas upgrade head</pre></div></li><li class="step "><p>Restart the <code class="literal">neutron-server</code> service.</p></li><li class="step "><p>Enable load balancing in the Project section of the dashboard.</p><div id="id-1.4.11.7.9.4.6.2" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg" /><h6>Warning</h6><p>Horizon panels are enabled only for LBaaSV1. LBaaSV2 panels are still
being developed.</p></div><p>By default, the <code class="literal">enable_lb</code> option is <code class="literal">True</code> in the <code class="literal">local_settings.py</code>
file.</p><div class="verbatim-wrap highlight python"><pre class="screen">OPENSTACK_NEUTRON_NETWORK = {
    'enable_lb': True,
    ...
}</pre></div><p>Apply the settings by restarting the web server. You can now view the
Load Balancer management options in the Project view in the dashboard.</p></li></ol></div></div></div><div class="sect2 " id="id-1.4.11.7.10"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.4.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic operations on agents</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.7.10">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This table shows examples of Networking commands that enable you to
complete basic operations on agents.</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Operation</p>
                </th><th>
                  <p>Command</p>
                </th></tr></thead><tbody><tr><td>
                  <p>List all available agents.</p>
                </td><td>
                  <p>
                    <code class="literal">$ openstack network agent list</code>
                  </p>
                </td></tr><tr><td>
                  <p>Show information of a given agent.</p>
                </td><td>
                  <p>
                    <code class="literal">$ openstack network agent show AGENT_ID</code>
                  </p>
                </td></tr><tr><td>
                  <p>Update the admin status and description for a specified agent. The
command can be used to enable and disable agents by using
<code class="literal">--admin-state-up</code> parameter set to <code class="literal">False</code> or <code class="literal">True</code>.</p>
                </td><td>
                  <p>
                    <code class="literal">$ neutron agent-update --admin-state-up False AGENT_ID</code>
                  </p>
                </td></tr><tr><td>
                  <p>Delete a given agent. Consider disabling the agent before deletion.</p>
                </td><td>
                  <p>
                    <code class="literal">$ openstack network agent delete AGENT_ID</code>
                  </p>
                </td></tr></tbody></table></div><p>
          <span class="bold"><strong>Basic operations on Networking agents</strong></span>
        </p><p>See the <a class="link" href="http://docs.openstack.org/cli-reference/neutron.html" target="_blank">OpenStack Command-Line Interface
Reference</a>
for more information on Networking commands.</p></div></div><div class="sect1 " id="id-1.4.11.8"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure Identity service for Networking</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.8">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
        <span class="bold"><strong>To configure the Identity service for use with Networking</strong></span>
      </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Create the <code class="literal">get_id()</code> function</p><p>The <code class="literal">get_id()</code> function stores the ID of created objects, and removes
the need to copy and paste object IDs in later steps:</p><ol type="a" class="substeps "><li class="step "><p>Add the following function to your <code class="literal">.bashrc</code> file:</p><div class="verbatim-wrap highlight ini"><pre class="screen">function get_id () {
echo `"$@" | awk '/ id / { print $4 }'`
}</pre></div></li><li class="step "><p>Source the <code class="literal">.bashrc</code> file:</p><div class="verbatim-wrap"><pre class="screen">$ source .bashrc</pre></div></li></ol></li><li class="step "><p>Create the Networking service entry</p><p>Networking must be available in the Compute service catalog. Create the
service:</p><div class="verbatim-wrap"><pre class="screen">$ NEUTRON_SERVICE_ID=$(get_id openstack service create network \
  --name neutron --description 'OpenStack Networking Service')</pre></div></li><li class="step "><p>Create the Networking service endpoint entry</p><div id="id-1.4.11.8.3.3.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>
           Cloud 8 does not support multiple regions, so for the
           following steps you should use the default
           <code class="literal">RegionOne</code> region.
          </p></div><p>The way that you create a Networking endpoint entry depends on whether
you are using the SQL or the template catalog driver:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>If you are using the <code class="literal">SQL driver</code>, run the following command with the
specified region (<code class="literal">$REGION</code>), IP address of the Networking server
(<code class="literal">$IP</code>), and service ID (<code class="literal">$NEUTRON_SERVICE_ID</code>, obtained in the
previous step).</p><div class="verbatim-wrap"><pre class="screen">$ openstack endpoint create $NEUTRON_SERVICE_ID --region $REGION \
  --publicurl 'http://$IP:9696/' --adminurl 'http://$IP:9696/' \
  --internalurl 'http://$IP:9696/'</pre></div><p>For example:</p><div class="verbatim-wrap"><pre class="screen">$ openstack endpoint create $NEUTRON_SERVICE_ID --region myregion \
  --publicurl "http://10.211.55.17:9696/" \
  --adminurl "http://10.211.55.17:9696/" \
  --internalurl "http://10.211.55.17:9696/"</pre></div></li><li class="listitem "><p>If you are using the <code class="literal">template driver</code>, specify the following
parameters in your Compute catalog template file
(<code class="literal">default_catalog.templates</code>), along with the region (<code class="literal">$REGION</code>)
and IP address of the Networking server (<code class="literal">$IP</code>).</p><div class="verbatim-wrap highlight bash"><pre class="screen">catalog.$REGION.network.publicURL = http://$IP:9696
catalog.$REGION.network.adminURL = http://$IP:9696
catalog.$REGION.network.internalURL = http://$IP:9696
catalog.$REGION.network.name = Network Service</pre></div><p>For example:</p><div class="verbatim-wrap highlight bash"><pre class="screen">catalog.$Region.network.publicURL = http://10.211.55.17:9696
catalog.$Region.network.adminURL = http://10.211.55.17:9696
catalog.$Region.network.internalURL = http://10.211.55.17:9696
catalog.$Region.network.name = Network Service</pre></div></li></ul></div></li><li class="step "><p>Create the Networking service user</p><p>You must provide admin user credentials that Compute and some internal
Networking components can use to access the Networking API. Create a
special <code class="literal">service</code> project and a <code class="literal">neutron</code> user within this project,
and assign an <code class="literal">admin</code> role to this role.</p><ol type="a" class="substeps "><li class="step "><p>Create the <code class="literal">admin</code> role:</p><div class="verbatim-wrap"><pre class="screen">$ ADMIN_ROLE=$(get_id openstack role create admin)</pre></div></li><li class="step "><p>Create the <code class="literal">neutron</code> user:</p><div class="verbatim-wrap"><pre class="screen">$ NEUTRON_USER=$(get_id openstack user create neutron \
  --password "$NEUTRON_PASSWORD" --email demo@example.com \
  --project service)</pre></div></li><li class="step "><p>Create the <code class="literal">service</code> project:</p><div class="verbatim-wrap"><pre class="screen">$ SERVICE_TENANT=$(get_id openstack project create service \
  --description "Services project" --domain default)</pre></div></li><li class="step "><p>Establish the relationship among the project, user, and role:</p><div class="verbatim-wrap"><pre class="screen">$ openstack role add $ADMIN_ROLE --user $NEUTRON_USER \
  --project $SERVICE_TENANT</pre></div></li></ol></li></ol></div></div><p>For information about how to create service entries and users, see the <a class="link" href="http://docs.openstack.org/project-install-guide/newton/" target="_blank">Newton Installation
Tutorials and Guides</a>
for your distribution.</p><div class="sect2 " id="id-1.4.11.8.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.5.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Compute</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.8.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>If you use Networking, do not run the Compute <code class="literal">nova-network</code> service (like
you do in traditional Compute deployments). Instead, Compute delegates
most network-related decisions to Networking.</p><div id="id-1.4.11.8.5.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>Uninstall <code class="literal">nova-network</code> and reboot any physical nodes that have been
running <code class="literal">nova-network</code> before using them to run Networking.
Inadvertently running the <code class="literal">nova-network</code> process while using
Networking can cause problems, as can stale iptables rules pushed
down by previously running <code class="literal">nova-network</code>.</p></div><p>Compute proxies project-facing API calls to manage security groups and
floating IPs to Networking APIs. However, operator-facing tools such
as <code class="literal">nova-manage</code>, are not proxied and should not be used.</p><div id="id-1.4.11.8.5.5" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg" /><h6>Warning</h6><p>When you configure networking, you must use this guide. Do not rely
on Compute networking documentation or past experience with Compute.
If a <code class="command">nova</code> command or configuration option related to networking
is not mentioned in this guide, the command is probably not
supported for use with Networking. In particular, you cannot use CLI
tools like <code class="literal">nova-manage</code> and <code class="literal">nova</code> to manage networks or IP
addressing, including both fixed and floating IPs, with Networking.</p></div><p>To ensure that Compute works properly with Networking (rather than the
legacy <code class="literal">nova-network</code> mechanism), you must adjust settings in the
<code class="literal">nova.conf</code> configuration file.</p></div><div class="sect2 " id="id-1.4.11.8.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.5.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Networking API and credential configuration</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.8.6">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Each time you provision or de-provision a VM in Compute, <code class="literal">nova-\*</code>
services communicate with Networking using the standard API. For this to
happen, you must configure the following items in the <code class="literal">nova.conf</code> file
(used by each <code class="literal">nova-compute</code> and <code class="literal">nova-api</code> instance).</p><div class="table" id="id-1.4.11.8.6.3"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.1: </span><span class="name">nova.conf API and credential settings prior to Mitaka </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.8.6.3">#</a></h6></div><div class="table-contents"><table class="table" summary="nova.conf API and credential settings prior to Mitaka" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Attribute name</p>
                </th><th>
                  <p>Required</p>
                </th></tr></thead><tbody><tr><td>
                  <p>
                    <code class="literal">[DEFAULT] use_neutron</code>
                  </p>
                </td><td>
                  <p>Modify from the default to <code class="literal">True</code> to
indicate that Networking should be used rather than the traditional
nova-network networking model.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] url</code>
                  </p>
                </td><td>
                  <p>Update to the host name/IP and port of the neutron-server instance
for this deployment.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] auth_strategy</code>
                  </p>
                </td><td>
                  <p>Keep the default <code class="literal">keystone</code> value for all production deployments.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] admin_project_name</code>
                  </p>
                </td><td>
                  <p>Update to the name of the service tenant created in the above section on
Identity configuration.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] admin_username</code>
                  </p>
                </td><td>
                  <p>Update to the name of the user created in the above section on Identity
configuration.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] admin_password</code>
                  </p>
                </td><td>
                  <p>Update to the password of the user created in the above section on
Identity configuration.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] admin_auth_url</code>
                  </p>
                </td><td>
                  <p>Update to the Identity server IP and port. This is the Identity
(keystone) admin API server IP and port value, and not the Identity
service API IP and port.</p>
                </td></tr></tbody></table></div></div><div class="table" id="id-1.4.11.8.6.4"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.2: </span><span class="name">nova.conf API and credential settings in Newton </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.8.6.4">#</a></h6></div><div class="table-contents"><table class="table" summary="nova.conf API and credential settings in Newton" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Attribute name</p>
                </th><th>
                  <p>Required</p>
                </th></tr></thead><tbody><tr><td>
                  <p>
                    <code class="literal">[DEFAULT] use_neutron</code>
                  </p>
                </td><td>
                  <p>Modify from the default to <code class="literal">True</code> to
indicate that Networking should be used rather than the traditional
nova-network networking model.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] url</code>
                  </p>
                </td><td>
                  <p>Update to the host name/IP and port of the neutron-server instance
for this deployment.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] auth_strategy</code>
                  </p>
                </td><td>
                  <p>Keep the default <code class="literal">keystone</code> value for all production deployments.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] project_name</code>
                  </p>
                </td><td>
                  <p>Update to the name of the service tenant created in the above section on
Identity configuration.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] username</code>
                  </p>
                </td><td>
                  <p>Update to the name of the user created in the above section on Identity
configuration.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] password</code>
                  </p>
                </td><td>
                  <p>Update to the password of the user created in the above section on
Identity configuration.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">[neutron] auth_url</code>
                  </p>
                </td><td>
                  <p>Update to the Identity server IP and port. This is the Identity
(keystone) admin API server IP and port value, and not the Identity
service API IP and port.</p>
                </td></tr></tbody></table></div></div></div><div class="sect2 " id="id-1.4.11.8.7"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.5.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure security groups</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.8.7">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The Networking service provides security group functionality using a
mechanism that is more flexible and powerful than the security group
capabilities built into Compute. Therefore, if you use Networking, you
should always disable built-in security groups and proxy all security
group calls to the Networking API. If you do not, security policies
will conflict by being simultaneously applied by both services.</p><p>To proxy security groups to Networking, use the following configuration
values in the <code class="literal">nova.conf</code> file:</p><p>
          <span class="bold"><strong>nova.conf security group settings</strong></span>
        </p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Item</p>
                </th><th>
                  <p>Configuration</p>
                </th></tr></thead><tbody><tr><td>
                  <p>
                    <code class="literal">firewall_driver</code>
                  </p>
                </td><td>
                  <p>Update to <code class="literal">nova.virt.firewall.NoopFirewallDriver</code>,
so that nova-compute does not perform
iptables-based filtering itself.</p>
                </td></tr></tbody></table></div></div><div class="sect2 " id="id-1.4.11.8.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.5.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure metadata</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.8.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The Compute service allows VMs to query metadata associated with a VM by
making a web request to a special 169.254.169.254 address. Networking
supports proxying those requests to nova-api, even when the requests are
made from isolated networks, or from multiple networks that use
overlapping IP addresses.</p><p>To enable proxying the requests, you must update the following fields in
<code class="literal">[neutron]</code> section in the <code class="literal">nova.conf</code>.</p><p>
          <span class="bold"><strong>nova.conf metadata settings</strong></span>
        </p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Item</p>
                </th><th>
                  <p>Configuration</p>
                </th></tr></thead><tbody><tr><td>
                  <p>
                    <code class="literal">service_metadata_proxy</code>
                  </p>
                </td><td>
                  <p>Update to <code class="literal">true</code>, otherwise nova-api
will not properly respond to requests
from the neutron-metadata-agent.</p>
                </td></tr><tr><td>
                  <p>
                    <code class="literal">metadata_proxy_shared_secret</code>
                  </p>
                </td><td>
                  <p>Update to a string "password" value.
You must also configure the same value in
the <code class="literal">metadata_agent.ini</code> file, to
authenticate requests made for metadata.</p>
                  <p>The default value of an empty string in
both files will allow metadata to
function, but will not be secure if any
non-trusted entities have access to the
metadata APIs exposed by nova-api.</p>
                </td></tr></tbody></table></div><div id="id-1.4.11.8.8.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>As a precaution, even when using <code class="literal">metadata_proxy_shared_secret</code>,
we recommend that you do not expose metadata using the same
nova-api instances that are used for projects. Instead, you should
run a dedicated set of nova-api instances for metadata that are
available only on your management network. Whether a given nova-api
instance exposes metadata APIs is determined by the value of
<code class="literal">enabled_apis</code> in its <code class="literal">nova.conf</code>.</p></div></div><div class="sect2 " id="id-1.4.11.8.9"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.5.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Example nova.conf (for nova-compute and nova-api)</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.8.9">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Example values for the above settings, assuming a cloud controller node
running Compute and Networking with an IP address of 192.168.1.2:</p><div class="verbatim-wrap highlight ini"><pre class="screen">[DEFAULT]
use_neutron = True
firewall_driver=nova.virt.firewall.NoopFirewallDriver

[neutron]
url=http://192.168.1.2:9696
auth_strategy=keystone
admin_tenant_name=service
admin_username=neutron
admin_password=password
admin_auth_url=http://192.168.1.2:35357/v2.0
service_metadata_proxy=true
metadata_proxy_shared_secret=foo</pre></div></div></div><div class="sect1 " id="id-1.4.11.9"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Advanced configuration options</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.9">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This section describes advanced configuration options for various system
components. For example, configuration options where the default works
but that the user wants to customize options. After installing from
packages, <code class="literal">$NEUTRON_CONF_DIR</code> is <code class="literal">/etc/neutron</code>.</p><div class="sect2 " id="id-1.4.11.9.3"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.6.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">L3 metering agent</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.9.3">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>You can run an L3 metering agent that enables layer-3 traffic metering.
In general, you should launch the metering agent on all nodes that run
the L3 agent:</p><div class="verbatim-wrap"><pre class="screen">$ neutron-metering-agent --config-file NEUTRON_CONFIG_FILE \
  --config-file L3_METERING_CONFIG_FILE</pre></div><p>You must configure a driver that matches the plug-in that runs on the
service. The driver adds metering to the routing interface.</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                  <p>Option</p>
                </th><th>
                  <p>Value</p>
                </th></tr></thead><tbody><tr><td>
                  <p>
                    <span class="bold"><strong>Open vSwitch</strong></span>
                  </p>
                </td><td> </td></tr><tr><td>
                  <p>interface_driver
($NEUTRON_CONF_DIR/metering_agent.ini)</p>
                </td><td>
                  <p>openvswitch</p>
                </td></tr><tr><td>
                  <p>
                    <span class="bold"><strong>Linux Bridge</strong></span>
                  </p>
                </td><td> </td></tr><tr><td>
                  <p>interface_driver
($NEUTRON_CONF_DIR/metering_agent.ini)</p>
                </td><td>
                  <p>linuxbridge</p>
                </td></tr></tbody></table></div><div class="sect3 " id="id-1.4.11.9.3.6"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.6.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">L3 metering driver</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.9.3.6">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>You must configure any driver that implements the metering abstraction.
Currently the only available implementation uses iptables for metering.</p><div class="verbatim-wrap highlight ini"><pre class="screen">driver = neutron.services.metering.drivers.
iptables.iptables_driver.IptablesMeteringDriver</pre></div></div><div class="sect3 " id="id-1.4.11.9.3.7"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.6.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">L3 metering service driver</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.9.3.7">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To enable L3 metering, you must set the following option in the
<code class="literal">neutron.conf</code> file on the host that runs <code class="literal">neutron-server</code>:</p><div class="verbatim-wrap highlight ini"><pre class="screen">service_plugins = metering</pre></div></div></div></div><div class="sect1 " id="id-1.4.11.10"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Scalable and highly available DHCP agents</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.10">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This section is fully described at the <a class="link" href="http://docs.openstack.org/newton/networking-guide/config-dhcp-ha.html" target="_blank">High-availability for DHCP</a>
in the Networking Guide.</p></div><div class="sect1 " id="id-1.4.11.11"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Use Networking</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>You can manage OpenStack Networking services by using the service
command. For example:</p><div class="verbatim-wrap"><pre class="screen"># service neutron-server stop
# service neutron-server status
# service neutron-server start
# service neutron-server restart</pre></div><p>Log files are in the <code class="literal">/var/log/neutron</code> directory.</p><p>Configuration files are in the <code class="literal">/etc/neutron</code> directory.</p><p>Administrators and projects can use OpenStack Networking to build
rich network topologies. Administrators can create network
connectivity on behalf of projects.</p><div class="sect2 " id="id-1.4.11.11.7"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.8.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Core Networking API features</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11.7">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>After installing and configuring Networking (neutron), projects and
administrators can perform create-read-update-delete (CRUD) API networking
operations. This is performed using the Networking API directly with either
the <code class="command">neutron</code> command-line interface (CLI) or the <code class="command">openstack</code>
CLI. The <code class="command">neutron</code> CLI is a wrapper around the Networking API. Every
Networking API call has a corresponding <code class="command">neutron</code> command.</p><p>The <code class="command">openstack</code> CLI is a common interface for all OpenStack
projects, however, not every API operation has been implemented. For the
list of available commands, see <a class="link" href="http://docs.openstack.org/developer/python-openstackclient/command-list.html" target="_blank">Command List</a>.</p><p>The <code class="command">neutron</code> CLI includes a number of options. For details, see
<a class="link" href="http://docs.openstack.org/user-guide/cli-create-and-manage-networks.html" target="_blank">Create and manage networks</a>.</p><div class="sect3 " id="id-1.4.11.11.7.5"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.8.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic Networking operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11.7.5">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To learn about advanced capabilities available through the <code class="command">neutron</code>
command-line interface (CLI), read the networking section <a class="link" href="http://docs.openstack.org/user-guide/cli-create-and-manage-networks.html" target="_blank">Create and manage
networks</a>
in the OpenStack End User Guide.</p><p>This table shows example <code class="command">openstack</code> commands that enable you to
complete basic network operations:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Operation</p>
                  </th><th>
                    <p>Command</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>Creates a network.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack network create net1</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Creates a subnet that is
associated with net1.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack subnet create subnet1</code>
                      <code class="literal">--subnet-range 10.0.0.0/24</code>
                      <code class="literal">--network net1</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Lists ports for a
specified project.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack port list</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Lists ports for a
specified project
and displays the <code class="literal">ID</code>,
<code class="literal">Fixed IP Addresses</code></p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack port list -c ID</code>
                      <code class="literal">-c "Fixed IP Addresses</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Shows information for a
specified port.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack port show PORT_ID</code>
                    </p>
                  </td></tr></tbody></table></div><p>
            <span class="bold"><strong>Basic Networking operations</strong></span>
          </p><div id="id-1.4.11.11.7.5.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>The <code class="literal">device_owner</code> field describes who owns the port. A port whose
<code class="literal">device_owner</code> begins with:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><code class="literal">network</code> is created by Networking.</p></li><li class="listitem "><p><code class="literal">compute</code> is created by Compute.</p></li></ul></div></div></div><div class="sect3 " id="id-1.4.11.11.7.6"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.8.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Administrative operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11.7.6">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The administrator can run any <code class="command">openstack</code> command on behalf of
projects by specifying an Identity <code class="literal">project</code> in the command, as
follows:</p><div class="verbatim-wrap"><pre class="screen">$ openstack network create --project PROJECT_ID NETWORK_NAME</pre></div><p>For example:</p><div class="verbatim-wrap"><pre class="screen">$ openstack network create --project 5e4bbe24b67a4410bc4d9fae29ec394e net1</pre></div><div id="id-1.4.11.11.7.6.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>To view all project IDs in Identity, run the following command as an
Identity service admin user:</p><div class="verbatim-wrap"><pre class="screen">$ openstack project list</pre></div></div></div><div class="sect3 " id="id-1.4.11.11.7.7"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.8.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Advanced Networking operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11.7.7">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This table shows example CLI commands that enable you to complete
advanced network operations:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Operation</p>
                  </th><th>
                    <p>Command</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>Creates a network that
all projects can use.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack network create</code>
                      <code class="literal">--share public-net</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Creates a subnet with a
specified gateway IP address.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack subnet create subnet1</code>
                      <code class="literal">--gateway 10.0.0.254 --network net1</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Creates a subnet that has
no gateway IP address.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack subnet create subnet1</code>
                      <code class="literal">--no-gateway --network net1</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Creates a subnet with DHCP
disabled.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack subnet create subnet1</code>
                      <code class="literal">--network net1 --no-dhcp</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Specifies a set of host routes</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack subnet create subnet1</code>
                      <code class="literal">--network net1 --host-route</code>
                      <code class="literal">destination=40.0.1.0/24,</code>
                      <code class="literal">gateway=40.0.0.2</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Creates a subnet with a
specified set of dns name
servers.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack subnet create subnet1</code>
                      <code class="literal">--network net1 --dns-nameserver</code>
                      <code class="literal">8.8.4.4</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Displays all ports and
IPs allocated on a network.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack port list --network NET_ID</code>
                    </p>
                  </td></tr></tbody></table></div><p>
            <span class="bold"><strong>Advanced Networking operations</strong></span>
          </p></div></div><div class="sect2 " id="id-1.4.11.11.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.8.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Use Compute with Networking</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect3 " id="id-1.4.11.11.8.2"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.8.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic Compute and Networking operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11.8.2">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This table shows example <code class="command">openstack</code> commands that enable you to
complete basic VM networking operations:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Action</p>
                  </th><th>
                    <p>Command</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>Checks available networks.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack network list</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Boots a VM with a single NIC on
a selected Networking network.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack server create --image</code>
                      <code class="literal">IMAGE --flavor FLAVOR --nic</code>
                      <code class="literal">net-id=NET_ID VM_NAME</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Searches for ports with a
<code class="literal">device_id</code> that matches the
Compute instance UUID. See :ref:
<code class="literal">Create and delete VMs</code></p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack port list --server VM_ID</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Searches for ports, but shows
only the <code class="literal">mac_address</code> of
the port.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack port list -c</code>
                      <code class="literal">"MAC Address" --server VM_ID</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Temporarily disables a port from
sending traffic.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack port set PORT_ID</code>
                      <code class="literal">--disable</code>
                    </p>
                  </td></tr></tbody></table></div><p>
            <span class="bold"><strong>Basic Compute and Networking operations</strong></span>
          </p><div id="id-1.4.11.11.8.2.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>The <code class="literal">device_id</code> can also be a logical router ID.</p></div><div id="id-1.4.11.11.8.2.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>When you boot a Compute VM, a port on the network that
corresponds to the VM NIC is automatically created and associated
with the default security group. You can configure security
group rules to enable
users to access the VM.</p></li></ul></div></div></div><div class="sect3 " id="id-1.4.11.11.8.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.8.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Advanced VM creation operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11.8.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This table shows example <code class="command">openstack</code> commands that enable you to
complete advanced VM creation operations:</p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Operation</p>
                  </th><th>
                    <p>Command</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>Boots a VM with multiple
NICs.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack server create --image</code>
                      <code class="literal">IMAGE --flavor FLAVOR --nic</code>
                      <code class="literal">net-id=NET_ID VM_NAME</code>
                      <code class="literal">net-id=NET2-ID VM_NAME</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Boots a VM with a specific IP
address. Note that you cannot
use the <code class="literal">--max</code> or <code class="literal">--min</code>
parameters in this case.</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack server create --image</code>
                      <code class="literal">IMAGE --flavor FLAVOR --nic</code>
                      <code class="literal">net-id=NET_ID VM_NAME</code>
                      <code class="literal">v4-fixed-ip=IP-ADDR VM_NAME</code>
                    </p>
                  </td></tr><tr><td>
                    <p>Boots a VM that connects to all
networks that are accessible to the
project who submits the request
(without the <code class="literal">--nic</code> option).</p>
                  </td><td>
                    <p>
                      <code class="literal">$ openstack server create --image</code>
                      <code class="literal">IMAGE --flavor FLAVOR</code>
                    </p>
                  </td></tr></tbody></table></div><p>
            <span class="bold"><strong>Advanced VM creation operations</strong></span>
          </p><div id="id-1.4.11.11.8.3.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>Cloud images that distribution vendors offer usually have only one
active NIC configured. When you boot with multiple NICs, you must
configure additional interfaces on the image or the NICs are not
reachable.</p><p>The following Debian/Ubuntu-based example shows how to set up the
interfaces within the instance in the <code class="literal">/etc/network/interfaces</code>
file. You must apply this configuration to the image.</p><div class="verbatim-wrap highlight bash"><pre class="screen"># The loopback network interface
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp

auto eth1
iface eth1 inet dhcp</pre></div></div></div><div class="sect3 " id="id-1.4.11.11.8.4"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.8.2.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Enable ping and SSH on VMs (security groups)</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.11.8.4">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>You must configure security group rules depending on the type of plug-in
you are using. If you are using a plug-in that:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Implements Networking security groups, you can configure security
group rules directly by using the <code class="command">openstack security group rule create</code>
command. This example enables <code class="literal">ping</code> and <code class="literal">ssh</code> access to your VMs.</p><div class="verbatim-wrap"><pre class="screen">$ openstack security group rule create --protocol icmp \
    --ingress</pre></div><div class="verbatim-wrap"><pre class="screen">$ openstack security group rule create --protocol tcp \
    --egress --description "Sample Security Group"</pre></div></li><li class="listitem "><p>Does not implement Networking security groups, you can configure
security group rules by using the <code class="command">openstack security group rule
create</code> or <code class="command">euca-authorize</code> command. These <code class="command">openstack</code>
commands enable <code class="literal">ping</code> and <code class="literal">ssh</code> access to your VMs.</p><div class="verbatim-wrap"><pre class="screen">$ openstack security group rule create default --protocol icmp --dst-port -1:-1 --remote-ip 0.0.0.0/0
$ openstack security group rule create default --protocol tcp --dst-port 22:22 --remote-ip 0.0.0.0/0</pre></div></li></ul></div><div id="id-1.4.11.11.8.4.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>If your plug-in implements Networking security groups, you can also
leverage Compute security groups by setting
<code class="literal">security_group_api = neutron</code> in the <code class="literal">nova.conf</code> file. After
you set this option, all Compute security group commands are proxied
to Networking.</p></div></div></div></div><div class="sect1 " id="networking-adv-features"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.9 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Advanced features through API extensions</span> <a title="Permalink" class="permalink" href="networking.html#networking-adv-features">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>networking-adv-features</li></ul></div></div></div></div><p>Several plug-ins implement API extensions that provide capabilities
similar to what was available in <code class="literal">nova-network</code>. These plug-ins are likely
to be of interest to the OpenStack community.</p><div class="sect2 " id="id-1.4.11.12.3"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.9.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Provider networks</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.3">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Networks can be categorized as either project networks or provider
networks. Project networks are created by normal users and details about
how they are physically realized are hidden from those users. Provider
networks are created with administrative credentials, specifying the
details of how the network is physically realized, usually to match some
existing network in the data center.</p><p>Provider networks enable administrators to create networks that map
directly to the physical networks in the data center.
This is commonly used to give projects direct access to a public network
that can be used to reach the Internet. It might also be used to
integrate with VLANs in the network that already have a defined meaning
(for example, enable a VM from the marketing department to be placed
on the same VLAN as bare-metal marketing hosts in the same data center).</p><p>The provider extension allows administrators to explicitly manage the
relationship between Networking virtual networks and underlying physical
mechanisms such as VLANs and tunnels. When this extension is supported,
Networking client users with administrative privileges see additional
provider attributes on all virtual networks and are able to specify
these attributes in order to create provider networks.</p><p>The provider extension is supported by the Open vSwitch and Linux Bridge
plug-ins. Configuration of these plug-ins requires familiarity with this
extension.</p><div class="sect3 " id="id-1.4.11.12.3.6"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.9.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Terminology</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.3.6">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>A number of terms are used in the provider extension and in the
configuration of plug-ins supporting the provider extension:</p><p>
            <span class="bold"><strong>Provider extension terminology</strong></span>
          </p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Term</p>
                  </th><th>
                    <p>Description</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>
                      <span class="bold"><strong>virtual network</strong></span>
                    </p>
                  </td><td>
                    <p>A Networking L2 network (identified by a UUID and
optional name) whose ports can be attached as vNICs
to Compute instances and to various Networking
agents. The Open vSwitch and Linux Bridge plug-ins
each support several different mechanisms to
realize virtual networks.</p>
                  </td></tr><tr><td>
                    <p>
                      <span class="bold"><strong>physical network</strong></span>
                    </p>
                  </td><td>
                    <p>A network connecting virtualization hosts (such as
compute nodes) with each other and with other
network resources. Each physical network might
support multiple virtual networks. The provider
extension and the plug-in configurations identify
physical networks using simple string names.</p>
                  </td></tr><tr><td>
                    <p>
                      <span class="bold"><strong>project network</strong></span>
                    </p>
                  </td><td>
                    <p>A virtual network that a project or an administrator
creates. The physical details of the network are not
exposed to the project.</p>
                  </td></tr><tr><td>
                    <p>
                      <span class="bold"><strong>provider network</strong></span>
                    </p>
                  </td><td>
                    <p>A virtual network administratively created to map to
a specific network in the data center, typically to
enable direct access to non-OpenStack resources on
that network. Project can be given access to
provider networks.</p>
                  </td></tr><tr><td>
                    <p>
                      <span class="bold"><strong>VLAN network</strong></span>
                    </p>
                  </td><td>
                    <p>A virtual network implemented as packets on a
specific physical network containing IEEE 802.1Q
headers with a specific VID field value. VLAN
networks sharing the same physical network are
isolated from each other at L2 and can even have
overlapping IP address spaces. Each distinct
physical network supporting VLAN networks is
treated as a separate VLAN trunk, with a distinct
space of VID values. Valid VID values are 1
through 4094.</p>
                  </td></tr><tr><td>
                    <p>
                      <span class="bold"><strong>flat network</strong></span>
                    </p>
                  </td><td>
                    <p>A virtual network implemented as packets on a
specific physical network containing no IEEE 802.1Q
header. Each physical network can realize at most
one flat network.</p>
                  </td></tr><tr><td>
                    <p>
                      <span class="bold"><strong>local network</strong></span>
                    </p>
                  </td><td>
                    <p>A virtual network that allows communication within
each host, but not across a network. Local networks
are intended mainly for single-node test scenarios,
but can have other uses.</p>
                  </td></tr><tr><td>
                    <p>
                      <span class="bold"><strong>GRE network</strong></span>
                    </p>
                  </td><td>
                    <p>A virtual network implemented as network packets
encapsulated using GRE. GRE networks are also
referred to as <span class="emphasis"><em>tunnels</em></span>. GRE tunnel packets are
routed by the IP routing table for the host, so
GRE networks are not associated by Networking with
specific physical networks.</p>
                  </td></tr><tr><td>
                    <p>
                      <span class="bold"><strong>Virtual Extensible
LAN (VXLAN) network</strong></span>
                    </p>
                  </td><td>
                    <p>VXLAN is a proposed encapsulation protocol for
running an overlay network on existing Layer 3
infrastructure. An overlay network is a virtual
network that is built on top of existing network
Layer 2 and Layer 3 technologies to support elastic
compute architectures.</p>
                  </td></tr></tbody></table></div><p>The ML2, Open vSwitch, and Linux Bridge plug-ins support VLAN networks,
flat networks, and local networks. Only the ML2 and Open vSwitch
plug-ins currently support GRE and VXLAN networks, provided that the
required features exist in the hosts Linux kernel, Open vSwitch, and
iproute2 packages.</p></div><div class="sect3 " id="id-1.4.11.12.3.7"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.9.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Provider attributes</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.3.7">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The provider extension extends the Networking network resource with
these attributes:</p><div class="table" id="id-1.4.11.12.3.7.3"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.3: </span><span class="name">Provider network attributes </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.3.7.3">#</a></h6></div><div class="table-contents"><table class="table" summary="Provider network attributes" border="1"><colgroup><col class="c1" /><col class="c2" /><col class="c3" /><col class="c4" /></colgroup><thead><tr><th>
                    <p>Attribute name</p>
                  </th><th>
                    <p>Type</p>
                  </th><th>
                    <p>Default Value</p>
                  </th><th>
                    <p>Description</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>provider: network_type</p>
                  </td><td>
                    <p>String</p>
                  </td><td>
                    <p>N/A</p>
                  </td><td>
                    <p>The physical mechanism by which the virtual network is implemented.
Possible values are <code class="literal">flat</code>, <code class="literal">vlan</code>, <code class="literal">local</code>, <code class="literal">gre</code>, and
<code class="literal">vxlan</code>, corresponding to flat networks, VLAN networks, local
networks, GRE networks, and VXLAN networks as defined above.
All types of provider networks can be created by administrators,
while project networks can be implemented as <code class="literal">vlan</code>, <code class="literal">gre</code>,
<code class="literal">vxlan</code>, or <code class="literal">local</code> network types depending on plug-in
configuration.</p>
                  </td></tr><tr><td>
                    <p>provider: physical_network</p>
                  </td><td>
                    <p>String</p>
                  </td><td>
                    <p>If a physical network named "default" has been configured and
if provider:network_type is <code class="literal">flat</code> or <code class="literal">vlan</code>, then "default"
is used.</p>
                  </td><td>
                    <p>The name of the physical network over which the virtual network
is implemented for flat and VLAN networks. Not applicable to the
<code class="literal">local</code> or <code class="literal">gre</code> network types.</p>
                  </td></tr><tr><td>
                    <p>provider:segmentation_id</p>
                  </td><td>
                    <p>Integer</p>
                  </td><td>
                    <p>N/A</p>
                  </td><td>
                    <p>For VLAN networks, the VLAN VID on the physical network that
realizes the virtual network. Valid VLAN VIDs are 1 through 4094.
For GRE networks, the tunnel ID. Valid tunnel IDs are any 32 bit
unsigned integer. Not applicable to the <code class="literal">flat</code> or <code class="literal">local</code>
network types.</p>
                  </td></tr></tbody></table></div></div><p>To view or set provider extended attributes, a client must be authorized
for the <code class="literal">extension:provider_network:view</code> and
<code class="literal">extension:provider_network:set</code> actions in the Networking policy
configuration. The default Networking configuration authorizes both
actions for users with the admin role. An authorized client or an
administrative user can view and set the provider extended attributes
through Networking API calls. See the section called
<a class="xref" href="networking.html#authentication-and-authorization" title="9.11. Authentication and authorization">Section 9.11, “Authentication and authorization”</a> for details on policy configuration.</p></div></div><div class="sect2 " id="l3-routing-and-nat"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.9.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">L3 routing and NAT</span> <a title="Permalink" class="permalink" href="networking.html#l3-routing-and-nat">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>l3-routing-and-nat</li></ul></div></div></div></div><p>The Networking API provides abstract L2 network segments that are
decoupled from the technology used to implement the L2 network.
Networking includes an API extension that provides abstract L3 routers
that API users can dynamically provision and configure. These Networking
routers can connect multiple L2 Networking networks and can also provide
a gateway that connects one or more private L2 networks to a shared
external network. For example, a public network for access to the
Internet. See the <a class="link" href="http://docs.openstack.org/newton/config-reference/" target="_blank">OpenStack Configuration Reference</a> for details on common
models of deploying Networking L3 routers.</p><p>The L3 router provides basic NAT capabilities on gateway ports that
uplink the router to external networks. This router SNATs all traffic by
default and supports floating IPs, which creates a static one-to-one
mapping from a public IP on the external network to a private IP on one
of the other subnets attached to the router. This allows a project to
selectively expose VMs on private networks to other hosts on the
external network (and often to all hosts on the Internet). You can
allocate and map floating IPs from one port to another, as needed.</p><div class="sect3 " id="id-1.4.11.12.4.4"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.9.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic L3 operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.4.4">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>External networks are visible to all users. However, the default policy
settings enable only administrative users to create, update, and delete
external networks.</p><p>This table shows example neutron commands that enable you to complete
basic L3 operations:</p><div class="table" id="id-1.4.11.12.4.4.4"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.4: </span><span class="name">Basic L3 Operations </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.4.4.4">#</a></h6></div><div class="table-contents"><table class="table" summary="Basic L3 Operations" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Operation</p>
                  </th><th>
                    <p>Command</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>Creates external networks.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network create public --external
$ openstack subnet create --network public --subnet-range 172.16.1.0/24 public-subnet</pre></div>
                  </td></tr><tr><td>
                    <p>Lists external networks.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network list --external</pre></div>
                  </td></tr><tr><td>
                    <p>Creates an internal-only router that connects to multiple L2 networks privately.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network create net1
$ openstack subnet create --network net1 --subnet-range 10.0.0.0/24 subnet1
$ openstack network create net2
$ openstack subnet create --network net2 --subnet-range 10.0.1.0/24 subnet2
$ openstack router create router1
$ openstack router add subnet router1 SUBNET1_UUID
$ openstack router add subnet router1 SUBNET2_UUID</pre></div>
                    <p>An internal router port can have only one IPv4 subnet and multiple IPv6 subnets
that belong to the same network ID. When you call <code class="literal">router-interface-add</code> with an IPv6
subnet, this operation adds the interface to an existing internal port with the same
network ID. If a port with the same network ID does not exist, a new port is created.</p>
                  </td></tr><tr><td>
                    <p>Connects a router to an external network, which enables that router to
act as a NAT gateway for external connectivity.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack router set router1 --external-gateway EXT_NET_ID</pre></div>
                    <p>The router obtains an interface with the gateway_ip address of the
subnet and this interface is attached to a port on the L2 Networking
network associated with the subnet. The router also gets a gateway
interface to the specified external network. This provides SNAT
connectivity to the external network as well as support for floating
IPs allocated on that external networks. Commonly an external network
maps to a network in the provider.</p>
                  </td></tr><tr><td>
                    <p>Lists routers.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack router list</pre></div>
                  </td></tr><tr><td>
                    <p>Shows information for a specified router.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack router show ROUTER_ID</pre></div>
                  </td></tr><tr><td>
                    <p>Shows all internal interfaces for a router.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack port list --router  ROUTER_ID
$ openstack port list --router  ROUTER_NAME</pre></div>
                  </td></tr><tr><td>
                    <p>Identifies the PORT_ID that represents the VM NIC to which the floating
IP should map.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack port list -c ID -c "Fixed IP Addresses" --server INSTANCE_ID</pre></div>
                    <p>This port must be on a Networking subnet that is attached to
a router uplinked to the external network used to create the floating
IP. Conceptually, this is because the router must be able to perform the
Destination NAT (DNAT) rewriting of packets from the floating IP address
(chosen from a subnet on the external network) to the internal fixed
IP (chosen from a private subnet that is behind the router).</p>
                  </td></tr><tr><td>
                    <p>Creates a floating IP address and associates it with a port.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack floating ip create EXT_NET_ID
$ openstack floating ip add port FLOATING_IP_ID --port-id INTERNAL_VM_PORT_ID</pre></div>
                  </td></tr><tr><td>
                    <p>Creates a floating IP on a specific subnet in the external network.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack floating ip create EXT_NET_ID --subnet SUBNET_ID</pre></div>
                    <p>If there are multiple subnets in the external network, you can choose a specific
subnet based on quality and costs.</p>
                  </td></tr><tr><td>
                    <p>Creates a floating IP address and associates it with a port, in a single step.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack floating ip create --port INTERNAL_VM_PORT_ID EXT_NET_ID</pre></div>
                  </td></tr><tr><td>
                    <p>Lists floating IPs</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack floating ip list</pre></div>
                  </td></tr><tr><td>
                    <p>Finds floating IP for a specified VM port.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack floating ip list --port INTERNAL_VM_PORT_ID</pre></div>
                  </td></tr><tr><td>
                    <p>Disassociates a floating IP address.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack floating ip remove port FLOATING_IP_ID</pre></div>
                  </td></tr><tr><td>
                    <p>Deletes the floating IP address.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack floating ip delete FLOATING_IP_ID</pre></div>
                  </td></tr><tr><td>
                    <p>Clears the gateway.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack router unset --external-gateway router1</pre></div>
                  </td></tr><tr><td>
                    <p>Removes the interfaces from the router.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack router remove subnet router1 SUBNET_ID</pre></div>
                    <p>If this subnet ID is the last subnet on the port, this operation deletes the port itself.</p>
                  </td></tr><tr><td>
                    <p>Deletes the router.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack router delete router1</pre></div>
                  </td></tr></tbody></table></div></div></div></div><div class="sect2 " id="id-1.4.11.12.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.9.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Security groups</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.5">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Security groups and security group rules allow administrators and
projects to specify the type of traffic and direction
(ingress/egress) that is allowed to pass through a port. A security
group is a container for security group rules.</p><p>When a port is created in Networking it is associated with a security
group. If a security group is not specified the port is associated with
a 'default' security group. By default, this group drops all ingress
traffic and allows all egress. Rules can be added to this group in order
to change the behavior.</p><p>To use the Compute security group APIs or use Compute to orchestrate the
creation of ports for instances on specific security groups, you must
complete additional configuration. You must configure the
<code class="literal">/etc/nova/nova.conf</code> file and set the <code class="literal">security_group_api=neutron</code>
option on every node that runs nova-compute and nova-api. After you make
this change, restart nova-api and nova-compute to pick up this change.
Then, you can use both the Compute and OpenStack Network security group
APIs at the same time.</p><div id="id-1.4.11.12.5.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>To use the Compute security group API with Networking, the
Networking plug-in must implement the security group API. The
following plug-ins currently implement this: ML2, Open vSwitch,
Linux Bridge, NEC, and VMware NSX.</p></li><li class="listitem "><p>You must configure the correct firewall driver in the
<code class="literal">securitygroup</code> section of the plug-in/agent configuration
file. Some plug-ins and agents, such as Linux Bridge Agent and
Open vSwitch Agent, use the no-operation driver as the default,
which results in non-working security groups.</p></li><li class="listitem "><p>When using the security group API through Compute, security
groups are applied to all ports on an instance. The reason for
this is that Compute security group APIs are instances based and
not port based as Networking.</p></li></ul></div></div><div class="sect3 " id="id-1.4.11.12.5.6"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.9.3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic security group operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.5.6">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This table shows example neutron commands that enable you to complete
basic security group operations:</p><div class="table" id="id-1.4.11.12.5.6.3"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.5: </span><span class="name">Basic security group operations </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.5.6.3">#</a></h6></div><div class="table-contents"><table class="table" summary="Basic security group operations" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Operation</p>
                  </th><th>
                    <p>Command</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>Creates a security group for our web servers.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack security group create webservers \
 --description "security group for webservers"</pre></div>
                  </td></tr><tr><td>
                    <p>Lists security groups.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack security group list</pre></div>
                  </td></tr><tr><td>
                    <p>Creates a security group rule to allow port 80 ingress.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack security group rule create --ingress \
  --protocol tcp SECURITY_GROUP_UUID</pre></div>
                  </td></tr><tr><td>
                    <p>Lists security group rules.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack security group rule list</pre></div>
                  </td></tr><tr><td>
                    <p>Deletes a security group rule.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack security group rule delete SECURITY_GROUP_RULE_UUID</pre></div>
                  </td></tr><tr><td>
                    <p>Deletes a security group.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack security group delete SECURITY_GROUP_UUID</pre></div>
                  </td></tr><tr><td>
                    <p>Creates a port and associates two security groups.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack port create port1 --security-group SECURITY_GROUP_ID1 \
  --security-group SECURITY_GROUP_ID2 --network NETWORK_ID</pre></div>
                  </td></tr><tr><td>
                    <p>Removes security groups from a port.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack port set --no-security-group PORT_ID</pre></div>
                  </td></tr></tbody></table></div></div></div></div><div class="sect2 " id="id-1.4.11.12.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.9.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic Load-Balancer-as-a-Service operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.6">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div id="id-1.4.11.12.6.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>The Load-Balancer-as-a-Service (LBaaS) API provisions and configures
load balancers. The reference implementation is based on the HAProxy
software load balancer.</p></div><p>This list shows example neutron commands that enable you to complete
basic LBaaS operations:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Creates a load balancer pool by using specific provider.</p><p><code class="literal">--provider</code> is an optional argument. If not used, the pool is
created with default provider for LBaaS service. You should configure
the default provider in the <code class="literal">[service_providers]</code> section of the
<code class="literal">neutron.conf</code> file. If no default provider is specified for LBaaS,
the <code class="literal">--provider</code> parameter is required for pool creation.</p><div class="verbatim-wrap"><pre class="screen">$ neutron lbaas-pool-create --lb-algorithm ROUND_ROBIN --name mypool \
  --protocol HTTP --subnet-id SUBNET_UUID --provider PROVIDER_NAME</pre></div></li><li class="listitem "><p>Associates two web servers with pool.</p><div class="verbatim-wrap"><pre class="screen">$ neutron lbaas-member-create --address  WEBSERVER1_IP --protocol-port 80 mypool
$ neutron lbaas-member-create --address  WEBSERVER2_IP --protocol-port 80 mypool</pre></div></li><li class="listitem "><p>Creates a health monitor that checks to make sure our instances are
still running on the specified protocol-port.</p><div class="verbatim-wrap"><pre class="screen">$ neutron lbaas-healthmonitor-create --delay 3 --type HTTP --max-retries 3 \
  --timeout 3</pre></div></li><li class="listitem "><p>Associates a health monitor with pool.</p><div class="verbatim-wrap"><pre class="screen">$ neutron lbaas-healthmonitor-associate HEALTHMONITOR_UUID mypool</pre></div></li><li class="listitem "><p>Creates a virtual IP (VIP) address that, when accessed through the
load balancer, directs the requests to one of the pool members.</p><div class="verbatim-wrap"><pre class="screen">$ neutron lbaas-vip-create --name myvip --protocol-port 80 --protocol \
  HTTP --subnet-id SUBNET_UUID mypool</pre></div></li></ul></div></div><div class="sect2 " id="id-1.4.11.12.7"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.9.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Plug-in specific extensions</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Each vendor can choose to implement additional API extensions to the
core API. This section describes the extensions for each plug-in.</p><div class="sect3 " id="id-1.4.11.12.7.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.9.5.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">VMware NSX extensions</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>These sections explain NSX plug-in extensions.</p><div class="sect4 " id="id-1.4.11.12.7.3.3"><div class="titlepage"><div><div><h5 class="title"><span class="number">9.9.5.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">VMware NSX QoS extension</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3.3">#</a></h5><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The VMware NSX QoS extension rate-limits network ports to guarantee a
specific amount of bandwidth for each port. This extension, by default,
is only accessible by a project with an admin role but is configurable
through the <code class="literal">policy.json</code> file. To use this extension, create a queue
and specify the min/max bandwidth rates (kbps) and optionally set the
QoS Marking and DSCP value (if your network fabric uses these values to
make forwarding decisions). Once created, you can associate a queue with
a network. Then, when ports are created on that network they are
automatically created and associated with the specific queue size that
was associated with the network. Because one size queue for a every port
on a network might not be optimal, a scaling factor from the nova flavor
<code class="literal">rxtx_factor</code> is passed in from Compute when creating the port to scale
the queue.</p><p>Lastly, if you want to set a specific baseline QoS policy for the amount
of bandwidth a single port can use (unless a network queue is specified
with the network a port is created on) a default queue can be created in
Networking which then causes ports created to be associated with a queue
of that size times the rxtx scaling factor. Note that after a network or
default queue is specified, queues are added to ports that are
subsequently created but are not added to existing ports.</p><div class="sect5 " id="id-1.4.11.12.7.3.3.4"><div class="titlepage"><div><div><h6 class="title"><span class="number">9.9.5.1.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic VMware NSX QoS operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3.3.4">#</a></h6><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This table shows example neutron commands that enable you to complete
basic queue operations:</p><div class="table" id="id-1.4.11.12.7.3.3.4.3"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.6: </span><span class="name">Basic VMware NSX QoS operations </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3.3.4.3">#</a></h6></div><div class="table-contents"><table class="table" summary="Basic VMware NSX QoS operations" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                        <p>Operation</p>
                      </th><th>
                        <p>Command</p>
                      </th></tr></thead><tbody><tr><td>
                        <p>Creates QoS queue (admin-only).</p>
                      </td><td>
                        <div class="verbatim-wrap"><pre class="screen">$ neutron queue-create --min 10 --max 1000 myqueue</pre></div>
                      </td></tr><tr><td>
                        <p>Associates a queue with a network.</p>
                      </td><td>
                        <div class="verbatim-wrap"><pre class="screen">$ neutron net-create network --queue_id QUEUE_ID</pre></div>
                      </td></tr><tr><td>
                        <p>Creates a default system queue.</p>
                      </td><td>
                        <div class="verbatim-wrap"><pre class="screen">$ neutron queue-create --default True --min 10 --max 2000 default</pre></div>
                      </td></tr><tr><td>
                        <p>Lists QoS queues.</p>
                      </td><td>
                        <div class="verbatim-wrap"><pre class="screen">$ neutron queue-list</pre></div>
                      </td></tr><tr><td>
                        <p>Deletes a QoS queue.</p>
                      </td><td>
                        <div class="verbatim-wrap"><pre class="screen">$ neutron queue-delete QUEUE_ID_OR_NAME</pre></div>
                      </td></tr></tbody></table></div></div></div></div><div class="sect4 " id="id-1.4.11.12.7.3.4"><div class="titlepage"><div><div><h5 class="title"><span class="number">9.9.5.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">VMware NSX provider networks extension</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3.4">#</a></h5><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Provider networks can be implemented in different ways by the underlying
NSX platform.</p><p>The <span class="emphasis"><em>FLAT</em></span> and <span class="emphasis"><em>VLAN</em></span> network types use bridged transport connectors.
These network types enable the attachment of large number of ports. To
handle the increased scale, the NSX plug-in can back a single OpenStack
Network with a chain of NSX logical switches. You can specify the
maximum number of ports on each logical switch in this chain on the
<code class="literal">max_lp_per_bridged_ls</code> parameter, which has a default value of 5,000.</p><p>The recommended value for this parameter varies with the NSX version
running in the back-end, as shown in the following table.</p><p>
              <span class="bold"><strong>Recommended values for max_lp_per_bridged_ls</strong></span>
            </p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                      <p>NSX version</p>
                    </th><th>
                      <p>Recommended Value</p>
                    </th></tr></thead><tbody><tr><td>
                      <p>2.x</p>
                    </td><td>
                      <p>64</p>
                    </td></tr><tr><td>
                      <p>3.0.x</p>
                    </td><td>
                      <p>5,000</p>
                    </td></tr><tr><td>
                      <p>3.1.x</p>
                    </td><td>
                      <p>5,000</p>
                    </td></tr><tr><td>
                      <p>3.2.x</p>
                    </td><td>
                      <p>10,000</p>
                    </td></tr></tbody></table></div><p>In addition to these network types, the NSX plug-in also supports a
special <span class="emphasis"><em>l3_ext</em></span> network type, which maps external networks to specific
NSX gateway services as discussed in the next section.</p></div><div class="sect4 " id="id-1.4.11.12.7.3.5"><div class="titlepage"><div><div><h5 class="title"><span class="number">9.9.5.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">VMware NSX L3 extension</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3.5">#</a></h5><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>NSX exposes its L3 capabilities through gateway services which are
usually configured out of band from OpenStack. To use NSX with L3
capabilities, first create an L3 gateway service in the NSX Manager.
Next, in <code class="literal">/etc/neutron/plugins/vmware/nsx.ini</code> set
<code class="literal">default_l3_gw_service_uuid</code> to this value. By default, routers are
mapped to this gateway service.</p><div class="sect5 " id="id-1.4.11.12.7.3.5.3"><div class="titlepage"><div><div><h6 class="title"><span class="number">9.9.5.1.3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">VMware NSX L3 extension operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3.5.3">#</a></h6><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Create external network and map it to a specific NSX gateway service:</p><div class="verbatim-wrap"><pre class="screen">$ openstack network create public --external --provider-network-type l3_ext \
--provider-physical-network L3_GATEWAY_SERVICE_UUID</pre></div><p>Terminate traffic on a specific VLAN from a NSX gateway service:</p><div class="verbatim-wrap"><pre class="screen">$ openstack network create public --external --provider-network-type l3_ext \
--provider-physical-network L3_GATEWAY_SERVICE_UUID --provider-segment VLAN_ID</pre></div></div></div><div class="sect4 " id="id-1.4.11.12.7.3.6"><div class="titlepage"><div><div><h5 class="title"><span class="number">9.9.5.1.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Operational status synchronization in the VMware NSX plug-in</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3.6">#</a></h5><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Starting with the Havana release, the VMware NSX plug-in provides an
asynchronous mechanism for retrieving the operational status for neutron
resources from the NSX back-end; this applies to <span class="emphasis"><em>network</em></span>, <span class="emphasis"><em>port</em></span>, and
<span class="emphasis"><em>router</em></span> resources.</p><p>The back-end is polled periodically and the status for every resource is
retrieved; then the status in the Networking database is updated only
for the resources for which a status change occurred. As operational
status is now retrieved asynchronously, performance for <code class="literal">GET</code>
operations is consistently improved.</p><p>Data to retrieve from the back-end are divided in chunks in order to
avoid expensive API requests; this is achieved leveraging NSX APIs
response paging capabilities. The minimum chunk size can be specified
using a configuration option; the actual chunk size is then determined
dynamically according to: total number of resources to retrieve,
interval between two synchronization task runs, minimum delay between
two subsequent requests to the NSX back-end.</p><p>The operational status synchronization can be tuned or disabled using
the configuration options reported in this table; it is however worth
noting that the default values work fine in most cases.</p><div class="table" id="id-1.4.11.12.7.3.6.6"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.7: </span><span class="name">Configuration options for tuning operational status synchronization in the NSX plug-in </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.3.6.6">#</a></h6></div><div class="table-contents"><table class="table" summary="Configuration options for tuning operational status synchronization in the NSX plug-in" border="1"><colgroup><col class="c1" /><col class="c2" /><col class="c3" /><col class="c4" /><col class="c5" /></colgroup><thead><tr><th>
                      <p>Option name</p>
                    </th><th>
                      <p>Group</p>
                    </th><th>
                      <p>Default value</p>
                    </th><th>
                      <p>Type and constraints</p>
                    </th><th>
                      <p>Notes</p>
                    </th></tr></thead><tbody><tr><td>
                      <p>
                        <code class="literal">state_sync_interval</code>
                      </p>
                    </td><td>
                      <p>
                        <code class="literal">nsx_sync</code>
                      </p>
                    </td><td>
                      <p>10 seconds</p>
                    </td><td>
                      <p>Integer; no constraint.</p>
                    </td><td>
                      <p>Interval in seconds between two run of the synchronization task. If the
synchronization task takes more than <code class="literal">state_sync_interval</code> seconds to
execute, a new instance of the task is started as soon as the other is
completed. Setting the value for this option to 0 will disable the
synchronization task.</p>
                    </td></tr><tr><td>
                      <p>
                        <code class="literal">max_random_sync_delay</code>
                      </p>
                    </td><td>
                      <p>
                        <code class="literal">nsx_sync</code>
                      </p>
                    </td><td>
                      <p>0 seconds</p>
                    </td><td>
                      <p>Integer. Must not exceed <code class="literal">min_sync_req_delay</code></p>
                    </td><td>
                      <p>When different from zero, a random delay between 0 and
<code class="literal">max_random_sync_delay</code> will be added before processing the next
chunk.</p>
                    </td></tr><tr><td>
                      <p>
                        <code class="literal">min_sync_req_delay</code>
                      </p>
                    </td><td>
                      <p>
                        <code class="literal">nsx_sync</code>
                      </p>
                    </td><td>
                      <p>1 second</p>
                    </td><td>
                      <p>Integer. Must not exceed <code class="literal">state_sync_interval</code>.</p>
                    </td><td>
                      <p>The value of this option can be tuned according to the observed
load on the NSX controllers. Lower values will result in faster
synchronization, but might increase the load on the controller cluster.</p>
                    </td></tr><tr><td>
                      <p>
                        <code class="literal">min_chunk_size</code>
                      </p>
                    </td><td>
                      <p>
                        <code class="literal">nsx_sync</code>
                      </p>
                    </td><td>
                      <p>500 resources</p>
                    </td><td>
                      <p>Integer; no constraint.</p>
                    </td><td>
                      <p>Minimum number of resources to retrieve from the back-end for each
synchronization chunk. The expected number of synchronization chunks
is given by the ratio between <code class="literal">state_sync_interval</code> and
<code class="literal">min_sync_req_delay</code>. This size of a chunk might increase if the
total number of resources is such that more than <code class="literal">min_chunk_size</code>
resources must be fetched in one chunk with the current number of
chunks.</p>
                    </td></tr><tr><td>
                      <p>
                        <code class="literal">always_read_status</code>
                      </p>
                    </td><td>
                      <p>
                        <code class="literal">nsx_sync</code>
                      </p>
                    </td><td>
                      <p>False</p>
                    </td><td>
                      <p>Boolean; no constraint.</p>
                    </td><td>
                      <p>When this option is enabled, the operational status will always be
retrieved from the NSX back-end ad every <code class="literal">GET</code> request. In this
case it is advisable to disable the synchronization task.</p>
                    </td></tr></tbody></table></div></div><p>When running multiple OpenStack Networking server instances, the status
synchronization task should not run on every node; doing so sends
unnecessary traffic to the NSX back-end and performs unnecessary DB
operations. Set the <code class="literal">state_sync_interval</code> configuration option to a
non-zero value exclusively on a node designated for back-end status
synchronization.</p><p>The <code class="literal">fields=status</code> parameter in Networking API requests always
triggers an explicit query to the NSX back end, even when you enable
asynchronous state synchronization. For example, <code class="literal">GET
/v2.0/networks/NET_ID?fields=status&amp;fields=name</code>.</p></div></div><div class="sect3 " id="id-1.4.11.12.7.4"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.9.5.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Big Switch plug-in extensions</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.4">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>This section explains the Big Switch neutron plug-in-specific extension.</p><div class="sect4 " id="id-1.4.11.12.7.4.3"><div class="titlepage"><div><div><h5 class="title"><span class="number">9.9.5.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Big Switch router rules</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.4.3">#</a></h5><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Big Switch allows router rules to be added to each project router. These
rules can be used to enforce routing policies such as denying traffic
between subnets or traffic to external networks. By enforcing these at
the router level, network segmentation policies can be enforced across
many VMs that have differing security groups.</p><div class="sect5 " id="id-1.4.11.12.7.4.3.3"><div class="titlepage"><div><div><h6 class="title"><span class="number">9.9.5.2.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Router rule attributes</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.4.3.3">#</a></h6><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Each project router has a set of router rules associated with it. Each
router rule has the attributes in this table. Router rules and their
attributes can be set using the <code class="command">openstack router set</code> command,
through the horizon interface or the Networking API.</p><div class="table" id="id-1.4.11.12.7.4.3.3.3"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.8: </span><span class="name">Big Switch Router rule attributes </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.4.3.3.3">#</a></h6></div><div class="table-contents"><table class="table" summary="Big Switch Router rule attributes" border="1"><colgroup><col class="c1" /><col class="c2" /><col class="c3" /><col class="c4" /></colgroup><thead><tr><th>
                        <p>Attribute name</p>
                      </th><th>
                        <p>Required</p>
                      </th><th>
                        <p>Input type</p>
                      </th><th>
                        <p>Description</p>
                      </th></tr></thead><tbody><tr><td>
                        <p>source</p>
                      </td><td>
                        <p>Yes</p>
                      </td><td>
                        <p>A valid CIDR or one of the keywords 'any' or 'external'</p>
                      </td><td>
                        <p>The network that a packet's source IP must match for the
rule to be applied.</p>
                      </td></tr><tr><td>
                        <p>destination</p>
                      </td><td>
                        <p>Yes</p>
                      </td><td>
                        <p>A valid CIDR or one of the keywords 'any' or 'external'</p>
                      </td><td>
                        <p>The network that a packet's destination IP must match for the rule to
be applied.</p>
                      </td></tr><tr><td>
                        <p>action</p>
                      </td><td>
                        <p>Yes</p>
                      </td><td>
                        <p>'permit' or 'deny'</p>
                      </td><td>
                        <p>Determines whether or not the matched packets will allowed to cross the
router.</p>
                      </td></tr><tr><td>
                        <p>nexthop</p>
                      </td><td>
                        <p>No</p>
                      </td><td>
                        <p>A plus-separated (+) list of next-hop IP addresses. For example,
<code class="literal">1.1.1.1+1.1.1.2</code>.</p>
                      </td><td>
                        <p>Overrides the default virtual router used to handle traffic for packets
that match the rule.</p>
                      </td></tr></tbody></table></div></div></div><div class="sect5 " id="id-1.4.11.12.7.4.3.4"><div class="titlepage"><div><div><h6 class="title"><span class="number">9.9.5.2.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Order of rule processing</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.4.3.4">#</a></h6><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The order of router rules has no effect. Overlapping rules are evaluated
using longest prefix matching on the source and destination fields. The
source field is matched first so it always takes higher precedence over
the destination field. In other words, longest prefix matching is used
on the destination field only if there are multiple matching rules with
the same source.</p></div><div class="sect5 " id="id-1.4.11.12.7.4.3.5"><div class="titlepage"><div><div><h6 class="title"><span class="number">9.9.5.2.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Big Switch router rules operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.7.4.3.5">#</a></h6><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Router rules are configured with a router update operation in OpenStack
Networking. The update overrides any previous rules so all rules must be
provided at the same time.</p><p>Update a router with rules to permit traffic by default but block
traffic from external networks to the 10.10.10.0/24 subnet:</p><div class="verbatim-wrap"><pre class="screen">$ neutron router-update ROUTER_UUID --router_rules type=dict list=true \
  source=any,destination=any,action=permit \
  source=external,destination=10.10.10.0/24,action=deny</pre></div><p>Specify alternate next-hop addresses for a specific subnet:</p><div class="verbatim-wrap"><pre class="screen">$ neutron router-update ROUTER_UUID --router_rules type=dict list=true  \
  source=any,destination=any,action=permit \
  source=10.10.10.0/24,destination=any,action=permit,nexthops=10.10.10.254+10.10.10.253</pre></div><p>Block traffic between two subnets while allowing everything else:</p><div class="verbatim-wrap"><pre class="screen">$ neutron router-update ROUTER_UUID --router_rules type=dict list=true \
  source=any,destination=any,action=permit \
  source=10.10.10.0/24,destination=10.20.20.20/24,action=deny</pre></div></div></div></div></div><div class="sect2 " id="id-1.4.11.12.8"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.9.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">L3 metering</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.8">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The L3 metering API extension enables administrators to configure IP
ranges and assign a specified label to them to be able to measure
traffic that goes through a virtual router.</p><p>The L3 metering extension is decoupled from the technology that
implements the measurement. Two abstractions have been added: One is the
metering label that can contain metering rules. Because a metering label
is associated with a project, all virtual routers in this project are
associated with this label.</p><div class="sect3 " id="id-1.4.11.12.8.4"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.9.6.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic L3 metering operations</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.8.4">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Only administrators can manage the L3 metering labels and rules.</p><p>This table shows example <code class="command">neutron</code> commands that enable you to
complete basic L3 metering operations:</p><div class="table" id="id-1.4.11.12.8.4.4"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 9.9: </span><span class="name">Basic L3 operations </span><a title="Permalink" class="permalink" href="networking.html#id-1.4.11.12.8.4.4">#</a></h6></div><div class="table-contents"><table class="table" summary="Basic L3 operations" border="1"><colgroup><col class="c1" /><col class="c2" /></colgroup><thead><tr><th>
                    <p>Operation</p>
                  </th><th>
                    <p>Command</p>
                  </th></tr></thead><tbody><tr><td>
                    <p>Creates a metering label.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label create LABEL1 \
  --description "DESCRIPTION_LABEL1"</pre></div>
                  </td></tr><tr><td>
                    <p>Lists metering labels.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label list</pre></div>
                  </td></tr><tr><td>
                    <p>Shows information for a specified label.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label show LABEL_UUID
$ openstack network meter label show LABEL1</pre></div>
                  </td></tr><tr><td>
                    <p>Deletes a metering label.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label delete LABEL_UUID
$ openstack network meter label delete LABEL1</pre></div>
                  </td></tr><tr><td>
                    <p>Creates a metering rule.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label rule create LABEL_UUID \
  --remote-ip-prefix CIDR \
  --direction DIRECTION --exclude</pre></div>
                    <p>For example:</p>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label rule create label1 \
  --remote-ip-prefix 10.0.0.0/24 --direction ingress
$ openstack network meter label rule create label1 \
  --remote-ip-prefix 20.0.0.0/24 --exclude</pre></div>
                  </td></tr><tr><td>
                    <p>Lists metering all label rules.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label rule list</pre></div>
                  </td></tr><tr><td>
                    <p>Shows information for a specified label rule.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label rule show RULE_UUID</pre></div>
                  </td></tr><tr><td>
                    <p>Deletes a metering label rule.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ openstack network meter label rule delete RULE_UUID</pre></div>
                  </td></tr><tr><td>
                    <p>Lists the value of created metering label rules.</p>
                  </td><td>
                    <div class="verbatim-wrap"><pre class="screen">$ ceilometer sample-list -m bandwidth -q resource=LABEL_UUID</pre></div>
                  </td></tr></tbody></table></div></div></div></div></div><div class="sect1 " id="id-1.4.11.13"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.10 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Advanced operational features</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.13">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect2 " id="id-1.4.11.13.2"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.10.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Logging settings</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.13.2">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Networking components use Python logging module to do logging. Logging
configuration can be provided in <code class="literal">neutron.conf</code> or as command-line
options. Command options override ones in <code class="literal">neutron.conf</code>.</p><p>To configure logging for Networking components, use one of these
methods:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>Provide logging settings in a logging configuration file.</p><p>See <a class="link" href="http://docs.python.org/howto/logging.html" target="_blank">Python logging
how-to</a> to learn more
about logging.</p></li><li class="listitem "><p>Provide logging setting in <code class="literal">neutron.conf</code>.</p><div class="verbatim-wrap highlight ini"><pre class="screen">[DEFAULT]
# Default log level is WARNING
# Show debugging output in logs (sets DEBUG log level output)
# debug = False

# log_date_format = %Y-%m-%d %H:%M:%S

# use_syslog = False
# syslog_log_facility = LOG_USER

# if use_syslog is False, we can set log_file and log_dir.
# if use_syslog is False and we do not set log_file,
# the log will be printed to stdout.
# log_file =
# log_dir =</pre></div></li></ul></div></div><div class="sect2 " id="id-1.4.11.13.3"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.10.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Notifications</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.13.3">#</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>Notifications can be sent when Networking resources such as network,
subnet and port are created, updated or deleted.</p><div class="sect3 " id="id-1.4.11.13.3.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.10.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Notification options</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.13.3.3">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>To support DHCP agent, <code class="literal">rpc_notifier</code> driver must be set. To set up the
notification, edit notification options in <code class="literal">neutron.conf</code>:</p><div class="verbatim-wrap highlight ini"><pre class="screen"># Driver or drivers to handle sending notifications. (multi
# valued)
# notification_driver=messagingv2

# AMQP topic used for OpenStack notifications. (list value)
# Deprecated group/name - [rpc_notifier2]/topics
notification_topics = notifications</pre></div></div><div class="sect3 " id="id-1.4.11.13.3.4"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.10.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Setting cases</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.13.3.4">#</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><div class="sect4 " id="id-1.4.11.13.3.4.2"><div class="titlepage"><div><div><h5 class="title"><span class="number">9.10.2.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Logging and RPC</span> <a title="Permalink" class="permalink" href="networking.html#id-1.4.11.13.3.4.2">#</a></h5><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>These options configure the Networking server to send notifications
through logging and RPC. The logging options are described in OpenStack
Configuration Reference. RPC notifications go to <code class="literal">notifications.info</code>
queue bound to a topic exchange defined by <code class="literal">control_exchange</code> in
<code class="literal">neutron.conf</code>.</p><p>
              <span class="bold"><strong>Notification System Options</strong></span>
            </p><p>A notification can be sent when a network, subnet, or port is created,
updated or deleted. The notification system options are:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.1.1.1"><span class="term ">
                      <code class="literal">notification_driver</code>
                    </span></dt><dd><p>Defines the driver or drivers to handle the sending of a notification.
The six available options are:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.1.1.1.2.2.1.1.1"><span class="term ">
                                <code class="literal">messaging</code>
                              </span></dt><dd><p>Send notifications using the 1.0 message format.</p></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.1.1.1.2.2.2.1.1"><span class="term ">
                                <code class="literal">messagingv2</code>
                              </span></dt><dd><p>Send notifications using the 2.0 message format (with a message
envelope).</p></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.1.1.1.2.2.3.1.1"><span class="term ">
                                <code class="literal">routing</code>
                              </span></dt><dd><p>Configurable routing notifier (by priority or event_type).</p></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.1.1.1.2.2.4.1.1"><span class="term ">
                                <code class="literal">log</code>
                              </span></dt><dd><p>Publish notifications using Python logging infrastructure.</p></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.1.1.1.2.2.5.1.1"><span class="term ">
                                <code class="literal">test</code>
                              </span></dt><dd><p>Store notifications in memory for test verification.</p></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.1.1.1.2.2.6.1.1"><span class="term ">
                                <code class="literal">noop</code>
                              </span></dt><dd><p>Disable sending notifications entirely.</p></dd></dl></div></li></ul></div></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.2.1.1"><span class="term ">
                      <code class="literal">default_notification_level</code>
                    </span></dt><dd><p>Is used to form topic names or to set a logging level.</p></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.3.1.1"><span class="term ">
                      <code class="literal">default_publisher_id</code>
                    </span></dt><dd><p>Is a part of the notification payload.</p></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.4.1.1"><span class="term ">
                      <code class="literal">notification_topics</code>
                    </span></dt><dd><p>AMQP topic used for OpenStack notifications. They can be comma-separated
values. The actual topic names will be the values of
<code class="literal">default_notification_level</code>.</p></dd></dl></div></li><li class="listitem "><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.11.13.3.4.2.5.5.1.1"><span class="term ">
                      <code class="literal">control_exchange</code>
                    </span></dt><dd><p>This is an option defined in oslo.messaging. It is the default exchange
under which topics are scoped. May be overridden by an exchange name
specified in the <code class="literal">transport_url</code> option. It is a string value.</p></dd></dl></div></li></ul></div><p>Below is a sample <code class="literal">neutron.conf</code> configuration file:</p><div class="verbatim-wrap highlight ini"><pre class="screen">notification_driver = messagingv2

default_notification_level = INFO

host = myhost.com
default_publisher_id = $host

notification_topics = notifications

control_exchange = openstack</pre></div></div></div></div></div><div class="sect1 " id="authentication-and-authorization"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.11 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Authentication and authorization</span> <a title="Permalink" class="permalink" href="networking.html#authentication-and-authorization">#</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>bk_openstack_admin.xml</li><li><span class="ds-label">ID: </span>authentication-and-authorization</li></ul></div></div></div></div><p>Networking uses the Identity service as the default authentication
service. When the Identity service is enabled, users who submit requests
to the Networking service must provide an authentication token in
<code class="literal">X-Auth-Token</code> request header. Users obtain this token by
authenticating with the Identity service endpoint. For more information
about authentication with the Identity service, see <a class="link" href="http://developer.openstack.org/api-ref/identity/v2/" target="_blank">OpenStack Identity
service API v2.0
Reference</a>.
When the Identity service is enabled, it is not mandatory to specify the
project ID for resources in create requests because the project ID is
derived from the authentication token.</p><p>The default authorization settings only allow administrative users
to create resources on behalf of a different project. Networking uses
information received from Identity to authorize user requests.
Networking handles two kind of authorization policies:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="bold"><strong>Operation-based</strong></span> policies specify access criteria for specific
operations, possibly with fine-grained control over specific
attributes.</p></li><li class="listitem "><p><span class="bold"><strong>Resource-based</strong></span> policies specify whether access to specific
resource is granted or not according to the permissions configured
for the resource (currently available only for the network resource).
The actual authorization policies enforced in Networking might vary
from deployment to deployment.</p></li></ul></div><p>The policy engine reads entries from the <code class="literal">policy.json</code> file. The
actual location of this file might vary from distribution to
distribution. Entries can be updated while the system is running, and no
service restart is required. Every time the policy file is updated, the
policies are automatically reloaded. Currently the only way of updating
such policies is to edit the policy file. In this section, the terms
<span class="emphasis"><em>policy</em></span> and <span class="emphasis"><em>rule</em></span> refer to objects that are specified in the same way
in the policy file. There are no syntax differences between a rule and a
policy. A policy is something that is matched directly from the
Networking policy engine. A rule is an element in a policy, which is
evaluated. For instance in <code class="literal">"create_subnet":
"rule:admin_or_network_owner"</code>, <span class="emphasis"><em>create_subnet</em></span> is a
policy, and <span class="emphasis"><em>admin_or_network_owner</em></span> is a rule.</p><p>Policies are triggered by the Networking policy engine whenever one of
them matches a Networking API operation or a specific attribute being
used in a given operation. For instance the <code class="literal">create_subnet</code> policy is
triggered every time a <code class="literal">POST /v2.0/subnets</code> request is sent to the
Networking server; on the other hand <code class="literal">create_network:shared</code> is
triggered every time the <span class="emphasis"><em>shared</em></span> attribute is explicitly specified (and
set to a value different from its default) in a <code class="literal">POST /v2.0/networks</code>
request. It is also worth mentioning that policies can also be related
to specific API extensions; for instance
<code class="literal">extension:provider_network:set</code> is triggered if the attributes
defined by the Provider Network extensions are specified in an API
request.</p><p>An authorization policy can be composed by one or more rules. If more
rules are specified then the evaluation policy succeeds if any of the
rules evaluates successfully; if an API operation matches multiple
policies, then all the policies must evaluate successfully. Also,
authorization rules are recursive. Once a rule is matched, the rule(s)
can be resolved to another rule, until a terminal rule is reached.</p><p>The Networking policy engine currently defines the following kinds of
terminal rules:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p><span class="bold"><strong>Role-based rules</strong></span> evaluate successfully if the user who submits
the request has the specified role. For instance <code class="literal">"role:admin"</code> is
successful if the user who submits the request is an administrator.</p></li><li class="listitem "><p><span class="bold"><strong>Field-based rules</strong></span> evaluate successfully if a field of the
resource specified in the current request matches a specific value.
For instance <code class="literal">"field:networks:shared=True"</code> is successful if the
<code class="literal">shared</code> attribute of the <code class="literal">network</code> resource is set to true.</p></li><li class="listitem "><p><span class="bold"><strong>Generic rules</strong></span> compare an attribute in the resource with an
attribute extracted from the user's security credentials and
evaluates successfully if the comparison is successful. For instance
<code class="literal">"tenant_id:%(tenant_id)s"</code> is successful if the project identifier
in the resource is equal to the project identifier of the user
submitting the request.</p></li></ul></div><p>This extract is from the default <code class="literal">policy.json</code> file:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>A rule that evaluates successfully if the current user is an
administrator or the owner of the resource specified in the request
(project identifier is equal).</p><div class="verbatim-wrap highlight json"><pre class="screen">{
 "admin_or_owner": [
     [
         "role:admin"
     ],
     [
         "tenant_id:%(tenant_id)s"
     ]
 ],
 "admin_or_network_owner": [
     [
         "role:admin"
     ],
     [
         "tenant_id:%(network_tenant_id)s"
     ]
 ],
 "admin_only": [
     [
         "role:admin"
 ]
 ],
 "regular_user": [],
 "shared": [
     [
         "field:networks:shared=True"
     ]
 ],
 "default": [
     [</pre></div></li><li class="listitem "><p>The default policy that is always evaluated if an API operation does
not match any of the policies in <code class="literal">policy.json</code>.</p><div class="verbatim-wrap highlight json"><pre class="screen">        "rule:admin_or_owner"
    ]
],
"create_subnet": [
    [
        "rule:admin_or_network_owner"
    ]
],
"get_subnet": [
    [
        "rule:admin_or_owner"
    ],
    [
        "rule:shared"
    ]
],
"update_subnet": [
    [
        "rule:admin_or_network_owner"
    ]
],
"delete_subnet": [
    [
        "rule:admin_or_network_owner"
    ]
],
"create_network": [],
"get_network": [
    [
        "rule:admin_or_owner"
    ],</pre></div></li><li class="listitem "><p>This policy evaluates successfully if either <span class="emphasis"><em>admin_or_owner</em></span>, or
<span class="emphasis"><em>shared</em></span> evaluates successfully.</p><div class="verbatim-wrap highlight json"><pre class="screen">    [
        "rule:shared"
    ]
],
"create_network:shared": [
    [
        "rule:admin_only"
    ]</pre></div></li><li class="listitem "><p>This policy restricts the ability to manipulate the <span class="emphasis"><em>shared</em></span>
attribute for a network to administrators only.</p><div class="verbatim-wrap highlight json"><pre class="screen">],
"update_network": [
    [
        "rule:admin_or_owner"
    ]
],
"delete_network": [
    [
        "rule:admin_or_owner"
    ]
],
"create_port": [],
"create_port:mac_address": [
    [
        "rule:admin_or_network_owner"
    ]
],
"create_port:fixed_ips": [</pre></div></li><li class="listitem "><p>This policy restricts the ability to manipulate the <span class="emphasis"><em>mac_address</em></span>
attribute for a port only to administrators and the owner of the
network where the port is attached.</p><div class="verbatim-wrap highlight json"><pre class="screen">     [
         "rule:admin_or_network_owner"
     ]
 ],
 "get_port": [
     [
         "rule:admin_or_owner"
     ]
 ],
 "update_port": [
     [
         "rule:admin_or_owner"
     ]
 ],
  "delete_port": [
     [
         "rule:admin_or_owner"
     ]
 ]
}</pre></div></li></ul></div><p>In some cases, some operations are restricted to administrators only.
This example shows you how to modify a policy file to permit project to
define networks, see their resources, and permit administrative users to
perform all other operations:</p><div class="verbatim-wrap highlight ini"><pre class="screen">{
        "admin_or_owner": [["role:admin"], ["tenant_id:%(tenant_id)s"]],
        "admin_only": [["role:admin"]], "regular_user": [],
        "default": [["rule:admin_only"]],
        "create_subnet": [["rule:admin_only"]],
        "get_subnet": [["rule:admin_or_owner"]],
        "update_subnet": [["rule:admin_only"]],
        "delete_subnet": [["rule:admin_only"]],
        "create_network": [],
        "get_network": [["rule:admin_or_owner"]],
        "create_network:shared": [["rule:admin_only"]],
        "update_network": [["rule:admin_or_owner"]],
        "delete_network": [["rule:admin_or_owner"]],
        "create_port": [["rule:admin_only"]],
        "get_port": [["rule:admin_or_owner"]],
        "update_port": [["rule:admin_only"]],
        "delete_port": [["rule:admin_only"]]
}</pre></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="bk02ch10.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 10 </span>Telemetry</span></a><a class="nav-link" href="bk02ch08.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 8 </span>Shared File Systems</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2021 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>