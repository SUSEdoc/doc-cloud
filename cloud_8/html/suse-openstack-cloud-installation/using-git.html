<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>SUSE OpenStack Cloud 8 | Installing with Cloud Lifecycle Manager | Using Git for Configuration Management</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Using Git for Configuration Management | SUSE OpenStac…"/>
<meta name="description" content="In SUSE OpenStack Cloud 8, a local git repository is used to track configuration changes; the Configuration Processor (CP) uses this repository. Use …"/>
<meta name="product-name" content="SUSE OpenStack Cloud"/>
<meta name="product-number" content="8"/>
<meta name="book-title" content="Installing with Cloud Lifecycle Manager"/>
<meta name="chapter-title" content="Chapter 10. Using Git for Configuration Management"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 8"/>
<meta property="og:title" content="Using Git for Configuration Management | SUSE OpenStac…"/>
<meta property="og:description" content="In SUSE OpenStack Cloud 8, a local git repository is used to track configuration changes; the Configuration Processor (CP) uses this repository. Use …"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using Git for Configuration Management | SUSE OpenStac…"/>
<meta name="twitter:description" content="In SUSE OpenStack Cloud 8, a local git repository is used to track configuration changes; the Configuration Processor (CP) uses this repository. Use …"/>
<link rel="prev" href="install-gui.html" title="Chapter 9. Installing with the Install UI"/><link rel="next" href="install-standalone.html" title="Chapter 11. Installing a Stand-Alone Cloud Lifecycle Manager"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Installing with Cloud Lifecycle Manager</a><span> / </span><a class="crumb" href="cloudinstallation.html">Cloud Installation</a><span> / </span><a class="crumb" href="using-git.html">Using Git for Configuration Management</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title"><em class="citetitle">Installing with Cloud Lifecycle Manager</em></div><ol><li><a href="install-overview.html" class=" "><span class="title-number"> </span><span class="title-name">Installation Overview</span></a></li><li><a href="preinstall.html" class="has-children "><span class="title-number">I </span><span class="title-name">Pre-Installation</span></a><ol><li><a href="preinstall-overview.html" class=" "><span class="title-number">1 </span><span class="title-name">Overview</span></a></li><li><a href="preinstall-checklist.html" class=" "><span class="title-number">2 </span><span class="title-name">Pre-Installation Checklist</span></a></li><li><a href="cha-depl-dep-inst.html" class=" "><span class="title-number">3 </span><span class="title-name">Installing the Cloud Lifecycle Manager server</span></a></li><li><a href="app-deploy-smt-lcm.html" class=" "><span class="title-number">4 </span><span class="title-name">Installing and Setting Up an SMT Server on the Cloud Lifecycle Manager server (Optional)</span></a></li><li><a href="cha-depl-repo-conf-lcm.html" class=" "><span class="title-number">5 </span><span class="title-name">Software Repository Setup</span></a></li><li><a href="multipath-boot-from-san.html" class=" "><span class="title-number">6 </span><span class="title-name">Boot from SAN and Multipath Configuration</span></a></li></ol></li><li class="active"><a href="cloudinstallation.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Cloud Installation</span></a><ol><li><a href="cloudinstallation-overview.html" class=" "><span class="title-number">7 </span><span class="title-name">Overview</span></a></li><li><a href="preparing-standalone.html" class=" "><span class="title-number">8 </span><span class="title-name">Preparing for Stand-Alone Deployment</span></a></li><li><a href="install-gui.html" class=" "><span class="title-number">9 </span><span class="title-name">Installing with the Install UI</span></a></li><li><a href="using-git.html" class=" you-are-here"><span class="title-number">10 </span><span class="title-name">Using Git for Configuration Management</span></a></li><li><a href="install-standalone.html" class=" "><span class="title-number">11 </span><span class="title-name">Installing a Stand-Alone Cloud Lifecycle Manager</span></a></li><li><a href="install-kvm.html" class=" "><span class="title-number">12 </span><span class="title-name">Installing Mid-scale and Entry-scale KVM</span></a></li><li><a href="DesignateInstallOverview.html" class=" "><span class="title-number">13 </span><span class="title-name">DNS Service Installation Overview</span></a></li><li><a href="MagnumOverview.html" class=" "><span class="title-number">14 </span><span class="title-name">Magnum Overview</span></a></li><li><a href="install-esx-ovsvapp.html" class=" "><span class="title-number">15 </span><span class="title-name">Installing ESX Computes and OVSvAPP</span></a></li><li><a href="integrate-nsx-vsphere.html" class=" "><span class="title-number">16 </span><span class="title-name">Integrating NSX for vSphere</span></a></li><li><a href="install-ironic-overview.html" class=" "><span class="title-number">17 </span><span class="title-name">Installing Baremetal (Ironic)</span></a></li><li><a href="install-swift.html" class=" "><span class="title-number">18 </span><span class="title-name">Installation for <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> Entry-scale Cloud with Swift Only</span></a></li><li><a href="install-sles-compute.html" class=" "><span class="title-number">19 </span><span class="title-name">Installing SLES Compute</span></a></li><li><a href="install-ardana-manila.html" class=" "><span class="title-number">20 </span><span class="title-name">Installing Manila and Creating Manila Shares</span></a></li><li><a href="install-heat-templates.html" class=" "><span class="title-number">21 </span><span class="title-name">Installing SUSE CaaS Platform Heat Templates</span></a></li><li><a href="integrations.html" class=" "><span class="title-number">22 </span><span class="title-name">Integrations</span></a></li><li><a href="troubleshooting-installation.html" class=" "><span class="title-number">23 </span><span class="title-name">Troubleshooting the Installation</span></a></li><li><a href="esx-troubleshooting-installation.html" class=" "><span class="title-number">24 </span><span class="title-name">Troubleshooting the ESX</span></a></li></ol></li><li><a href="post-install.html" class="has-children "><span class="title-number">III </span><span class="title-name">Post-Installation</span></a><ol><li><a href="post-install-overview.html" class=" "><span class="title-number">25 </span><span class="title-name">Overview</span></a></li><li><a href="cloud-verification.html" class=" "><span class="title-number">26 </span><span class="title-name">Cloud Verification</span></a></li><li><a href="ui-verification.html" class=" "><span class="title-number">27 </span><span class="title-name">UI Verification</span></a></li><li><a href="install-openstack-clients.html" class=" "><span class="title-number">28 </span><span class="title-name">Installing OpenStack Clients</span></a></li><li><a href="tls30.html" class=" "><span class="title-number">29 </span><span class="title-name">Configuring Transport Layer Security (TLS)</span></a></li><li><a href="config-availability-zones.html" class=" "><span class="title-number">30 </span><span class="title-name">Configuring Availability Zones</span></a></li><li><a href="OctaviaInstall.html" class=" "><span class="title-number">31 </span><span class="title-name">Configuring Load Balancer as a Service</span></a></li><li><a href="postinstall-checklist.html" class=" "><span class="title-number">32 </span><span class="title-name">Other Common Post-Installation Tasks</span></a></li></ol></li><li><a href="cha-inst-trouble.html" class=" "><span class="title-number">33 </span><span class="title-name">Support</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="using-git" data-id-title="Using Git for Configuration Management"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span></span> <span class="productnumber"><span class="phrase"><span class="phrase">8</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">10 </span><span class="title-name">Using Git for Configuration Management</span></span> <a title="Permalink" class="permalink" href="using-git.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  In <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span>, a local git repository is used to track configuration
  changes; the Configuration Processor (CP) uses this repository. Use of a git
  workflow means that your configuration history is maintained, making
  rollbacks easier and keeping a record of previous configuration settings. The
  git repository also provides a way for you to merge changes that you pull down as
  <span class="quote">“<span class="quote">upstream</span>”</span> updates (that is, updates from <span class="phrase"><span class="phrase">SUSE</span></span>). It also
  allows you to manage your own configuration changes.
 </p><p>
  The git repository is installed by the Cloud Lifecycle Manager on the Cloud Lifecycle Manager node.
 </p><section class="sect1" id="id-1.4.5.5.4" data-id-title="Initialization on a new deployment"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">10.1 </span><span class="title-name">Initialization on a new deployment</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.4">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   On a system new to <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span>, the Cloud Lifecycle Manager will prepare a git repository
   under <code class="literal">~/openstack</code>. The Cloud Lifecycle Manager provisioning runs the
   <code class="literal">ardana-init-deployer</code> script automatically. This calls
   <code class="literal">ansible-playbook -i hosts/localhost git-00-initialise.yml</code>.
  </p><p>
   As a result, the <code class="literal">~/openstack</code> directory is initialized as
   a git repo (if it is empty). It is initialized with four empty branches:
  </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.4.5.5.4.4.1"><span class="term">ardana</span></dt><dd><p>
      This holds the upstream source code corresponding to the contents of the
      <code class="literal">~/openstack</code> directory on a pristine installation.
      Every source code release that is downloaded from <span class="phrase"><span class="phrase">SUSE</span></span> is applied as
      a fresh commit to this branch. This branch contains no customization by
      the end user.
     </p></dd><dt id="id-1.4.5.5.4.4.2"><span class="term">site</span></dt><dd><p>
      This branch begins life as a copy of the first <code class="literal">ardana</code>
      drop. It is onto this branch that you commit your configuration changes.
      It is the branch most visible to the end user.
     </p></dd><dt id="id-1.4.5.5.4.4.3"><span class="term">ansible</span></dt><dd><p>
      This branch contains the variable definitions generated by the CP that
      our main ansible playbooks need. This includes the
      <code class="literal">verb_hosts</code> file that describes to ansible what servers
      are playing what roles. The <code class="literal">ready-deployment</code> playbook
      takes this output and assembles a <code class="literal">~/scratch</code> directory
      containing the ansible playbooks together with the variable definitions
      in this branch. The result is a working ansible directory
      <code class="literal">~/scratch/ansible/next/ardana/ansible</code> from which the
      main deployment playbooks may be successfully run.
     </p></dd><dt id="id-1.4.5.5.4.4.4"><span class="term">cp-persistent</span></dt><dd><p>
      This branch contains the persistent state that the CP needs to maintain.
      That state is mostly the assignment of IP addresses and roles to
      particular servers. Some operational procedures may involve editing the
      contents of this branch: for example, retiring a machine from service or
      repurposing it.
     </p></dd></dl></div><p>
   Two temporary branches are created and populated at run time:
  </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.4.5.5.4.6.1"><span class="term">staging-ansible</span></dt><dd><p>
      This branch hosts the most recent commit that will be appended to the
      Ansible branch.
     </p></dd><dt id="id-1.4.5.5.4.6.2"><span class="term">staging-cp-persistent</span></dt><dd><p>
      This branch hosts the most recent commit that will be appended to the
      cp-persistent branch.
     </p></dd></dl></div><div id="id-1.4.5.5.4.7" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>
    The information above provides insight into the workings of the
    configuration processor and the git repository. However, in practice you
    can simply follow the steps below to make configuration changes.
   </p></div></section><section class="sect1" id="updating-configuration-including-default-config" data-id-title="Updating any configuration, including the default configuration"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">10.2 </span><span class="title-name">Updating any configuration, including the default configuration</span></span> <a title="Permalink" class="permalink" href="using-git.html#updating-configuration-including-default-config">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   When you need to make updates to a configuration you must:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Check out the <code class="literal">site</code> branch. You may already be on that
     branch. If so, git will tell you that and the command will leave you
     there.
    </p><div class="verbatim-wrap"><pre class="screen">git checkout site</pre></div></li><li class="step"><p>
     Edit the YAML file or files that contain the configuration you want to
     change.
    </p></li><li class="step"><p>
     Commit the changes to the <code class="literal">site</code> branch.
    </p><div class="verbatim-wrap"><pre class="screen">git add -A
git commit -m "your commit message goes here in quotes"</pre></div><p>
     If you want to add a single file to your git repository, you can use the
     command below, as opposed to using <code class="command">git add -A</code>.
    </p><div class="verbatim-wrap"><pre class="screen">git add PATH_TO_FILE</pre></div><p>
     For example, if you made a change to your <code class="command">servers.yml</code>
     file and wanted to only commit that change, you would use this command:
    </p><div class="verbatim-wrap"><pre class="screen">git add ~/openstack/my_cloud/definition/data/servers.yml</pre></div></li><li class="step"><p>
     To produce the required configuration processor output from those changes.
     Review the output files manually if required, run the configuration
     processor:
    </p><div class="verbatim-wrap"><pre class="screen">cd ~/openstack/ardana/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml</pre></div></li><li class="step"><p>
     Ready the deployment area
    </p><div class="verbatim-wrap"><pre class="screen">ansible-playbook -i hosts/localhost ready-deployment.yml</pre></div></li><li class="step"><p>
     Run the deployment playbooks from the resulting scratch directory.
    </p><div class="verbatim-wrap"><pre class="screen">cd ~/scratch/ansible/next/ardana/ansible
ansible-playbook -i hosts/verb_hosts site.yml</pre></div></li></ol></div></div></section><section class="sect1" id="git-merge" data-id-title="Resolving Git merge conflicts"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">10.3 </span><span class="title-name">Resolving Git merge conflicts</span></span> <a title="Permalink" class="permalink" href="using-git.html#git-merge">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   When you make changes, <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> attempts to incorporate new or updated
   configuration information on top of your existing environment. However, with
   some changes to your environment, <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> cannot automatically
   determine whether to keep your changes or drop them in favor of the new or
   updated configurations. This will result in <code class="literal">merge
   conflicts</code>, and it will be up to you to manually resolve the
   conflicts before you can proceed. This is common, but it can be
   confusing. Git provides a way to resolve these situations.
  </p><p>
   This section gives an overview of how to approach the issue of merge
   conflicts, showing general procedures for determining where the conflict is
   occurring, alternative methods for resolution, and a fallback procedure for
   the case where the resolution goes wrong and you need to start changes from
   the beginning.
  </p><p>
   For a general overview of how <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> uses Git, see the introductory
   article <a class="xref" href="using-git.html" title="Chapter 10. Using Git for Configuration Management">Chapter 10, <em>Using Git for Configuration Management</em></a>. In particular, note how the
   <code class="literal">site</code> branch is the one most used by the end-user, while
   the <code class="literal">ardana</code> branch contains the "upstream" source code
   corresponding to the contents of the <code class="literal">~/openstack</code>
   directory on a pristine fresh installation.
  </p><section class="sect2" id="id-1.4.5.5.6.5" data-id-title="Identifying the occurrence of a merge conflict"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.1 </span><span class="title-name">Identifying the occurrence of a <code class="literal">merge conflict</code></span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.5">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   If you get a <code class="literal">merge conflict</code>, you will observe output
   similar to the following on the console:
  </p><div class="verbatim-wrap"><pre class="screen">Auto-merging ardana/ansible/roles/nova-compute-esx/defaults/main.yml
Auto-merging ardana/ansible/roles/nova-common/templates/nova.conf.j2
<span class="bold"><strong>CONFLICT (content): Merge conflict in ardana/ansible/roles/nova-common/templates/nova.conf.j2</strong></span>
Auto-merging ardana/ansible/roles/nova-cli/tasks/availability_zones.yml
Auto-merging ardana/ansible/roles/nova-api/templates/api-paste.ini.j2</pre></div></section><section class="sect2" id="id-1.4.5.5.6.6" data-id-title="Examining Conflicts"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.2 </span><span class="title-name">Examining Conflicts</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.6">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Use <code class="literal">git status</code> to discover the source of the problem:
  </p><div class="verbatim-wrap"><pre class="screen">...
        new file:   tech-preview/entry-scale-kvm-mml/data/swift/rings.yml
        modified:   tech-preview/mid-scale/README.md
        modified:   tech-preview/mid-scale/data/control_plane.yml

Unmerged paths:
  (use "git add/rm &lt;file&gt;..." as appropriate to mark resolution)

        <span class="bold"><strong>both modified:   ardana/ansible/roles/nova-common/templates/nova.conf.j2</strong></span></pre></div><p>
   Edit the file
   <code class="literal">ardana/ansible/roles/nova-common/templates/nova.conf.j2</code>
   to see the conflict markers:
  </p><div class="verbatim-wrap"><pre class="screen">[neutron]
admin_auth_url = {{ neutron_admin_auth_url }}
admin_password = {{ neutron_admin_password }}
admin_tenant_name = {{ neutron_admin_tenant_name }}
admin_username = {{ neutron_admin_username }}
<span class="bold"><strong>&lt;&lt;&lt;&lt;&lt;&lt;&lt;HEAD
metadata_proxy_shared_secret = top_secret_password111
=======
metadata_proxy_shared_secret = {{ neutron_metadata_proxy_shared_secret }}
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ardana</strong></span>
neutron_auth_strategy = keystone
neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt
service_metadata_proxy = True</pre></div><p>
   This indicates that <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span>is trying to set the value of
   <code class="literal">metadata_proxy_shared_secret</code> to be <code class="literal">{{
   neutron_metadata_proxy_shared_secret }}</code> whereas previously you
   have set its value to <code class="literal">top_secret_password111</code>.
  </p></section><section class="sect2" id="id-1.4.5.5.6.7" data-id-title="Examining differences between your current version and the previous upstream version"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.3 </span><span class="title-name">Examining differences between your current version and the previous upstream version</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.7">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Typically, the previous upstream version will be the last-but-one commit on
   the <code class="literal">ardana</code> branch. This version will have been created
   during the initial installation of your cloud (or perhaps during a previous
   upgrade or configuration change). So in total, there are three significant
   versions of the file:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     The previous "upstream" version on the <code class="literal">ardana</code> branch.
    </p></li><li class="listitem"><p>
     Your current version on the <code class="literal">site</code> branch.
    </p></li><li class="listitem"><p>
     The new "upstream" version on the <code class="literal">ardana</code> branch.
    </p></li></ul></div><p>
   You can identify the commit number of the previous "upstream" version using
   <code class="literal">git merge-base</code>.
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git merge-base ardana site
<span class="bold"><strong>2eda1df48e2822533c50f80f5bfd7a9d788bdf73</strong></span></pre></div><p>
   And then use <code class="literal">git log</code> to see where this commit occurs in
   the history of the <code class="literal">ardana</code> branch.
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git log ardana --
commit 22cfa83f3526baf30b3697e971a712930f86f611
Author: Openstack git user &lt;openstack@example.com&gt;
Date:   Mon Jan 18 00:30:33 2018 +0000

    New drop

commit <span class="bold"><strong>2eda1df48e2822533c50f80f5bfd7a9d788bdf73</strong></span>
Author: Openstack git user &lt;openstack@example.com&gt;
Date:   Sun Jan 17 19:14:01 2018 +0000

    New drop</pre></div><p>
   In this instance, we can see that the relevant commit is in fact the
   last-but-one commit. We can use the simplified name
   <code class="literal">ardana^1</code> to identify that commit.
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git diff <span class="bold"><strong>ardana^1</strong></span> HEAD -- ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><p>
   In the diff output, you should be able to see how you changed the value for
   <code class="literal">metadata_proxy_shared_secret</code> from
   <code class="literal">unset</code> to <code class="literal">top_secret_password111</code>:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>diff --git a/ardana/ansible/roles/nova-common/templates/nova.conf.j2 b/ardana/ansible/roles/nova-common/templates/nova.conf.j2
index 597a982..05cb07c 100644
--- a/ardana/ansible/roles/nova-common/templates/nova.conf.j2
+++ b/ardana/ansible/roles/nova-common/templates/nova.conf.j2
@@ -132,7 +132,7 @@ admin_auth_url = {{ neutron_admin_auth_url }}
 admin_password = {{ neutron_admin_password }}
 admin_tenant_name = {{ neutron_admin_tenant_name }}
 admin_username = {{ neutron_admin_username }}
<span class="bold"><strong>-metadata_proxy_shared_secret = unset
+metadata_proxy_shared_secret = top_secret_password111</strong></span>
 neutron_auth_strategy = keystone
 neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt
 service_metadata_proxy = True</pre></div></section><section class="sect2" id="id-1.4.5.5.6.8" data-id-title="Examining differences between your current version and the new upstream version"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.4 </span><span class="title-name">Examining differences between your current version and the new upstream version</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.8">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To compare your change with the new upstream version from <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span> on
   the <code class="literal">ardana</code> branch you can use <code class="literal">git diff HEAD
   ardana -- &lt;&lt;path/to/file&gt;&gt;</code>:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git diff HEAD ardana -- ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><p>
   In the extract of output below, you can see your value
   <code class="literal">top_secret_password111</code> and the new value <code class="literal">{{
   neutron_metadata_proxy_shared_secret }}</code> that <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span> wants
   to set.
  </p><div class="verbatim-wrap"><pre class="screen">..
 admin_username = {{ neutron_admin_username }}
<span class="bold"><strong>-metadata_proxy_shared_secret = top_secret_password111
+metadata_proxy_shared_secret = {{ neutron_metadata_proxy_shared_secret }}</strong></span>
 neutron_auth_strategy = keystone
 neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt</pre></div></section><section class="sect2" id="id-1.4.5.5.6.9" data-id-title="Examining differences between the new upstream version and the previous upstream version"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.5 </span><span class="title-name">Examining differences between the new upstream version and the previous upstream version</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.9">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To compare the new upstream version from <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span> with the previous
   upstream version from your initial install (or previous change):
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git diff $(git merge-base ardana HEAD) ardana -- ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><p>
   In the extract of output below, you can see the new upstream value
   <code class="literal">{{ neutron_metadata_proxy_shared_secret }}</code> that
   <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span> wants to set and the previous upstream value
   <code class="literal">unset</code>.
  </p><div class="verbatim-wrap"><pre class="screen"> admin_password = {{ neutron_admin_password }}
 admin_tenant_name = {{ neutron_admin_tenant_name }}
 admin_username = {{ neutron_admin_username }}
<span class="bold"><strong>-metadata_proxy_shared_secret = unset
+metadata_proxy_shared_secret = {{ neutron_metadata_proxy_shared_secret }}</strong></span>
 neutron_auth_strategy = keystone
 neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt</pre></div></section><section class="sect2" id="id-1.4.5.5.6.10" data-id-title="Using stage markers to view clean versions of files (without conflict markers)"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.6 </span><span class="title-name">Using <code class="literal">stage markers</code> to view clean versions of files (without conflict markers)</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.10">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   You can use the <code class="literal">git show</code> command with stage markers to
   view files without having conflict markers embedded in them. Stage 1 is the
   previous upstream version (<span class="bold"><strong>:1</strong></span>), stage 2 is
   your current version (<span class="bold"><strong>:2</strong></span>) while stage 3 is
   the new upstream version (<span class="bold"><strong>:3</strong></span>).
  </p><p>
   <span class="bold"><strong>Stage 1</strong></span>
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git show <span class="bold"><strong>:1</strong></span>:ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><div class="verbatim-wrap"><pre class="screen">...
admin_username = {{ neutron_admin_username }}
<span class="bold"><strong>metadata_proxy_shared_secret = unset</strong></span>
neutron_auth_strategy = keystone
neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt
...</pre></div><p>
   <span class="bold"><strong>Stage 2</strong></span>
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git show <span class="bold"><strong>:2</strong></span>:ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><div class="verbatim-wrap"><pre class="screen">...
admin_username = {{ neutron_admin_username }}
<span class="bold"><strong>metadata_proxy_shared_secret = top_secret_password111</strong></span>
neutron_auth_strategy = keystone
neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt
...</pre></div><p>
   <span class="bold"><strong>Stage 3</strong></span>
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git show <span class="bold"><strong>:3</strong></span>:ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><div class="verbatim-wrap"><pre class="screen">...
admin_username = {{ neutron_admin_username }}
<span class="bold"><strong>metadata_proxy_shared_secret = {{ neutron_metadata_proxy_shared_secret }}</strong></span>
neutron_auth_strategy = keystone
neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt
...</pre></div></section><section class="sect2" id="id-1.4.5.5.6.11" data-id-title="Resolving the conflict"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.7 </span><span class="title-name">Resolving the conflict</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.11">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   There are two approaches to resolving the conflict:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
     Edit the merged file containing the conflict markers, keeping the change
     you want to preserve and removing the conflict markers and any changes you
     want to discard.
    </p></li><li class="listitem"><p>
     Take the new upstream version of the file and re-apply any changes you
     would like to keep from your current version.
    </p></li></ol></div></section><section class="sect2" id="id-1.4.5.5.6.12" data-id-title="Resolving the conflict - editing the file containing the conflict markers"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.8 </span><span class="title-name">Resolving the conflict - editing the file containing the conflict markers</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.12">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Edit the file
   <code class="literal">ardana/ansible/roles/nova-common/templates/nova.conf.j2</code>
   and if you want to maintain your change, then delete the lines in bold
   below:
  </p><div class="verbatim-wrap"><pre class="screen">[neutron]
admin_auth_url = {{ neutron_admin_auth_url }}
admin_password = {{ neutron_admin_password }}
admin_tenant_name = {{ neutron_admin_tenant_name }}
admin_username = {{ neutron_admin_username }}
<span class="bold"><strong>&lt;&lt;&lt;&lt;&lt;&lt;&lt;HEAD</strong></span>
metadata_proxy_shared_secret = top_secret_password111
<span class="bold"><strong>=======
metadata_proxy_shared_secret = {{ neutron_metadata_proxy_shared_secret }}
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ardana</strong></span>
neutron_auth_strategy = keystone
neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt
service_metadata_proxy = True</pre></div><p>
   Your file should now look like this:
  </p><div class="verbatim-wrap"><pre class="screen">[neutron]
admin_auth_url = {{ neutron_admin_auth_url }}
admin_password = {{ neutron_admin_password }}
admin_tenant_name = {{ neutron_admin_tenant_name }}
admin_username = {{ neutron_admin_username }}
metadata_proxy_shared_secret = top_secret_password111
neutron_auth_strategy = keystone
neutron_ca_certificates_file = /etc/ssl/certs/ca-certificates.crt
service_metadata_proxy = True</pre></div></section><section class="sect2" id="id-1.4.5.5.6.13" data-id-title="Resolving the conflict - re-applying your changes to new upstream version"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.9 </span><span class="title-name">Resolving the conflict - re-applying your changes to new upstream version</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.13">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Create a copy of the new upstream version (see Stage 3 above) in your
   working directory:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git show <span class="bold"><strong>:3</strong></span>:ardana/ansible/roles/nova-common/templates/nova.conf.j2 &gt; \
ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><p>
   Now edit the file
   <code class="literal">ardana/ansible/roles/nova-common/templates/nova.conf.j2</code>
   and manually re-apply the changes you want.
  </p></section><section class="sect2" id="id-1.4.5.5.6.14" data-id-title="Completing the merge procedure"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.10 </span><span class="title-name">Completing the merge procedure</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.14">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   You may want to check that the changes you have applied are correct. Compare
   the new upstream version with the version in your working directory:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git diff ardana -- ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><p>
   If you are happy with the resolution, you can stage your changes using:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git add ardana/ansible/roles/nova-common/templates/nova.conf.j2</pre></div><p>
   Apply the above steps to all the merge conflicts you encounter, and when you
   have them resolved to your satisfaction, complete the merge:
  </p><div class="verbatim-wrap"><pre class="screen">git commit -m "complete merge"</pre></div></section><section class="sect2" id="id-1.4.5.5.6.15" data-id-title="Recovering from Errors"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">10.3.11 </span><span class="title-name">Recovering from Errors</span></span> <a title="Permalink" class="permalink" href="using-git.html#id-1.4.5.5.6.15">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/installation-installation-using_git.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   If you make a mistake during the resolution process, you can return your
   working directory to a clean copy of the <code class="literal">site</code> branch
   using:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git reset --hard</pre></div><p>
   If the new upstream version contains files that did not exist in the previous
   version, these files will be left behind - you can see them using
   <code class="literal">git status</code>. To clean up these files, remove them and then
   reset:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>git rm -rf ardana
<code class="prompt user">tux &gt; </code>git reset --hard</pre></div><p>
   Alternatively, you can use <code class="literal">git stash</code> to save these files
   to a transient stash queue.
  </p></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="install-gui.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 9 </span>Installing with the Install UI</span></a> </div><div><a class="pagination-link next" href="install-standalone.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 11 </span>Installing a Stand-Alone Cloud Lifecycle Manager</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="using-git.html#id-1.4.5.5.4"><span class="title-number">10.1 </span><span class="title-name">Initialization on a new deployment</span></a></span></li><li><span class="section"><a href="using-git.html#updating-configuration-including-default-config"><span class="title-number">10.2 </span><span class="title-name">Updating any configuration, including the default configuration</span></a></span></li><li><span class="section"><a href="using-git.html#git-merge"><span class="title-number">10.3 </span><span class="title-name">Resolving Git merge conflicts</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>