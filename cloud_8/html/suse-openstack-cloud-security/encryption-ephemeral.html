<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>SUSE OpenStack Cloud 8 | Security Guide | Encryption of Ephemeral Volumes</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Encryption of Ephemeral Volumes | SUSE OpenStack Cloud…"/>
<meta name="description" content="By default, ephemeral volumes are not encrypted. If you wish to enable this feature, you should use the following steps."/>
<meta name="product-name" content="SUSE OpenStack Cloud"/>
<meta name="product-number" content="8"/>
<meta name="book-title" content="Security Guide"/>
<meta name="chapter-title" content="Chapter 10. Encryption of Ephemeral Volumes"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 8"/>
<meta property="og:title" content="Encryption of Ephemeral Volumes | SUSE OpenStack Cloud…"/>
<meta property="og:description" content="By default, ephemeral volumes are not encrypted. If you wish to enable this feature, you should use the following steps."/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Encryption of Ephemeral Volumes | SUSE OpenStack Cloud…"/>
<meta name="twitter:description" content="By default, ephemeral volumes are not encrypted. If you wish to enable this feature, you should use the following steps."/>
<link rel="prev" href="password-encryption.html" title="Chapter 9. Encryption of Passwords and Sensitive Data"/><link rel="next" href="topic-rmq-j1v-4t.html" title="Chapter 11. Refining Access Control with AppArmor"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/security-encrypted_ephvol.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Security Guide</a><span> / </span><a class="crumb" href="encryption-ephemeral.html">Encryption of Ephemeral Volumes</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Security Guide</div><ol><li><a href="newsecurity.html" class=" "><span class="title-number">1 </span><span class="title-name"><span class="phrase"><span class="phrase">SUSE® <span class="productname">OpenStack</span> Cloud</span></span>: Security Features Overview</span></a></li><li><a href="barbican.html" class=" "><span class="title-number">2 </span><span class="title-name">Key Management with the Barbican Service</span></a></li><li><a href="barbicanAdmin.html" class=" "><span class="title-number">3 </span><span class="title-name">Key Management Service Administration</span></a></li><li><a href="roleSegregation.html" class=" "><span class="title-number">4 </span><span class="title-name"><span class="phrase"><span class="phrase">SUSE® <span class="productname">OpenStack</span> Cloud</span></span>: Service Admin Role Segregation in the Identity Service</span></a></li><li><a href="cha-security-rbac.html" class=" "><span class="title-number">5 </span><span class="title-name">Role-Based Access Control in Neutron</span></a></li><li><a href="x509-certificate-auth.html" class=" "><span class="title-number">6 </span><span class="title-name">Configuring Keystone and Horizon to use X.509 Client Certificates</span></a></li><li><a href="tls30overview.html" class=" "><span class="title-number">7 </span><span class="title-name">Transport Layer Security (TLS) Overview</span></a></li><li><a href="header-poisoning.html" class=" "><span class="title-number">8 </span><span class="title-name"><span class="phrase"><span class="phrase">SUSE® <span class="productname">OpenStack</span> Cloud</span></span>: Preventing Host Header Poisoning</span></a></li><li><a href="password-encryption.html" class=" "><span class="title-number">9 </span><span class="title-name">Encryption of Passwords and Sensitive Data</span></a></li><li><a href="encryption-ephemeral.html" class=" you-are-here"><span class="title-number">10 </span><span class="title-name">Encryption of Ephemeral Volumes</span></a></li><li><a href="topic-rmq-j1v-4t.html" class=" "><span class="title-number">11 </span><span class="title-name">Refining Access Control with AppArmor</span></a></li><li><a href="dar.html" class=" "><span class="title-number">12 </span><span class="title-name">Data at Rest Encryption</span></a></li><li><a href="glance-rate-limit.html" class=" "><span class="title-number">13 </span><span class="title-name">Glance-API Rate Limit (CVE-2016-8611)</span></a></li><li><a href="idg-all-security-middleware-auditing-xml-1.html" class=" "><span class="title-number">14 </span><span class="title-name">Security Audit Logs</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="encryption-ephemeral" data-id-title="Encryption of Ephemeral Volumes"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span></span> <span class="productnumber"><span class="phrase"><span class="phrase">8</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">10 </span><span class="title-name">Encryption of Ephemeral Volumes</span></span> <a title="Permalink" class="permalink" href="encryption-ephemeral.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/security-encrypted_ephvol.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  By default, ephemeral volumes are not encrypted. If you wish to enable this
  feature, you should use the following steps.
 </p><div id="id-1.5.12.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>
   For more details about this feature, see
   <a class="link" href="http://specs.openstack.org/openstack/nova-specs/specs/juno/approved/lvm-ephemeral-storage-encryption.html" target="_blank">Ephemeral
   storage encryption for LVM backend</a>.
  </p></div><section class="sect1" id="id-1.5.12.4" data-id-title="Enabling ephemeral volume encryption"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">10.1 </span><span class="title-name">Enabling ephemeral volume encryption</span></span> <a title="Permalink" class="permalink" href="encryption-ephemeral.html#id-1.5.12.4">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/security-encrypted_ephvol.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Before deploying the Compute nodes you will need to change the disk
   configuration to create a new <code class="literal">volume-group</code> which will be
   used for your ephemeral disks. To do this, following these steps:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
     Log in to the Cloud Lifecycle Manager.
    </p></li><li class="listitem"><p>
     Add details about the volume-group you will be using for your encrypted
     volumes. You have two options for this, you can either create a new
     volume-group or add the details for an already existing volume-group.
    </p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>
       To create a new volume-group, add the following lines to your Compute
       disk configuration file.
      </p><p>
       The location of the Compute disk configuration file is:
      </p><div class="verbatim-wrap"><pre class="screen">~/openstack/my_cloud/definition/data/disks_compute.yml</pre></div><div class="verbatim-wrap"><pre class="screen">name: vg-comp
       physical-volumes:
         - /dev/sdb</pre></div></li><li class="listitem"><p>
       To utilize an existing volume-group you can add the following lines to
       your <code class="literal">nova.conf</code> file, using the name of your
       volume-group:
      </p><div class="verbatim-wrap"><pre class="screen">[libvirt]
images_type = lvm
images_volume_group = &lt;volume_group_name&gt;</pre></div></li></ol></div><div id="id-1.5.12.4.3.2.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>
      The requirement here is to have free space available on a
      <code class="literal">volume-group</code>. The correct disk to use and the name for
      the volume group will depend on your environment's needs.
     </p></div></li><li class="listitem"><p>
     Modify the <code class="literal">nova.conf</code> file for the Compute and API
     nodes. Verify that the following entries exist, if they do not then add
     them and then restart the <code class="literal">nova-compute</code> and
     <code class="literal">nova-api</code> services:
    </p><div class="verbatim-wrap"><pre class="screen">[libvirt]
images_type = lvm
images_volume_group = vg-comp

[ephemeral_storage_encryption]
key_size = 256
cipher = aes-xts-plain64
enabled = True

[keymgr]
api_class = nova.keymgr.barbican.BarbicanKeyManager

[barbican]
endpoint_template = https://192.168.245.9:9311/v1</pre></div><p>
     To restart the services, use the following commands:
    </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl restart nova-compute
sudo systemctl restart nova-api</pre></div></li><li class="listitem"><p>
     Assign the role in Keystone using the CLI tool. Using the openstack client
     you can assign the user <code class="literal">key-manager:creator</code> role for
     the project.
    </p></li><li class="listitem"><p>
     Boot an instance with an ephermal disk and verify that the disk is
     encrypted. Once the instance is active it is possible to check on the
     Compute node if the ephermal disk is encrypted.
    </p><p>
     SSH into the Compute node then run the following commands:
    </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup status
cryptsetup -v status &lt;name_of_ephemeral_disk&gt;</pre></div></li></ol></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="password-encryption.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 9 </span>Encryption of Passwords and Sensitive Data</span></a> </div><div><a class="pagination-link next" href="topic-rmq-j1v-4t.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 11 </span>Refining Access Control with AppArmor</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="encryption-ephemeral.html#id-1.5.12.4"><span class="title-number">10.1 </span><span class="title-name">Enabling ephemeral volume encryption</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>