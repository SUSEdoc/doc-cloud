<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Encryption of Ephemeral Volumes | Security Guide | SUSE OpenStack Cloud 8</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 3.2.0 (https://opensuse.github.io/daps) using SUSE XSL Stylesheets 2.81.0 (based on DocBook XSL Stylesheets 1.79.2) - chunked" /><meta name="product-name" content="SUSE OpenStack Cloud" /><meta name="product-number" content="8" /><meta name="book-title" content="Security Guide" /><meta name="chapter-title" content="Chapter 10. Encryption of Ephemeral Volumes" /><meta name="description" content="By default, ephemeral volumes are not encrypted. If you wish to enable this feature, you should use the following steps." /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 8" /><link rel="home" href="index.html" title="Documentation" /><link rel="up" href="book-security.html" title="Security Guide" /><link rel="prev" href="password-encryption.html" title="Chapter 9. Encryption of Passwords and Sensitive Data" /><link rel="next" href="topic-rmq-j1v-4t.html" title="Chapter 11. Refining Access Control with AppArmor" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css"></link>');
}
else {
  document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Documentation"><span class="book-icon">Documentation</span></a><span> › </span><a class="crumb" href="book-security.html">Security Guide</a><span> › </span><a class="crumb" href="encryption-ephemeral.html">Encryption of Ephemeral Volumes</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="newsecurity.html"><span class="number">1 </span><span class="name"><span class="phrase"><span class="phrase">SUSE® <span class="productname">OpenStack</span> Cloud</span></span>: Security Features Overview</span></a></li><li class="inactive"><a href="barbican.html"><span class="number">2 </span><span class="name">Key Management with the Barbican Service</span></a></li><li class="inactive"><a href="barbicanAdmin.html"><span class="number">3 </span><span class="name">Key Management Service Administration</span></a></li><li class="inactive"><a href="roleSegregation.html"><span class="number">4 </span><span class="name"><span class="phrase"><span class="phrase">SUSE® <span class="productname">OpenStack</span> Cloud</span></span>: Service Admin Role Segregation in the Identity Service</span></a></li><li class="inactive"><a href="cha-security-rbac.html"><span class="number">5 </span><span class="name">Role-Based Access Control in Neutron</span></a></li><li class="inactive"><a href="x509-certificate-auth.html"><span class="number">6 </span><span class="name">Configuring Keystone and Horizon to use X.509 Client Certificates</span></a></li><li class="inactive"><a href="tls30overview.html"><span class="number">7 </span><span class="name">Transport Layer Security (TLS) Overview</span></a></li><li class="inactive"><a href="header-poisoning.html"><span class="number">8 </span><span class="name"><span class="phrase"><span class="phrase">SUSE® <span class="productname">OpenStack</span> Cloud</span></span>: Preventing Host Header Poisoning</span></a></li><li class="inactive"><a href="password-encryption.html"><span class="number">9 </span><span class="name">Encryption of Passwords and Sensitive Data</span></a></li><li class="inactive"><a href="encryption-ephemeral.html"><span class="number">10 </span><span class="name">Encryption of Ephemeral Volumes</span></a></li><li class="inactive"><a href="topic-rmq-j1v-4t.html"><span class="number">11 </span><span class="name">Refining Access Control with AppArmor</span></a></li><li class="inactive"><a href="dar.html"><span class="number">12 </span><span class="name">Data at Rest Encryption</span></a></li><li class="inactive"><a href="glance-rate-limit.html"><span class="number">13 </span><span class="name">Glance-API Rate Limit (CVE-2016-8611)</span></a></li><li class="inactive"><a href="idg-all-security-middleware-auditing-xml-1.html"><span class="number">14 </span><span class="name">Security Audit Logs</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 9. Encryption of Passwords and Sensitive Data" href="password-encryption.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 11. Refining Access Control with AppArmor" href="topic-rmq-j1v-4t.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Documentation"><span class="book-icon">Documentation</span></a><span> › </span><a class="crumb" href="book-security.html">Security Guide</a><span> › </span><a class="crumb" href="encryption-ephemeral.html">Encryption of Ephemeral Volumes</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 9. Encryption of Passwords and Sensitive Data" href="password-encryption.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 11. Refining Access Control with AppArmor" href="topic-rmq-j1v-4t.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="encryption-ephemeral"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span></span> <span class="productnumber "><span class="phrase"><span class="phrase">8</span></span></span></div><div><h1 class="title"><span class="number">10 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Encryption of Ephemeral Volumes</span> <a title="Permalink" class="permalink" href="encryption-ephemeral.html#">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/develop/xml/security-encrypted_ephvol.xml" title="Edit the source file for this section">Edit source</a></h1><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-encrypted_ephvol.xml</li><li><span class="ds-label">ID: </span>encryption-ephemeral</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="section"><a href="encryption-ephemeral.html#id-1.5.12.4"><span class="number">10.1 </span><span class="name">Enabling ephemeral volume encryption</span></a></span></dt></dl></div></div><p>
  By default, ephemeral volumes are not encrypted. If you wish to enable this
  feature, you should use the following steps.
 </p><div id="id-1.5.12.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
   For more details about this feature, see
   <a class="link" href="http://specs.openstack.org/openstack/nova-specs/specs/juno/approved/lvm-ephemeral-storage-encryption.html" target="_blank">Ephemeral
   storage encryption for LVM backend</a>.
  </p></div><div class="sect1" id="id-1.5.12.4"><div class="titlepage"><div><div><h2 class="title"><span class="number">10.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Enabling ephemeral volume encryption</span> <a title="Permalink" class="permalink" href="encryption-ephemeral.html#id-1.5.12.4">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/develop/xml/security-encrypted_ephvol.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security-encrypted_ephvol.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   Before deploying the Compute nodes you will need to change the disk
   configuration to create a new <code class="literal">volume-group</code> which will be
   used for your ephemeral disks. To do this, following these steps:
  </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
     Log in to the Cloud Lifecycle Manager.
    </p></li><li class="listitem "><p>
     Add details about the volume-group you will be using for your encrypted
     volumes. You have two options for this, you can either create a new
     volume-group or add the details for an already existing volume-group.
    </p><div class="orderedlist "><ol class="orderedlist" type="a"><li class="listitem "><p>
       To create a new volume-group, add the following lines to your Compute
       disk configuration file.
      </p><p>
       The location of the Compute disk configuration file is:
      </p><div class="verbatim-wrap"><pre class="screen">~/openstack/my_cloud/definition/data/disks_compute.yml</pre></div><div class="verbatim-wrap"><pre class="screen">name: vg-comp
       physical-volumes:
         - /dev/sdb</pre></div></li><li class="listitem "><p>
       To utilize an existing volume-group you can add the following lines to
       your <code class="literal">nova.conf</code> file, using the name of your
       volume-group:
      </p><div class="verbatim-wrap"><pre class="screen">[libvirt]
images_type = lvm
images_volume_group = &lt;volume_group_name&gt;</pre></div></li></ol></div><div id="id-1.5.12.4.3.2.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
      The requirement here is to have free space available on a
      <code class="literal">volume-group</code>. The correct disk to use and the name for
      the volume group will depend on your environment's needs.
     </p></div></li><li class="listitem "><p>
     Modify the <code class="literal">nova.conf</code> file for the Compute and API
     nodes. Verify that the following entries exist, if they do not then add
     them and then restart the <code class="literal">nova-compute</code> and
     <code class="literal">nova-api</code> services:
    </p><div class="verbatim-wrap"><pre class="screen">[libvirt]
images_type = lvm
images_volume_group = vg-comp

[ephemeral_storage_encryption]
key_size = 256
cipher = aes-xts-plain64
enabled = True

[keymgr]
api_class = nova.keymgr.barbican.BarbicanKeyManager

[barbican]
endpoint_template = https://192.168.245.9:9311/v1</pre></div><p>
     To restart the services, use the following commands:
    </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl restart nova-compute
sudo systemctl restart nova-api</pre></div></li><li class="listitem "><p>
     Assign the role in Keystone using the CLI tool. Using the openstack client
     you can assign the user <code class="literal">key-manager:creator</code> role for
     the project.
    </p></li><li class="listitem "><p>
     Boot an instance with an ephermal disk and verify that the disk is
     encrypted. Once the instance is active it is possible to check on the
     Compute node if the ephermal disk is encrypted.
    </p><p>
     SSH into the Compute node then run the following commands:
    </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup status
cryptsetup -v status &lt;name_of_ephemeral_disk&gt;</pre></div></li></ol></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="topic-rmq-j1v-4t.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 11 </span>Refining Access Control with AppArmor</span></a><a class="nav-link" href="password-encryption.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 9 </span>Encryption of Passwords and Sensitive Data</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2021 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>