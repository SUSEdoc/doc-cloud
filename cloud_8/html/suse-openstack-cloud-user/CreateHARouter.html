<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><title>SUSE OpenStack Cloud 8 | User Guide | Creating a Highly Available Router</title><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<meta name="title" content="Creating a Highly Available Router | SUSE OpenStack Cl…"/>
<meta name="description" content="CVR (Centralized Virtual Routing) and DVR (Distributed Virtual Routing) are two types of technologies which can be used to provide routing processes …"/>
<meta name="product-name" content="SUSE OpenStack Cloud"/>
<meta name="product-number" content="8"/>
<meta name="book-title" content="User Guide"/>
<meta name="chapter-title" content="Chapter 6. Creating a Highly Available Router"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 8"/>
<meta property="og:title" content="Creating a Highly Available Router | SUSE OpenStack Cl…"/>
<meta property="og:description" content="CVR (Centralized Virtual Routing) and DVR (Distributed Virtual Routing) are two types of technologies which can be used to provide routing processes …"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Creating a Highly Available Router | SUSE OpenStack Cl…"/>
<meta name="twitter:description" content="CVR (Centralized Virtual Routing) and DVR (Distributed Virtual Routing) are two types of technologies which can be used to provide routing processes …"/>
<link rel="prev" href="install-cli.html" title="Chapter 5. Installing the Command-Line Clients"/><link rel="next" href="user-nonadmin.html" title="Part II. Project User Guide"/>
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/networking-create_ha_router.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">User Guide</a><span> / </span><a class="crumb" href="user-cloudadmin.html">Cloud Admin User Guide</a><span> / </span><a class="crumb" href="CreateHARouter.html">Creating a Highly Available Router</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">User Guide</div><ol><li class="active"><a href="user-cloudadmin.html" class="has-children you-are-here"><span class="title-number">I </span><span class="title-name">Cloud Admin User Guide</span></a><ol><li><a href="using-opsconsole.html" class=" "><span class="title-number">1 </span><span class="title-name">Using the Operations Console</span></a></li><li><a href="user-dashboard-overview.html" class=" "><span class="title-number">2 </span><span class="title-name">Using the Dashboard</span></a></li><li><a href="cloudadmin-gui.html" class=" "><span class="title-number">3 </span><span class="title-name">Cloud Admin Actions with the Dashboard</span></a></li><li><a href="CreateCloudAdmin.html" class=" "><span class="title-number">4 </span><span class="title-name">Cloud Admin Actions with the Command Line</span></a></li><li><a href="install-cli.html" class=" "><span class="title-number">5 </span><span class="title-name">Installing the Command-Line Clients</span></a></li><li><a href="CreateHARouter.html" class=" you-are-here"><span class="title-number">6 </span><span class="title-name">Creating a Highly Available Router</span></a></li></ol></li><li><a href="user-nonadmin.html" class="has-children "><span class="title-number">II </span><span class="title-name">Project User Guide</span></a><ol><li><a href="using-container-as-a-service-overview.html" class=" "><span class="title-number">7 </span><span class="title-name">Using Container as a Service (Magnum)</span></a></li><li><a href="idg-all-userguide-create-network-xml-1.html" class=" "><span class="title-number">8 </span><span class="title-name">Creating a Private Network</span></a></li><li><a href="create-keypair.html" class=" "><span class="title-number">9 </span><span class="title-name">Creating a Key Pair</span></a></li><li><a href="user-image-upload.html" class=" "><span class="title-number">10 </span><span class="title-name">Creating and Uploading a Glance Image</span></a></li><li><a href="lbaas-dashboard.html" class=" "><span class="title-number">11 </span><span class="title-name">Creating a Load Balancer with the Dashboard</span></a></li><li><a href="HP2-0LBaaS.html" class=" "><span class="title-number">12 </span><span class="title-name">Using Load Balancing as a Service (LBaaS)</span></a></li><li><a href="LBaaSHeat.html" class=" "><span class="title-number">13 </span><span class="title-name">Using Load Balancing as a Service with Orchestration Service</span></a></li><li><a href="HP2-0FWaaS.html" class=" "><span class="title-number">14 </span><span class="title-name">Using Firewall as a Service (FWaaS)</span></a></li><li><a href="UsingVPNaaS.html" class=" "><span class="title-number">15 </span><span class="title-name">Using VPN as a Service (VPNaaS)</span></a></li></ol></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="CreateHARouter" data-id-title="Creating a Highly Available Router"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span></span> <span class="productnumber"><span class="phrase"><span class="phrase">8</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">6 </span><span class="title-name">Creating a Highly Available Router</span></span> <a title="Permalink" class="permalink" href="CreateHARouter.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/networking-create_ha_router.xml" title="Edit source document"> </a></div></div></div></div></div><section class="sect1" id="CVRDVR" data-id-title="CVR and DVR High Available Routers"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">6.1 </span><span class="title-name">CVR and DVR High Available Routers</span></span> <a title="Permalink" class="permalink" href="CreateHARouter.html#CVRDVR">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/networking-create_ha_router.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   CVR (Centralized Virtual Routing) and DVR (Distributed Virtual Routing) are
   two types of technologies which can be used to provide routing processes in
   <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span>. You can create Highly Available (HA) versions of CVR and
   DVR routers by using the options in the table below when creating your
   router.
  </p><p>
   The neutron command for creating a router <code class="literal">neutron router-create
   router_name --distributed=True|False --ha=True|False</code> requires
   administrative permissions. See the example in the next section, Creating a
   High Availability Router.
  </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col style="text-align: center; " class="c1"/><col style="text-align: center; " class="c2"/><col style="text-align: center; " class="c3"/><col style="text-align: left; " class="c4"/></colgroup><thead><tr><th style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">--distributed</th><th style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">--ha</th><th style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">Router Type</th><th style="text-align: left; border-bottom: 1px solid ; ">Description</th></tr></thead><tbody><tr><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">False</td><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">False</td><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">CVR</td><td style="text-align: left; border-bottom: 1px solid ; ">Centralized Virtual Router</td></tr><tr><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">False</td><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">True</td><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">CVRHA</td><td style="text-align: left; border-bottom: 1px solid ; ">Centralized Virtual Router with L3 High Availablity</td></tr><tr><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">True</td><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">False</td><td style="text-align: center; border-right: 1px solid ; border-bottom: 1px solid ; ">DVR</td><td style="text-align: left; border-bottom: 1px solid ; ">Distributed Virtual Router without SNAT High Availability</td></tr><tr><td style="text-align: center; border-right: 1px solid ; ">True</td><td style="text-align: center; border-right: 1px solid ; ">True</td><td style="text-align: center; border-right: 1px solid ; ">DVRHA</td><td style="text-align: left; ">Distributed Virtual Router with SNAT High Availability</td></tr></tbody></table></div></section><section class="sect1" id="CreateRouter" data-id-title="Creating a High Availability Router"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">6.2 </span><span class="title-name">Creating a High Availability Router</span></span> <a title="Permalink" class="permalink" href="CreateHARouter.html#CreateRouter">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/networking-create_ha_router.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   You can create a highly available router using the neutron command line
   interface.
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
     To create the HA router simply add <code class="literal">--ha=True</code> to the
     neutron router-create command. If you want to also make the router
     distributed, add <code class="literal">--distributed=True</code>. In this example, a
     DVR SNAT HA router is created with the name <code class="literal">routerHA</code>.
    </p><div class="verbatim-wrap"><pre class="screen">$ neutron router-create routerHA --distributed=True --ha=True</pre></div></li><li class="listitem"><p>
     Set the gateway for the external network and add interface
    </p><div class="verbatim-wrap"><pre class="screen">$ neutron router-gateway-set routerHA &lt;ext-net-id&gt;
$ neutron router-interface-add routerHA &lt;private_subnet_id&gt;</pre></div></li><li class="listitem"><p>
     Once the router is created, gateway set and interface attached, you now
     have a router with high availability.
    </p></li></ol></div></section><section class="sect1" id="TestRouter" data-id-title="Test Router for High Availability"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">6.3 </span><span class="title-name">Test Router for High Availability</span></span> <a title="Permalink" class="permalink" href="CreateHARouter.html#TestRouter">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE-Cloud/doc-cloud/blob/maintenance/cloud_8/xml/networking-create_ha_router.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   You can demonstrate that the router is HA by running a continuous ping from
   a VM instance that is running on the private network to an external server
   such as a public DNS. As the ping is running, list the l3 agents hosting the
   router and identify the agent that is responsible for hosting the active
   router. Induce the failover mechanism by creating a catastrophic event like
   shutting down node hosting the l3 agent. Once the node is shut down, you
   will see that the ping from the VM to the external network continues to run
   as the backup l3 agent takes over. To verify the agent hosting the primary
   router has changed, list the agents hosting the router. You will see a
   different agent is now hosting the active router.
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
     Boot an instance on the private network
    </p><div class="verbatim-wrap"><pre class="screen">$ nova boot --image &lt;image_id&gt; --flavor &lt;flavor_id&gt; --nic net_id=&lt;private_net_id&gt; --key_name &lt;key&gt; VM1</pre></div></li><li class="listitem"><p>
     Log into the VM using the ssh keys
    </p><div class="verbatim-wrap"><pre class="screen">ssh -i &lt;key&gt; &lt;ipaddress of VM1&gt;</pre></div></li><li class="listitem"><p>
     Start a ping to X.X.X.X. While pinging, make sure there is no packet loss
     and leave the ping running.
    </p><div class="verbatim-wrap"><pre class="screen">$ ping X.X.X.X</pre></div></li><li class="listitem"><p>
     Check which agent is hosting the active router
    </p><div class="verbatim-wrap"><pre class="screen">$ neutron l3-agent-list-hosting-router &lt;router_id&gt;</pre></div></li><li class="listitem"><p>
     Shutdown the node hosting the agent.
    </p></li><li class="listitem"><p>
     Within 10 seconds, check again to see which L3 agent is hosting the active
     router
    </p><div class="verbatim-wrap"><pre class="screen">$ neutron l3-agent-list-hosting-router &lt;router_id&gt;</pre></div></li><li class="listitem"><p>
     You will see a different agent.
    </p></li></ol></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="install-cli.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 5 </span>Installing the Command-Line Clients</span></a> </div><div><a class="pagination-link next" href="user-nonadmin.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Part II </span>Project User Guide</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="CreateHARouter.html#CVRDVR"><span class="title-number">6.1 </span><span class="title-name">CVR and DVR High Available Routers</span></a></span></li><li><span class="section"><a href="CreateHARouter.html#CreateRouter"><span class="title-number">6.2 </span><span class="title-name">Creating a High Availability Router</span></a></span></li><li><span class="section"><a href="CreateHARouter.html#TestRouter"><span class="title-number">6.3 </span><span class="title-name">Test Router for High Availability</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2022</span></div></div></footer></body></html>