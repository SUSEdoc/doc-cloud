<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Using VPN as a Service (VPNaaS) | User Guide | SUSE OpenStack Cloud 8</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" /><meta name="generator" content="DAPS 3.0.0 (https://opensuse.github.io/daps) using SUSE XSL Stylesheets 2.0.17 (based on DocBook XSL Stylesheets 1.79.2) - chunked" /><meta name="product-name" content="SUSE OpenStack Cloud" /><meta name="product-number" content="8" /><meta name="book-title" content="User Guide" /><meta name="chapter-title" content="Chapter 15. Using VPN as a Service (VPNaaS)" /><meta name="description" content="SUSE OpenStack Cloud 8 VPNaaS Configuration" /><meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi" /><meta name="tracker-type" content="bsc" /><meta name="tracker-bsc-component" content="Documentation" /><meta name="tracker-bsc-product" content="SUSE OpenStack Cloud 8" /><link rel="home" href="index.html" title="Documentation" /><link rel="up" href="user-nonadmin.html" title="Part II. Project User Guide" /><link rel="prev" href="HP2-0FWaaS.html" title="Chapter 14. Using Firewall as a Service (FWaaS)" /><link rel="next" href="book-opsconsole.html" title="Operations Console" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css"></link>');
}
else {
  document.write('<link rel="stylesheet" type="text/css" href="static/css/fonts-onlylocal.css"></link>');
}

</script><noscript><link rel="stylesheet" type="text/css" href="https://static.opensuse.org/fonts/fonts.css" /></noscript><script src="static/js/jquery-1.10.2.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #FABEBE;"><div id="_header"><div id="_logo"><img src="static/images/logo.png" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Documentation"><span class="book-icon">Documentation</span></a><span> › </span><a class="crumb" href="book-user.html">User Guide</a><span> › </span><a class="crumb" href="user-nonadmin.html">Project User Guide</a><span> › </span><a class="crumb" href="UsingVPNaaS.html">Using VPN as a Service (VPNaaS)</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>User Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="user-cloudadmin.html"><span class="number">I </span><span class="name">Cloud Admin User Guide</span></a><ol><li class="inactive"><a href="using-opsconsole.html"><span class="number">1 </span><span class="name">Using the Operations Console</span></a></li><li class="inactive"><a href="user-dashboard-overview.html"><span class="number">2 </span><span class="name">Using the Dashboard</span></a></li><li class="inactive"><a href="cloudadmin-gui.html"><span class="number">3 </span><span class="name">Cloud Admin Actions with the Dashboard</span></a></li><li class="inactive"><a href="CreateCloudAdmin.html"><span class="number">4 </span><span class="name">Cloud Admin Actions with the Command Line</span></a></li><li class="inactive"><a href="install-cli.html"><span class="number">5 </span><span class="name">Installing the Command-Line Clients</span></a></li><li class="inactive"><a href="CreateHARouter.html"><span class="number">6 </span><span class="name">Creating a Highly Available Router</span></a></li></ol></li><li class="inactive"><a href="user-nonadmin.html"><span class="number">II </span><span class="name">Project User Guide</span></a><ol><li class="inactive"><a href="using-container-as-a-service-overview.html"><span class="number">7 </span><span class="name">Using Container as a Service (Magnum)</span></a></li><li class="inactive"><a href="idg-all-userguide-create-network-xml-1.html"><span class="number">8 </span><span class="name">Creating a Private Network</span></a></li><li class="inactive"><a href="create-keypair.html"><span class="number">9 </span><span class="name">Creating a Key Pair</span></a></li><li class="inactive"><a href="user-image-upload.html"><span class="number">10 </span><span class="name">Creating and Uploading a Glance Image</span></a></li><li class="inactive"><a href="lbaas-dashboard.html"><span class="number">11 </span><span class="name">Creating a Load Balancer with the Dashboard</span></a></li><li class="inactive"><a href="HP2-0LBaaS.html"><span class="number">12 </span><span class="name">Using Load Balancing as a Service (LBaaS)</span></a></li><li class="inactive"><a href="LBaaSHeat.html"><span class="number">13 </span><span class="name">Using Load Balancing as a Service with Orchestration Service</span></a></li><li class="inactive"><a href="HP2-0FWaaS.html"><span class="number">14 </span><span class="name">Using Firewall as a Service (FWaaS)</span></a></li><li class="inactive"><a href="UsingVPNaaS.html"><span class="number">15 </span><span class="name">Using VPN as a Service (VPNaaS)</span></a></li></ol></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 14. Using Firewall as a Service (FWaaS)" href="HP2-0FWaaS.html"><span class="prev-icon">←</span></a><span class="tool-spacer"><span class="next-icon">→</span></span></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #FABEBE;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Documentation"><span class="book-icon">Documentation</span></a><span> › </span><a class="crumb" href="book-user.html">User Guide</a><span> › </span><a class="crumb" href="user-nonadmin.html">Project User Guide</a><span> › </span><a class="crumb" href="UsingVPNaaS.html">Using VPN as a Service (VPNaaS)</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 14. Using Firewall as a Service (FWaaS)" href="HP2-0FWaaS.html"><span class="prev-icon">←</span></a><span class="tool-spacer"><span class="next-icon">→</span></span></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="UsingVPNaaS"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span></span> <span class="productnumber "><span class="phrase"><span class="phrase">8</span></span></span></div><div><h2 class="title"><span class="number">15 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Using VPN as a Service (VPNaaS)</span> <a title="Permalink" class="permalink" href="UsingVPNaaS.html#">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/develop/xml/networking-vpnaas.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>networking-vpnaas.xml</li><li><span class="ds-label">ID: </span>UsingVPNaaS</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="section"><a href="UsingVPNaaS.html#idg-all-networking-vpnaas-xml-7"><span class="number">15.1 </span><span class="name">Prerequisites</span></a></span></dt><dt><span class="section"><a href="UsingVPNaaS.html#Considerations"><span class="number">15.2 </span><span class="name">Considerations</span></a></span></dt><dt><span class="section"><a href="UsingVPNaaS.html#idg-all-networking-vpnaas-xml-9"><span class="number">15.3 </span><span class="name">Configuration</span></a></span></dt><dt><span class="section"><a href="UsingVPNaaS.html#sec-vpnaas-more"><span class="number">15.4 </span><span class="name">More Information</span></a></span></dt></dl></div></div><p>
  <span class="bold"><strong><span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span> VPNaaS Configuration</strong></span>
 </p><p>
  This document describes the configuration process and requirements for the
  <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> <span class="phrase"><span class="phrase">8</span></span> Virtual Private Network (VPN) as a Service module.
 </p><div class="sect1" id="idg-all-networking-vpnaas-xml-7"><div class="titlepage"><div><div><h2 class="title"><span class="number">15.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Prerequisites</span> <a title="Permalink" class="permalink" href="UsingVPNaaS.html#idg-all-networking-vpnaas-xml-7">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/develop/xml/networking-vpnaas.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>networking-vpnaas.xml</li><li><span class="ds-label">ID: </span>idg-all-networking-vpnaas-xml-7</li></ul></div></div></div></div><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
     <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> must be installed.
    </p></li><li class="listitem "><p>
     Before setting up VPNaaS, you will need to have created an external
     network and a subnet with access to the internet. Information on how to
     create the external network and subnet can be found in
     <a class="xref" href="UsingVPNaaS.html#sec-vpnaas-more" title="15.4. More Information">Section 15.4, “More Information”</a>.
    </p></li><li class="listitem "><p>
     You should assume 172.16.0.0/16 as the ext-net CIDR in this document.
    </p></li></ol></div></div><div class="sect1" id="Considerations"><div class="titlepage"><div><div><h2 class="title"><span class="number">15.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Considerations</span> <a title="Permalink" class="permalink" href="UsingVPNaaS.html#Considerations">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/develop/xml/networking-vpnaas.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>networking-vpnaas.xml</li><li><span class="ds-label">ID: </span>Considerations</li></ul></div></div></div></div><p>
   Using the Neutron plugin-based VPNaaS causes additional processes to be run
   on the Network Service Nodes. One of these processes, the ipsec charon
   process from StrongSwan, runs as root and listens on an external network. A
   vulnerability in that process can lead to remote root compromise of the
   Network Service Nodes. If this is a concern customers should consider using
   a VPN solution other than the Neutron plugin-based VPNaaS and/or deploying
   additional protection mechanisms.
  </p></div><div class="sect1" id="idg-all-networking-vpnaas-xml-9"><div class="titlepage"><div><div><h2 class="title"><span class="number">15.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configuration</span> <a title="Permalink" class="permalink" href="UsingVPNaaS.html#idg-all-networking-vpnaas-xml-9">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/develop/xml/networking-vpnaas.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>networking-vpnaas.xml</li><li><span class="ds-label">ID: </span>idg-all-networking-vpnaas-xml-9</li></ul></div></div></div></div><p>
   <span class="bold"><strong>Setup Networks</strong></span> You can setup VPN as a
   Service (VPNaaS) by first creating networks, subnets and routers using the
   <code class="literal">neutron</code> command line. The VPNaaS module enables the
   ability to extend access between private networks across two different
   <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> clouds or between a <span class="phrase"><span class="phrase">SUSE <span class="productname">OpenStack</span> Cloud</span></span> cloud and a non-cloud network. VPNaaS
   is based on the open source software application called StrongSwan.
   StrongSwan (more information available
   at <a class="link" href="http://www.strongswan.org/" target="_blank">http://www.strongswan.org/</a>)
   is an IPsec implementation and provides basic VPN gateway functionality.
  </p><div id="id-1.7.4.10.6.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
    You can execute the included commands from any shell with access to the
    service APIs. In the included examples, the commands are executed from the
    lifecycle manager, however you could execute the commands from the
    controller node or any other shell with aforementioned service API access.
   </p></div><div id="id-1.7.4.10.6.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
    The use of floating IP's is not possible with the current version of
    VPNaaS when DVR is enabled. Ensure that no floating IP is associated to
    instances that will be using VPNaaS when using a DVR router. Floating IP
    associated to instances are ok when using CVR router.
   </p></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     From the Cloud Lifecycle Manager, create first private network, subnet and
     router assuming that <span class="emphasis"><em>ext-net</em></span> is created by admin.
    </p><div class="verbatim-wrap"><pre class="screen">neutron net-create privateA
neutron subnet-create --name subA privateA 10.1.0.0/24 --gateway 10.1.0.1
neutron router-create router1
neutron router-interface-add router1 subA
neutron router-gateway-set router1 ext-net</pre></div></li><li class="step "><p>
     Create second private network, subnet and router.
    </p><div class="verbatim-wrap"><pre class="screen">neutron net-create privateB
neutron subnet-create --name subB privateB 10.2.0.0/24 --gateway 10.2.0.1
neutron router-create router2
neutron router-interface-add router2 subB
neutron router-gateway-set router2 ext-net</pre></div></li></ol></div></div><div class="procedure " id="pro-vpnaas-start"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 15.1: </span><span class="name">Starting Virtual Machines </span><a title="Permalink" class="permalink" href="UsingVPNaaS.html#pro-vpnaas-start">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     From the Cloud Lifecycle Manager run the following to start the virtual
     machines. Begin with adding secgroup rules for SSH and ICMP.
    </p><div class="verbatim-wrap"><pre class="screen">neutron security-group-rule-create default --protocol icmp
neutron security-group-rule-create default --protocol tcp --port-range-min 22 --port-range-max 22</pre></div></li><li class="step "><p>
     Start the virtual machine in the privateA subnet. Using <span class="emphasis"><em>nova
     images-list</em></span>, use the image id to boot image instead of the
     image name. After executing this step, it is recommended that you wait
     approximately 10 seconds to allow the virtual machine to become active.
    </p><div class="verbatim-wrap"><pre class="screen">NETA=$(neutron net-list | awk '/privateA/ {print $2}')
nova boot --flavor 1 --image &lt;id&gt; --nic net-id=$NETA vm1</pre></div></li><li class="step "><p>
     Start the virtual machine in the privateB subnet.
    </p><div class="verbatim-wrap"><pre class="screen">NETB=$(neutron net-list | awk '/privateB/ {print $2}')
nova boot --flavor 1 --image &lt;id&gt; --nic net-id=$NETB vm2</pre></div></li><li class="step " id="st-vpnaas-obtain-ip"><p>
     Verify private IP's are allocated to the respective vms. Take note of IP's
     for later use.
    </p><div class="verbatim-wrap"><pre class="screen">nova show vm1
nova show vm2</pre></div></li></ol></div></div><div class="procedure " id="id-1.7.4.10.6.7"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 15.2: </span><span class="name">Create VPN </span><a title="Permalink" class="permalink" href="UsingVPNaaS.html#id-1.7.4.10.6.7">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     You can set up the VPN by executing the below commands from the lifecycle
     manager or any shell with access to the service APIs. Begin with creating
     the policies with <code class="literal">vpn-ikepolicy-create</code> and
     <code class="literal">vpn-ipsecpolicy-create </code>.
    </p><div class="verbatim-wrap"><pre class="screen">neutron vpn-ikepolicy-create ikepolicy
neutron vpn-ipsecpolicy-create ipsecpolicy</pre></div></li><li class="step "><p>
     Create the VPN service at router1.
    </p><div class="verbatim-wrap"><pre class="screen">neutron vpn-service-create --name myvpnA --description "My vpn service" router1 subA</pre></div></li><li class="step "><p>
     Wait at least 5 seconds and then run
     <code class="literal">ipsec-site-connection-create</code> to create a ipsec-site
     connection. Note that <code class="literal">--peer-address</code> is the assign
     ext-net IP from router2 and <code class="literal">--peer-cidr</code> is subB cidr.
    </p><div class="verbatim-wrap"><pre class="screen">neutron ipsec-site-connection-create --name vpnconnection1 --vpnservice-id myvpnA \
--ikepolicy-id ikepolicy --ipsecpolicy-id ipsecpolicy --peer-address 172.16.0.3 \
--peer-id 172.16.0.3 --peer-cidr 10.2.0.0/24 --psk secret</pre></div></li><li class="step "><p>
     Create the VPN service at router2.
    </p><div class="verbatim-wrap"><pre class="screen">neutron vpn-service-create --name myvpnB --description "My vpn serviceB" router2 subB</pre></div></li><li class="step "><p>
     Wait at least 5 seconds and then run
     <code class="literal">ipsec-site-connection-create</code> to create a ipsec-site
     connection. Note that <code class="literal">--peer-address</code> is the assigned
     ext-net IP from router1 and <code class="literal">--peer-cidr</code> is subA cidr.
    </p><div class="verbatim-wrap"><pre class="screen">neutron ipsec-site-connection-create --name vpnconnection2 --vpnservice-id myvpnB \
--ikepolicy-id ikepolicy --ipsecpolicy-id ipsecpolicy --peer-address 172.16.0.2 \
--peer-id 172.16.0.2 --peer-cidr 10.1.0.0/24 --psk secret</pre></div></li><li class="step "><p>
     On the Cloud Lifecycle Manager, run the
     <code class="literal">ipsec-site-connection-list</code> command to see the active
     connections. Be sure to check that the vpn_services are ACTIVE. You can
     check this by running <code class="literal">vpn-service-list</code> and then
     checking ipsec-site-connections status. You should expect that the time
     for both vpn-services and ipsec-site-connections to become ACTIVE could
     take as long as 1 to 3 minutes.
    </p><div class="verbatim-wrap"><pre class="screen">neutron ipsec-site-connection-list
+--------------------------------------+----------------+--------------+---------------+------------+-----------+--------+
| id                                   | name           | peer_address | peer_cidrs    | route_mode | auth_mode | status |
+--------------------------------------+----------------+--------------+---------------+------------+-----------+--------+
| 1e8763e3-fc6a-444c-a00e-426a4e5b737c | vpnconnection2 | 172.16.0.2   | "10.1.0.0/24" | static     | psk       | ACTIVE |
| 4a97118e-6d1d-4d8c-b449-b63b41e1eb23 | vpnconnection1 | 172.16.0.3   | "10.2.0.0/24" | static     | psk       | ACTIVE |
+--------------------------------------+----------------+--------------+---------------+------------+-----------+--------+</pre></div></li></ol></div></div><p>
   <span class="bold"><strong>Verify VPN</strong></span> In the case of non-admin users,
   you can verify the VPN connection by pinging the virtual machines.
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Check the VPN connections.
    </p><div id="id-1.7.4.10.6.9.1.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
      vm1-ip and vm2-ip denotes private IP's for vm1 and vm2 respectively.
      The private IPs are obtained, as described in of
      <a class="xref" href="UsingVPNaaS.html#st-vpnaas-obtain-ip" title="Step 4">Step 4</a>. If you are unable to SSH to the
      private network due to a lack
      of direct access, the VM console can be accessed through Horizon.
     </p></div><div class="verbatim-wrap"><pre class="screen">ssh cirros@vm1-ip
password: &lt;password&gt;

# ping the private IP address of vm2
ping ###.###.###.###</pre></div></li><li class="step "><p>
     In another terminal.
    </p><div class="verbatim-wrap"><pre class="screen">ssh cirros@vm2-ip
password: &lt;password&gt;

# ping the private IP address of vm1
ping ###.###.###.###</pre></div></li><li class="step "><p>
     You should see ping responses from both virtual machines.
    </p></li></ol></div></div><p>
   As the admin user, you should check to make sure that a route exists between
   the router gateways. Once the gateways have been checked, packet encryption
   can be verified by using traffic analyzer (tcpdump) by tapping on the
   respective namespace (qrouter-* in case of non-DVR and snat-* in case of
   DVR) and tapping the right interface (qg-***).
  </p><div id="id-1.7.4.10.6.11" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.png" /><h6>Note</h6><p>
    When using DVR namespaces, all the occurrences of qrouter-xxxxxx in the
    following commands should be replaced with respective snat-xxxxxx.
   </p></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Check the if the route exists between two router gateways. You can get the
     right qrouter namespace id by executing <span class="emphasis"><em>sudo ip
     netns</em></span>. Once you have the qrouter namespace id, you can get the
     interface by executing <span class="emphasis"><em>sudo ip netns qrouter-xxxxxxxx ip
     addr</em></span> and from the result the interface can be found.
    </p><div class="verbatim-wrap"><pre class="screen">sudo ip netns
sudo ip netns exec qrouter-&lt;router1 UUID&gt; ping &lt;router2 gateway&gt;
sudo ip netns exec qrouter-&lt;router2 UUID&gt; ping &lt;router1 gateway&gt;</pre></div></li><li class="step "><p>
     Initiate a tcpdump on the interface.
    </p><div class="verbatim-wrap"><pre class="screen">sudo ip netns exec qrouter-xxxxxxxx tcpdump -i qg-xxxxxx</pre></div></li><li class="step "><p>
     Check the VPN connection.
    </p><div class="verbatim-wrap"><pre class="screen">ssh cirros@vm1-ip
password: &lt;password&gt;

# ping the private IP address of vm2
ping ###.###.###.###</pre></div></li><li class="step "><p>
     Repeat for other namespace and right tap interface.
    </p><div class="verbatim-wrap"><pre class="screen">sudo ip netns exec qrouter-xxxxxxxx tcpdump -i qg-xxxxxx</pre></div></li><li class="step "><p>
     In another terminal.
    </p><div class="verbatim-wrap"><pre class="screen">ssh cirros@vm2-ip
password: &lt;password&gt;

# ping the private IP address of vm1
ping ###.###.###.###</pre></div></li><li class="step "><p>
     You will find encrypted packets containing ‘ESP’ in the tcpdump trace.
    </p></li></ol></div></div></div><div class="sect1" id="sec-vpnaas-more"><div class="titlepage"><div><div><h2 class="title"><span class="number">15.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">More Information</span> <a title="Permalink" class="permalink" href="UsingVPNaaS.html#sec-vpnaas-more">#</a><a class="report-bug" target="_blank" href="https://github.com/SUSE-Cloud/doc-cloud/blob/develop/xml/networking-vpnaas.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>networking-vpnaas.xml</li><li><span class="ds-label">ID: </span>sec-vpnaas-more</li></ul></div></div></div></div><p>
   VPNaaS currently only supports Pre-shared Keys (PSK) security between VPN
   gateways. A different VPN gateway solution should be considered if stronger,
   certificate-based security is required.
  </p><p>
   For more information on the neutron command-line interface (CLI) and VPN as
   a Service (VPNaaS), see the OpenStack networking command-line client
   reference:
   <a class="link" href="http://docs.openstack.org/cli-reference/content/neutronclient_commands.html" target="_blank">http://docs.openstack.org/cli-reference/content/neutronclient_commands.html</a>
  </p><p>
   For information on how to create an external network and subnet, see the
   OpenStack manual:
   <a class="link" href="http://docs.openstack.org/user-guide/dashboard_create_networks.html" target="_blank">http://docs.openstack.org/user-guide/dashboard_create_networks.html</a>
  </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="HP2-0FWaaS.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 14 </span>Using Firewall as a Service (FWaaS)</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2020 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>